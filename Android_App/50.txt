Open Source Java-based ECG analysis Software  
and Android app for Atrial Fibrillation Screening 

Julien Oster1, Joachim Behar1, Roberta Colloca1, 2, Qichen Li1, Qiao Li1, Gari D Clifford1 

1Institute of Biomedical Engineering Science, University of Oxford, United Kingdom 
2Dipartimento di Elettronica, Informazione e Bioingegneria, Politecnico di Milano, Italy 

Abstract 

The  development  of  mHealth  applications  could 
facilitate the decrease of the healthcare costs in both high 
income and low to middle income regions. However, it is 
essential  that  mHealth  software  is  validated  on  public 
databases. Moreover, public scrutiny of the algorithms is 
likely to lead to faster and lower cost innovation. In this 
paper, we therefore present a novel Java-based Android 
application offering advanced Electrocardiogram (ECG) 
processing  techniques,  including  signal  quality  analysis 
and Atrial Fibrillation (AF) screening. 

The application connects the phone to a wireless ECG 
device  for  ECG  signal  recording.  The  application  then 
processes the acquired signal in three stages. First a peak 
detector,  based  on  peak  energy-amplitude  detection,  is 
applied. The detector has been adapted to deal with high 
frequent  signal 
noise  environments  and 
loss  or 
saturation.  A  Signal  Quality  Index  (SQI) 
then 
is 
computed. Finally, an AF detection algorithm, based on 
RR interval regularity is applied. 

The  peak  detection  achieved  99.8%  sensitivity  and 
98.7%  positive  predictive  value  on 
the  MIT-BIH 
arrhythmia database. The SQI had 96.9% accuracy on an 
extension  of  the  CinC  2011  Competition  database.  The 
AF  detector  achieved  a  92.7%  sensitivity  and  94.0% 
positive predictive value on the MIT-BIH AF database, on 
short 12 beat-length segments with as few as 10% of the 
beats being related to AF. 

This  application  opens  the  way  for  advanced  ECG 
analysis in the mHealth context and more specifically for 
the screening of AF in developing countries. The software 
will be released under the BSD Open Source License to 
increase the engagement of the user community in the use 
of the software. 

1.

Introduction

In recent years, the fields of telemedicine and mHealth, 
increasingly  resource-
rapidly 

especially 
constrained  healthcare  systems,  have  been 

the  context  of 

in 

evolving. Many reasons can be given for explaining this 
trend, but the two most important ones are 1) the need to 
reduce  the  cost  of  healthcare  expenditure  in  developed 
countries, and 2) to facilitate access to a better healthcare 
for  population  in  resource-scarce  communities  [1].  The 
development of robust mHealth applications may enable 
the  early  diagnosis  or  screening  of  pathologies,  which 
today remain mainly undetected. 

One  of 

the  most 

interesting 

targets  amongst 
cardiovascular pathologies is Atrial Fibrillation (AF). AF 
is a heart rhythm abnormality and it is associated with an 
increased  risk  of  stroke  and  heart  failure,  especially  in 
women.  The  prevalence  of  AF  is  0.4%  to  1%  in  the 
general population and increases with age [2].  

In  this  paper,  we  present  a  novel  mHealth  Android 
application  aimed  at  screening  for  AF.  This  application 
records  the  Electrocardiogram  (ECG)  waveforms  by 
connecting the phone with an ECG recording device via 
Bluetooth. The signal processing is then performed on the 
phone  and  the  user  is  provided  with  essential  feedback, 
such as an evaluation of the Signal Quality Index (SQI), 
in  addition  to  the  heart  rate.  For  benchmarking,  the 
analysis software was evaluated on public databases. 

2.

Material and methods

2.1.  ECG device 

The  current  version  of  the  phone  app  was  developed 
on the Android platform (4.2) in Java and communicates 
via  Bluetooth  to  a  Shimmer  ECG  device  (Shimmer 
Research,  Dublin,  Ireland)  [3,4].  This  device  provides 
two ECG lead recording during ambulatory situations. It 
is lightweight (28g) and therefore acceptable for wearable 
applications.  

Streaming  of  the  ECG  signals  can  be  initiated  after 
Bluetooth  pairing,  and  are  acquired  at  a  sampling 
frequency of 256 Hz. The traces of the two ECG leads are 
then  plotted  by  the  app,  along  with  the  estimated  Heart 
Rate (HR) and the SQI of each ECG lead. Once the user 
is  happy  with  the  overall  quality  of  the  traces,  the 
recording function can be invoked and the ECG data are 

ISSN 2325-8861Computing in Cardiology 2013; 40:731-734.731Open Source Java-based ECG analysis Software  
and Android app for Atrial Fibrillation Screening 

Julien Oster1, Joachim Behar1, Roberta Colloca1, 2, Qichen Li1, Qiao Li1, Gari D Clifford1 

1Institute of Biomedical Engineering Science, University of Oxford, United Kingdom 
2Dipartimento di Elettronica, Informazione e Bioingegneria, Politecnico di Milano, Italy 

Abstract 

The  development  of  mHealth  applications  could 
facilitate the decrease of the healthcare costs in both high 
income and low to middle income regions. However, it is 
essential  that  mHealth  software  is  validated  on  public 
databases. Moreover, public scrutiny of the algorithms is 
likely to lead to faster and lower cost innovation. In this 
paper, we therefore present a novel Java-based Android 
application offering advanced Electrocardiogram (ECG) 
processing  techniques,  including  signal  quality  analysis 
and Atrial Fibrillation (AF) screening. 

The application connects the phone to a wireless ECG 
device  for  ECG  signal  recording.  The  application  then 
processes the acquired signal in three stages. First a peak 
detector,  based  on  peak  energy-amplitude  detection,  is 
applied. The detector has been adapted to deal with high 
frequent  signal 
noise  environments  and 
loss  or 
saturation.  A  Signal  Quality  Index  (SQI) 
then 
is 
computed. Finally, an AF detection algorithm, based on 
RR interval regularity is applied. 

The  peak  detection  achieved  99.8%  sensitivity  and 
98.7%  positive  predictive  value  on 
the  MIT-BIH 
arrhythmia database. The SQI had 96.9% accuracy on an 
extension  of  the  CinC  2011  Competition  database.  The 
AF  detector  achieved  a  92.7%  sensitivity  and  94.0% 
positive predictive value on the MIT-BIH AF database, on 
short 12 beat-length segments with as few as 10% of the 
beats being related to AF. 

This  application  opens  the  way  for  advanced  ECG 
analysis in the mHealth context and more specifically for 
the screening of AF in developing countries. The software 
will be released under the BSD Open Source License to 
increase the engagement of the user community in the use 
of the software. 

1.

Introduction

In recent years, the fields of telemedicine and mHealth, 
increasingly  resource-
rapidly 

especially 
constrained  healthcare  systems,  have  been 

the  context  of 

in 

evolving. Many reasons can be given for explaining this 
trend, but the two most important ones are 1) the need to 
reduce  the  cost  of  healthcare  expenditure  in  developed 
countries, and 2) to facilitate access to a better healthcare 
for  population  in  resource-scarce  communities  [1].  The 
development of robust mHealth applications may enable 
the  early  diagnosis  or  screening  of  pathologies,  which 
today remain mainly undetected. 

One  of 

the  most 

interesting 

targets  amongst 
cardiovascular pathologies is Atrial Fibrillation (AF). AF 
is a heart rhythm abnormality and it is associated with an 
increased  risk  of  stroke  and  heart  failure,  especially  in 
women.  The  prevalence  of  AF  is  0.4%  to  1%  in  the 
general population and increases with age [2].  

In  this  paper,  we  present  a  novel  mHealth  Android 
application  aimed  at  screening  for  AF.  This  application 
records  the  Electrocardiogram  (ECG)  waveforms  by 
connecting the phone with an ECG recording device via 
Bluetooth. The signal processing is then performed on the 
phone  and  the  user  is  provided  with  essential  feedback, 
such as an evaluation of the Signal Quality Index (SQI), 
in  addition  to  the  heart  rate.  For  benchmarking,  the 
analysis software was evaluated on public databases. 

2.

Material and methods

2.1.  ECG device 

The  current  version  of  the  phone  app  was  developed 
on the Android platform (4.2) in Java and communicates 
via  Bluetooth  to  a  Shimmer  ECG  device  (Shimmer 
Research,  Dublin,  Ireland)  [3,4].  This  device  provides 
two ECG lead recording during ambulatory situations. It 
is lightweight (28g) and therefore acceptable for wearable 
applications.  

Streaming  of  the  ECG  signals  can  be  initiated  after 
Bluetooth  pairing,  and  are  acquired  at  a  sampling 
frequency of 256 Hz. The traces of the two ECG leads are 
then  plotted  by  the  app,  along  with  the  estimated  Heart 
Rate (HR) and the SQI of each ECG lead. Once the user 
is  happy  with  the  overall  quality  of  the  traces,  the 
recording function can be invoked and the ECG data are 

ISSN 2325-8861Computing in Cardiology 2013; 40:731-734.731saved as text files on the mobile phone or as binary files 
to a microSD card. 

 
2.2. 

Signal processing 

The  signal  processing  consists  of  three  consecutive 

stages: peak detection, quality and rhythm assessment. 
 
2.2.1.  Peak detection 

Beat or peak detection is arguably the most important 
task for ECG signal processing. The R-peak is the most 
distinguishable feature in the signal, generated when the 
ventricleâ€™s cells are depolarized. Detection of these peaks 
allows HR or cardiac rhythm assessment. 

R-peak  detection  has  been  thoroughly  studied  and 
several  methods  have  been  proposed.  The  method 
implemented in this app was originally developed in C by 
Clifford  [5].  The  algorithm  is  a  modification  of  an 
approach first described by NygÃ¢rds and SÃ¶rnmo in 1983 
[6]  and  subsequently  updated  by  Hamilton,  Pan  and 
Tompkins in 1985 and 1986 [7, 8].  

The detection method consists of two stages: 
1.  Pre-processing of the ECG signal: both linear and 
non-linear  filtering  methods  are  used  in  order  to 
enhance  highly 
an 
approximate  duration  of  100ms.  This  stage  is 
summarized in the flowchart on  Figure 1 

energetic  peaks  with 

2.  Post-processing  decision  rules:  these  operate  on 
the processed ECG signal to identify the relevant 
sections containing R-peaks (â€˜fiducialâ€™ points). 

Figure 1. Four steps of the first stage of the R-peak detector. 

 

Clifford added adaptive thresholding and initialization 
taking the median value of the first and third quartile of 
the time-averaged signal. This made the algorithm scale-
independent,  robust  to  large  changes  in  amplitude,  and 
have a rapid recovery time from gross artifacts [5]. Note 
that such gross artifacts do not often present in standard 
online databases, but are otherwise generally common. 

The R-peak detection was evaluated on the MIT-BIH 
arrhythmia  database,  including  48  recordings  of  30-
minute  ECG  signals  [9].  The  different  records  included 
pathological  cases,  such  as  premature  ventricular 
contraction,  bundle  branch  blocks  or  atrial  fibrillation 
(AF).  The  BxB  tool  from  PhysioNet  [10]  was  used  for 
automatic  evaluation  of  the  beat  detection  by  matching 
automated beats with the reference annotations, searching 
in a 150ms window. The implemented Java version of the 
QRS detector was compared with eplimited [7, 8], which 
is freely available [11]. 

 

2.2.2.  Signal quality index 

Ambulatory recordings are particularly prone to noise 
and artifacts. The software provides an estimation of the 
signal quality  so that the user, who may not be familiar 
with physiological signals and may not be able to visually 
assess the quality of the ECG traces, can decide whether 
the  current  analysis  is  reliable  or  recording  needs 
adjustment. The development of such indices is of interest 
in  numerous  applications  and  especially  for  mHealth 
applications  [9].  Other  studies  were  also  performed  to 
assess the influence of pathological rhythms and beats on 
the estimation of SQIs [10].  

In  Behar  et  al.  [13]  SQI  estimation  was  based  on  a 
combination  of  several  basic  SQIs  using  a  machine 
learning approach. The first basic SQI was a comparison 
between two R-peak detectors. The first detector was the 
one  described  in  section  2.2.1.  The  second  algorithm, 
wQRS,  is  based  on  the  length-transform,  which  is 
designed to emphasize the QRS complexes [11,12]. The 
resulting metric, bSQI, is then calculated as follows: 

(cid:1854)(cid:1845)(cid:1843)I(cid:4666)(cid:1863)(cid:4667)(cid:3404)(cid:1840)(cid:1865)(cid:1853)(cid:1872)(cid:1855)(cid:1860)(cid:1857)(cid:1856)(cid:4666)k.(cid:1875)(cid:4667)/(cid:1840)(cid:1853)(cid:1864)(cid:1864)(cid:4666)k,(cid:1875)(cid:4667), 

where  Nmatched    is  the  number  of  beats  that  both 
algorithms  detected  (within  150  ms)  and  Nall  is  the 
number of all beats detected by either algorithm (without 
double counting the matched beats). In other words, Nall  
= NDF  + NLT âˆ’ Nmatched , where NDF was the number of 
beats detected by Cliffordâ€™s method [5] and NLT  was the 
number of beats detected by the wQRS method [14,15]. 

bSQI  was  evaluated  on  an  extension  of  the  database 
provided  for  the  Physionet/CinC  Challenge  2011  [12], 
which  consisted  of  set  of  manually  labeled  10-second 
ECG  segments.  This  set  of  data  contained  10020 
segments  labeled  â€˜good  qualityâ€™  and  8745  segments 
labeled â€˜bad qualityâ€™. This SQI was compared with other 
SQIs, which were based on previously described statistics 
(kurtosis- kSQI and skewness- sSQI) or spectrally band-
limited measurements (pSQI and basSQI for assessing the 
energy in the baseline). See Behar et al. [13]. 

 

2.2.3.  Atrial fibrillation detection 

AF is a cardiovascular pathology, which is associated 
with  irregular  cardiac  rhythm.  The  RR  interval  time-
series is characterized by a succession of short and long 
intervals.  This  phenomenon  can  be  explained  by  a 
random firing of the AV node due to the fibrillation of the 
atria.  In  such  condition, 
traces  show  a 
substitution  of  the  p-waves  by  f-waves,  which  present 
throughout the cardiac cycle. The determination of f-wave 
frequency can aid in the assessment of AF.  

the  ECG 

In  our  Android  application,  an  AF  detection  method 
based on the regularity of the RR time series was initially 
implemented  [16].  The  measurement  of  this  regularity,  
coefficient of sample entropy, was computed as follows: 

732Open Source Java-based ECG analysis Software  
and Android app for Atrial Fibrillation Screening 

Julien Oster1, Joachim Behar1, Roberta Colloca1, 2, Qichen Li1, Qiao Li1, Gari D Clifford1 

1Institute of Biomedical Engineering Science, University of Oxford, United Kingdom 
2Dipartimento di Elettronica, Informazione e Bioingegneria, Politecnico di Milano, Italy 

Abstract 

The  development  of  mHealth  applications  could 
facilitate the decrease of the healthcare costs in both high 
income and low to middle income regions. However, it is 
essential  that  mHealth  software  is  validated  on  public 
databases. Moreover, public scrutiny of the algorithms is 
likely to lead to faster and lower cost innovation. In this 
paper, we therefore present a novel Java-based Android 
application offering advanced Electrocardiogram (ECG) 
processing  techniques,  including  signal  quality  analysis 
and Atrial Fibrillation (AF) screening. 

The application connects the phone to a wireless ECG 
device  for  ECG  signal  recording.  The  application  then 
processes the acquired signal in three stages. First a peak 
detector,  based  on  peak  energy-amplitude  detection,  is 
applied. The detector has been adapted to deal with high 
frequent  signal 
noise  environments  and 
loss  or 
saturation.  A  Signal  Quality  Index  (SQI) 
then 
is 
computed. Finally, an AF detection algorithm, based on 
RR interval regularity is applied. 

The  peak  detection  achieved  99.8%  sensitivity  and 
98.7%  positive  predictive  value  on 
the  MIT-BIH 
arrhythmia database. The SQI had 96.9% accuracy on an 
extension  of  the  CinC  2011  Competition  database.  The 
AF  detector  achieved  a  92.7%  sensitivity  and  94.0% 
positive predictive value on the MIT-BIH AF database, on 
short 12 beat-length segments with as few as 10% of the 
beats being related to AF. 

This  application  opens  the  way  for  advanced  ECG 
analysis in the mHealth context and more specifically for 
the screening of AF in developing countries. The software 
will be released under the BSD Open Source License to 
increase the engagement of the user community in the use 
of the software. 

1.

Introduction

In recent years, the fields of telemedicine and mHealth, 
increasingly  resource-
rapidly 

especially 
constrained  healthcare  systems,  have  been 

the  context  of 

in 

evolving. Many reasons can be given for explaining this 
trend, but the two most important ones are 1) the need to 
reduce  the  cost  of  healthcare  expenditure  in  developed 
countries, and 2) to facilitate access to a better healthcare 
for  population  in  resource-scarce  communities  [1].  The 
development of robust mHealth applications may enable 
the  early  diagnosis  or  screening  of  pathologies,  which 
today remain mainly undetected. 

One  of 

the  most 

interesting 

targets  amongst 
cardiovascular pathologies is Atrial Fibrillation (AF). AF 
is a heart rhythm abnormality and it is associated with an 
increased  risk  of  stroke  and  heart  failure,  especially  in 
women.  The  prevalence  of  AF  is  0.4%  to  1%  in  the 
general population and increases with age [2].  

In  this  paper,  we  present  a  novel  mHealth  Android 
application  aimed  at  screening  for  AF.  This  application 
records  the  Electrocardiogram  (ECG)  waveforms  by 
connecting the phone with an ECG recording device via 
Bluetooth. The signal processing is then performed on the 
phone  and  the  user  is  provided  with  essential  feedback, 
such as an evaluation of the Signal Quality Index (SQI), 
in  addition  to  the  heart  rate.  For  benchmarking,  the 
analysis software was evaluated on public databases. 

2.

Material and methods

2.1.  ECG device 

The  current  version  of  the  phone  app  was  developed 
on the Android platform (4.2) in Java and communicates 
via  Bluetooth  to  a  Shimmer  ECG  device  (Shimmer 
Research,  Dublin,  Ireland)  [3,4].  This  device  provides 
two ECG lead recording during ambulatory situations. It 
is lightweight (28g) and therefore acceptable for wearable 
applications.  

Streaming  of  the  ECG  signals  can  be  initiated  after 
Bluetooth  pairing,  and  are  acquired  at  a  sampling 
frequency of 256 Hz. The traces of the two ECG leads are 
then  plotted  by  the  app,  along  with  the  estimated  Heart 
Rate (HR) and the SQI of each ECG lead. Once the user 
is  happy  with  the  overall  quality  of  the  traces,  the 
recording function can be invoked and the ECG data are 

ISSN 2325-8861Computing in Cardiology 2013; 40:731-734.731saved as text files on the mobile phone or as binary files 
to a microSD card. 

 
2.2. 

Signal processing 

The  signal  processing  consists  of  three  consecutive 

stages: peak detection, quality and rhythm assessment. 
 
2.2.1.  Peak detection 

Beat or peak detection is arguably the most important 
task for ECG signal processing. The R-peak is the most 
distinguishable feature in the signal, generated when the 
ventricleâ€™s cells are depolarized. Detection of these peaks 
allows HR or cardiac rhythm assessment. 

R-peak  detection  has  been  thoroughly  studied  and 
several  methods  have  been  proposed.  The  method 
implemented in this app was originally developed in C by 
Clifford  [5].  The  algorithm  is  a  modification  of  an 
approach first described by NygÃ¢rds and SÃ¶rnmo in 1983 
[6]  and  subsequently  updated  by  Hamilton,  Pan  and 
Tompkins in 1985 and 1986 [7, 8].  

The detection method consists of two stages: 
1.  Pre-processing of the ECG signal: both linear and 
non-linear  filtering  methods  are  used  in  order  to 
enhance  highly 
an 
approximate  duration  of  100ms.  This  stage  is 
summarized in the flowchart on  Figure 1 

energetic  peaks  with 

2.  Post-processing  decision  rules:  these  operate  on 
the processed ECG signal to identify the relevant 
sections containing R-peaks (â€˜fiducialâ€™ points). 

Figure 1. Four steps of the first stage of the R-peak detector. 

 

Clifford added adaptive thresholding and initialization 
taking the median value of the first and third quartile of 
the time-averaged signal. This made the algorithm scale-
independent,  robust  to  large  changes  in  amplitude,  and 
have a rapid recovery time from gross artifacts [5]. Note 
that such gross artifacts do not often present in standard 
online databases, but are otherwise generally common. 

The R-peak detection was evaluated on the MIT-BIH 
arrhythmia  database,  including  48  recordings  of  30-
minute  ECG  signals  [9].  The  different  records  included 
pathological  cases,  such  as  premature  ventricular 
contraction,  bundle  branch  blocks  or  atrial  fibrillation 
(AF).  The  BxB  tool  from  PhysioNet  [10]  was  used  for 
automatic  evaluation  of  the  beat  detection  by  matching 
automated beats with the reference annotations, searching 
in a 150ms window. The implemented Java version of the 
QRS detector was compared with eplimited [7, 8], which 
is freely available [11]. 

 

2.2.2.  Signal quality index 

Ambulatory recordings are particularly prone to noise 
and artifacts. The software provides an estimation of the 
signal quality  so that the user, who may not be familiar 
with physiological signals and may not be able to visually 
assess the quality of the ECG traces, can decide whether 
the  current  analysis  is  reliable  or  recording  needs 
adjustment. The development of such indices is of interest 
in  numerous  applications  and  especially  for  mHealth 
applications  [9].  Other  studies  were  also  performed  to 
assess the influence of pathological rhythms and beats on 
the estimation of SQIs [10].  

In  Behar  et  al.  [13]  SQI  estimation  was  based  on  a 
combination  of  several  basic  SQIs  using  a  machine 
learning approach. The first basic SQI was a comparison 
between two R-peak detectors. The first detector was the 
one  described  in  section  2.2.1.  The  second  algorithm, 
wQRS,  is  based  on  the  length-transform,  which  is 
designed to emphasize the QRS complexes [11,12]. The 
resulting metric, bSQI, is then calculated as follows: 

(cid:1854)(cid:1845)(cid:1843)I(cid:4666)(cid:1863)(cid:4667)(cid:3404)(cid:1840)(cid:1865)(cid:1853)(cid:1872)(cid:1855)(cid:1860)(cid:1857)(cid:1856)(cid:4666)k.(cid:1875)(cid:4667)/(cid:1840)(cid:1853)(cid:1864)(cid:1864)(cid:4666)k,(cid:1875)(cid:4667), 

where  Nmatched    is  the  number  of  beats  that  both 
algorithms  detected  (within  150  ms)  and  Nall  is  the 
number of all beats detected by either algorithm (without 
double counting the matched beats). In other words, Nall  
= NDF  + NLT âˆ’ Nmatched , where NDF was the number of 
beats detected by Cliffordâ€™s method [5] and NLT  was the 
number of beats detected by the wQRS method [14,15]. 

bSQI  was  evaluated  on  an  extension  of  the  database 
provided  for  the  Physionet/CinC  Challenge  2011  [12], 
which  consisted  of  set  of  manually  labeled  10-second 
ECG  segments.  This  set  of  data  contained  10020 
segments  labeled  â€˜good  qualityâ€™  and  8745  segments 
labeled â€˜bad qualityâ€™. This SQI was compared with other 
SQIs, which were based on previously described statistics 
(kurtosis- kSQI and skewness- sSQI) or spectrally band-
limited measurements (pSQI and basSQI for assessing the 
energy in the baseline). See Behar et al. [13]. 

 

2.2.3.  Atrial fibrillation detection 

AF is a cardiovascular pathology, which is associated 
with  irregular  cardiac  rhythm.  The  RR  interval  time-
series is characterized by a succession of short and long 
intervals.  This  phenomenon  can  be  explained  by  a 
random firing of the AV node due to the fibrillation of the 
atria.  In  such  condition, 
traces  show  a 
substitution  of  the  p-waves  by  f-waves,  which  present 
throughout the cardiac cycle. The determination of f-wave 
frequency can aid in the assessment of AF.  

the  ECG 

In  our  Android  application,  an  AF  detection  method 
based on the regularity of the RR time series was initially 
implemented  [16].  The  measurement  of  this  regularity,  
coefficient of sample entropy, was computed as follows: 

732 

2.2.4.  Ventricular fibrillation detection 

It is based on the sample entropy defined by 

, 

matching tolerance r, and (cid:1844)(cid:1844)(cid:3364)(cid:3364)(cid:3364)(cid:3364) is  the mean RR interval. 

where A is a total number of matches of length m+1 and 
B  the  total  number  of  matches  of  length  m,  with  a 

increased 

The matching tolerance r was initialized at 30ms and 
iteratively  until  Aï‚³5.  COSEn  was 
was 
computed on non-overlapping 12 beat-length segments. If 
COSEn>-1.4 on a segment, then AF was reported. 

The AF detection algorithm was evaluated on the MIT-
BIH AF database [10], which consisted of 25 long-term 
recordings  (10  hours  each)  with  subject  exhibiting 
(mostly paroxysmal) AF. Each recording was divided in 
12-beat segments, which were classified as AF if at least 
10% of the beats were atrial in the segment. Results were 
compared  with  the  method  developed  by  Linker  [17], 
which analyzed the signal over 10s windows. 

As  an  accurate  detection  of  Ventricular  Fibrillation 
(VF)  and  tachycardia  (VT)  is  of  the  highest  importance 
for patient monitoring, we have also included a machine 
learning approach for VF detection. The detector is based 
on  Li  et  al.â€˜s  method  [18].  This  technique  extracts  two 
features from the ECG (related to spectral energy) on a 5-
second  window  and  combines  them  using  a  machine 
learning approach. These features were inspired from the 
literature and selected using a genetic algorithm. 

The  current 

implementation  of 

the  VF  detector 
combines  the  two  features  by  using  a  multi-layer 
perceptron,  with  a  structure  containing  three  layers  and 
twelve  nodes  in  the  hidden  layer.  Tests  (not  reported 
here)  have  shown  no  significant  difference  between  this 
implementation  and 
the  Support  Vector  Machine 
approach  presented  in  [18].  The  authors  reported  an  
accuracy,  sensitivity  and  specificity  of  approximately 
96%  on  a  test  set  containing  more  than  20,000  events 
extracted  from  67  subjects  in  three  publicly  available 
databases (the AHADB, CUDB and VFDB). 

 
3. 

Results 

3.1. 

Peak detection 

The  results  of  the  beat  detection  evaluation  are 
presented  in  Table  1.    Note  that  the  results  are  only 
slightly inferior to those of Hamilton, Pan and Tompkins 
[7, 8] for both Sensitivity (Se) (0.8% lower) and positive 
predictive value (PPV) (1.1% lower). This is because our 
method  was  adapted  to  ambulatory  signals  and  not 
specifically tuned to the MIT-BIH Arrhythmia Database. 

 

, 

Table 1. Beat detection evaluation on the MIT-BIH 

arrhythmia database. 

Method 
Hamilton, Pan & Tompkins [7,8]   99.8% 
Proposed method 
99.0% 

Se 

PPV 
99.8% 
98.7% 

 

Table  2.  Classification  results  on  individual  SQIs  and  the 

extended CinC challenge database (in %). 

bSQI 
96.9 
98.3 
95.3 

kSQI 
87.9 
91.1 
84.2 

sSQI 
89.2 
94.4 
83.1 

pSQI 
75.2 
80.6 
69.0 

basSQI 
62.6 
67.9 
56.4 

qSQI 
76.6 
80.5 
72.1 

pcaSQI 
95.0 
94.5 
95.6 

 
Ac 
Se 
Sp 

 

Table 3. Atrial Fibrillation classification results on the MIT-

BIH AF database. 

Method 
Implemented method 
Linker [17] 

Se 
92.7% 
96.6% 

Sp 
94.2% 
82.3% 

PPV 
92.2% 
80.0% 

 
3.2. 

 SQI 

The evaluation of the individual SQIs on the extended 
in  Error! 
CinC  Challenge  database 
Reference  source  not  found..  Note  that  bSQI  achieves 
the  best  results  on  this  database  in  terms  of  Accuracy 
(Ac), Sensitivity and Specificity (Sp) of all the univariate 
approaches. 

is  presented 

 
3.3 

Atrial Fibrillation 

The evaluation of the atrial fibrillation method is given 
in  Error!  Reference  source  not  found..  The  overall 
accuracy  of  the  implemented  method  [16]  is  relatively 
good. Even if Linkerâ€™s technique has a better sensitivity 
(by 3.9%), the implemented method results in fewer false 
positives,  which  results  in  a  better  Specificity  (+11.9%) 
and  positive  predictive  value  (+12.2%),  essential  in 
scaling up healthcare. 
 
4. 

Discussion 

The  app  presented  in  this  paper  provides  a  baseline 
tool  for  further  development  of  open  source  ambulatory 
ECG  analysis.  The  beat  detection  results  showed  that 
eplimited  is  slightly  more  accurate  on  the  MIT-BIH 
arrhythmia  database.  Nevertheless, 
implemented 
technique  reitialization  procedure  makes  it  more  robust 
for  signals  with  low  amplitude  and  frequent  artifacts. 
Moreover,  eplimited  has  a  scan  back  procedure,  which 
looks back in time if no beats have been detected during a 
certain  period.  This  non-real-time  processing  approach 
and has therefore not been implemented in the app. 

the 

733Open Source Java-based ECG analysis Software  
and Android app for Atrial Fibrillation Screening 

Julien Oster1, Joachim Behar1, Roberta Colloca1, 2, Qichen Li1, Qiao Li1, Gari D Clifford1 

1Institute of Biomedical Engineering Science, University of Oxford, United Kingdom 
2Dipartimento di Elettronica, Informazione e Bioingegneria, Politecnico di Milano, Italy 

Abstract 

The  development  of  mHealth  applications  could 
facilitate the decrease of the healthcare costs in both high 
income and low to middle income regions. However, it is 
essential  that  mHealth  software  is  validated  on  public 
databases. Moreover, public scrutiny of the algorithms is 
likely to lead to faster and lower cost innovation. In this 
paper, we therefore present a novel Java-based Android 
application offering advanced Electrocardiogram (ECG) 
processing  techniques,  including  signal  quality  analysis 
and Atrial Fibrillation (AF) screening. 

The application connects the phone to a wireless ECG 
device  for  ECG  signal  recording.  The  application  then 
processes the acquired signal in three stages. First a peak 
detector,  based  on  peak  energy-amplitude  detection,  is 
applied. The detector has been adapted to deal with high 
frequent  signal 
noise  environments  and 
loss  or 
saturation.  A  Signal  Quality  Index  (SQI) 
then 
is 
computed. Finally, an AF detection algorithm, based on 
RR interval regularity is applied. 

The  peak  detection  achieved  99.8%  sensitivity  and 
98.7%  positive  predictive  value  on 
the  MIT-BIH 
arrhythmia database. The SQI had 96.9% accuracy on an 
extension  of  the  CinC  2011  Competition  database.  The 
AF  detector  achieved  a  92.7%  sensitivity  and  94.0% 
positive predictive value on the MIT-BIH AF database, on 
short 12 beat-length segments with as few as 10% of the 
beats being related to AF. 

This  application  opens  the  way  for  advanced  ECG 
analysis in the mHealth context and more specifically for 
the screening of AF in developing countries. The software 
will be released under the BSD Open Source License to 
increase the engagement of the user community in the use 
of the software. 

1.

Introduction

In recent years, the fields of telemedicine and mHealth, 
increasingly  resource-
rapidly 

especially 
constrained  healthcare  systems,  have  been 

the  context  of 

in 

evolving. Many reasons can be given for explaining this 
trend, but the two most important ones are 1) the need to 
reduce  the  cost  of  healthcare  expenditure  in  developed 
countries, and 2) to facilitate access to a better healthcare 
for  population  in  resource-scarce  communities  [1].  The 
development of robust mHealth applications may enable 
the  early  diagnosis  or  screening  of  pathologies,  which 
today remain mainly undetected. 

One  of 

the  most 

interesting 

targets  amongst 
cardiovascular pathologies is Atrial Fibrillation (AF). AF 
is a heart rhythm abnormality and it is associated with an 
increased  risk  of  stroke  and  heart  failure,  especially  in 
women.  The  prevalence  of  AF  is  0.4%  to  1%  in  the 
general population and increases with age [2].  

In  this  paper,  we  present  a  novel  mHealth  Android 
application  aimed  at  screening  for  AF.  This  application 
records  the  Electrocardiogram  (ECG)  waveforms  by 
connecting the phone with an ECG recording device via 
Bluetooth. The signal processing is then performed on the 
phone  and  the  user  is  provided  with  essential  feedback, 
such as an evaluation of the Signal Quality Index (SQI), 
in  addition  to  the  heart  rate.  For  benchmarking,  the 
analysis software was evaluated on public databases. 

2.

Material and methods

2.1.  ECG device 

The  current  version  of  the  phone  app  was  developed 
on the Android platform (4.2) in Java and communicates 
via  Bluetooth  to  a  Shimmer  ECG  device  (Shimmer 
Research,  Dublin,  Ireland)  [3,4].  This  device  provides 
two ECG lead recording during ambulatory situations. It 
is lightweight (28g) and therefore acceptable for wearable 
applications.  

Streaming  of  the  ECG  signals  can  be  initiated  after 
Bluetooth  pairing,  and  are  acquired  at  a  sampling 
frequency of 256 Hz. The traces of the two ECG leads are 
then  plotted  by  the  app,  along  with  the  estimated  Heart 
Rate (HR) and the SQI of each ECG lead. Once the user 
is  happy  with  the  overall  quality  of  the  traces,  the 
recording function can be invoked and the ECG data are 

ISSN 2325-8861Computing in Cardiology 2013; 40:731-734.731saved as text files on the mobile phone or as binary files 
to a microSD card. 

 
2.2. 

Signal processing 

The  signal  processing  consists  of  three  consecutive 

stages: peak detection, quality and rhythm assessment. 
 
2.2.1.  Peak detection 

Beat or peak detection is arguably the most important 
task for ECG signal processing. The R-peak is the most 
distinguishable feature in the signal, generated when the 
ventricleâ€™s cells are depolarized. Detection of these peaks 
allows HR or cardiac rhythm assessment. 

R-peak  detection  has  been  thoroughly  studied  and 
several  methods  have  been  proposed.  The  method 
implemented in this app was originally developed in C by 
Clifford  [5].  The  algorithm  is  a  modification  of  an 
approach first described by NygÃ¢rds and SÃ¶rnmo in 1983 
[6]  and  subsequently  updated  by  Hamilton,  Pan  and 
Tompkins in 1985 and 1986 [7, 8].  

The detection method consists of two stages: 
1.  Pre-processing of the ECG signal: both linear and 
non-linear  filtering  methods  are  used  in  order  to 
enhance  highly 
an 
approximate  duration  of  100ms.  This  stage  is 
summarized in the flowchart on  Figure 1 

energetic  peaks  with 

2.  Post-processing  decision  rules:  these  operate  on 
the processed ECG signal to identify the relevant 
sections containing R-peaks (â€˜fiducialâ€™ points). 

Figure 1. Four steps of the first stage of the R-peak detector. 

 

Clifford added adaptive thresholding and initialization 
taking the median value of the first and third quartile of 
the time-averaged signal. This made the algorithm scale-
independent,  robust  to  large  changes  in  amplitude,  and 
have a rapid recovery time from gross artifacts [5]. Note 
that such gross artifacts do not often present in standard 
online databases, but are otherwise generally common. 

The R-peak detection was evaluated on the MIT-BIH 
arrhythmia  database,  including  48  recordings  of  30-
minute  ECG  signals  [9].  The  different  records  included 
pathological  cases,  such  as  premature  ventricular 
contraction,  bundle  branch  blocks  or  atrial  fibrillation 
(AF).  The  BxB  tool  from  PhysioNet  [10]  was  used  for 
automatic  evaluation  of  the  beat  detection  by  matching 
automated beats with the reference annotations, searching 
in a 150ms window. The implemented Java version of the 
QRS detector was compared with eplimited [7, 8], which 
is freely available [11]. 

 

2.2.2.  Signal quality index 

Ambulatory recordings are particularly prone to noise 
and artifacts. The software provides an estimation of the 
signal quality  so that the user, who may not be familiar 
with physiological signals and may not be able to visually 
assess the quality of the ECG traces, can decide whether 
the  current  analysis  is  reliable  or  recording  needs 
adjustment. The development of such indices is of interest 
in  numerous  applications  and  especially  for  mHealth 
applications  [9].  Other  studies  were  also  performed  to 
assess the influence of pathological rhythms and beats on 
the estimation of SQIs [10].  

In  Behar  et  al.  [13]  SQI  estimation  was  based  on  a 
combination  of  several  basic  SQIs  using  a  machine 
learning approach. The first basic SQI was a comparison 
between two R-peak detectors. The first detector was the 
one  described  in  section  2.2.1.  The  second  algorithm, 
wQRS,  is  based  on  the  length-transform,  which  is 
designed to emphasize the QRS complexes [11,12]. The 
resulting metric, bSQI, is then calculated as follows: 

(cid:1854)(cid:1845)(cid:1843)I(cid:4666)(cid:1863)(cid:4667)(cid:3404)(cid:1840)(cid:1865)(cid:1853)(cid:1872)(cid:1855)(cid:1860)(cid:1857)(cid:1856)(cid:4666)k.(cid:1875)(cid:4667)/(cid:1840)(cid:1853)(cid:1864)(cid:1864)(cid:4666)k,(cid:1875)(cid:4667), 

where  Nmatched    is  the  number  of  beats  that  both 
algorithms  detected  (within  150  ms)  and  Nall  is  the 
number of all beats detected by either algorithm (without 
double counting the matched beats). In other words, Nall  
= NDF  + NLT âˆ’ Nmatched , where NDF was the number of 
beats detected by Cliffordâ€™s method [5] and NLT  was the 
number of beats detected by the wQRS method [14,15]. 

bSQI  was  evaluated  on  an  extension  of  the  database 
provided  for  the  Physionet/CinC  Challenge  2011  [12], 
which  consisted  of  set  of  manually  labeled  10-second 
ECG  segments.  This  set  of  data  contained  10020 
segments  labeled  â€˜good  qualityâ€™  and  8745  segments 
labeled â€˜bad qualityâ€™. This SQI was compared with other 
SQIs, which were based on previously described statistics 
(kurtosis- kSQI and skewness- sSQI) or spectrally band-
limited measurements (pSQI and basSQI for assessing the 
energy in the baseline). See Behar et al. [13]. 

 

2.2.3.  Atrial fibrillation detection 

AF is a cardiovascular pathology, which is associated 
with  irregular  cardiac  rhythm.  The  RR  interval  time-
series is characterized by a succession of short and long 
intervals.  This  phenomenon  can  be  explained  by  a 
random firing of the AV node due to the fibrillation of the 
atria.  In  such  condition, 
traces  show  a 
substitution  of  the  p-waves  by  f-waves,  which  present 
throughout the cardiac cycle. The determination of f-wave 
frequency can aid in the assessment of AF.  

the  ECG 

In  our  Android  application,  an  AF  detection  method 
based on the regularity of the RR time series was initially 
implemented  [16].  The  measurement  of  this  regularity,  
coefficient of sample entropy, was computed as follows: 

732 

2.2.4.  Ventricular fibrillation detection 

It is based on the sample entropy defined by 

, 

matching tolerance r, and (cid:1844)(cid:1844)(cid:3364)(cid:3364)(cid:3364)(cid:3364) is  the mean RR interval. 

where A is a total number of matches of length m+1 and 
B  the  total  number  of  matches  of  length  m,  with  a 

increased 

The matching tolerance r was initialized at 30ms and 
iteratively  until  Aï‚³5.  COSEn  was 
was 
computed on non-overlapping 12 beat-length segments. If 
COSEn>-1.4 on a segment, then AF was reported. 

The AF detection algorithm was evaluated on the MIT-
BIH AF database [10], which consisted of 25 long-term 
recordings  (10  hours  each)  with  subject  exhibiting 
(mostly paroxysmal) AF. Each recording was divided in 
12-beat segments, which were classified as AF if at least 
10% of the beats were atrial in the segment. Results were 
compared  with  the  method  developed  by  Linker  [17], 
which analyzed the signal over 10s windows. 

As  an  accurate  detection  of  Ventricular  Fibrillation 
(VF)  and  tachycardia  (VT)  is  of  the  highest  importance 
for patient monitoring, we have also included a machine 
learning approach for VF detection. The detector is based 
on  Li  et  al.â€˜s  method  [18].  This  technique  extracts  two 
features from the ECG (related to spectral energy) on a 5-
second  window  and  combines  them  using  a  machine 
learning approach. These features were inspired from the 
literature and selected using a genetic algorithm. 

The  current 

implementation  of 

the  VF  detector 
combines  the  two  features  by  using  a  multi-layer 
perceptron,  with  a  structure  containing  three  layers  and 
twelve  nodes  in  the  hidden  layer.  Tests  (not  reported 
here)  have  shown  no  significant  difference  between  this 
implementation  and 
the  Support  Vector  Machine 
approach  presented  in  [18].  The  authors  reported  an  
accuracy,  sensitivity  and  specificity  of  approximately 
96%  on  a  test  set  containing  more  than  20,000  events 
extracted  from  67  subjects  in  three  publicly  available 
databases (the AHADB, CUDB and VFDB). 

 
3. 

Results 

3.1. 

Peak detection 

The  results  of  the  beat  detection  evaluation  are 
presented  in  Table  1.    Note  that  the  results  are  only 
slightly inferior to those of Hamilton, Pan and Tompkins 
[7, 8] for both Sensitivity (Se) (0.8% lower) and positive 
predictive value (PPV) (1.1% lower). This is because our 
method  was  adapted  to  ambulatory  signals  and  not 
specifically tuned to the MIT-BIH Arrhythmia Database. 

 

, 

Table 1. Beat detection evaluation on the MIT-BIH 

arrhythmia database. 

Method 
Hamilton, Pan & Tompkins [7,8]   99.8% 
Proposed method 
99.0% 

Se 

PPV 
99.8% 
98.7% 

 

Table  2.  Classification  results  on  individual  SQIs  and  the 

extended CinC challenge database (in %). 

bSQI 
96.9 
98.3 
95.3 

kSQI 
87.9 
91.1 
84.2 

sSQI 
89.2 
94.4 
83.1 

pSQI 
75.2 
80.6 
69.0 

basSQI 
62.6 
67.9 
56.4 

qSQI 
76.6 
80.5 
72.1 

pcaSQI 
95.0 
94.5 
95.6 

 
Ac 
Se 
Sp 

 

Table 3. Atrial Fibrillation classification results on the MIT-

BIH AF database. 

Method 
Implemented method 
Linker [17] 

Se 
92.7% 
96.6% 

Sp 
94.2% 
82.3% 

PPV 
92.2% 
80.0% 

 
3.2. 

 SQI 

The evaluation of the individual SQIs on the extended 
in  Error! 
CinC  Challenge  database 
Reference  source  not  found..  Note  that  bSQI  achieves 
the  best  results  on  this  database  in  terms  of  Accuracy 
(Ac), Sensitivity and Specificity (Sp) of all the univariate 
approaches. 

is  presented 

 
3.3 

Atrial Fibrillation 

The evaluation of the atrial fibrillation method is given 
in  Error!  Reference  source  not  found..  The  overall 
accuracy  of  the  implemented  method  [16]  is  relatively 
good. Even if Linkerâ€™s technique has a better sensitivity 
(by 3.9%), the implemented method results in fewer false 
positives,  which  results  in  a  better  Specificity  (+11.9%) 
and  positive  predictive  value  (+12.2%),  essential  in 
scaling up healthcare. 
 
4. 

Discussion 

The  app  presented  in  this  paper  provides  a  baseline 
tool  for  further  development  of  open  source  ambulatory 
ECG  analysis.  The  beat  detection  results  showed  that 
eplimited  is  slightly  more  accurate  on  the  MIT-BIH 
arrhythmia  database.  Nevertheless, 
implemented 
technique  reitialization  procedure  makes  it  more  robust 
for  signals  with  low  amplitude  and  frequent  artifacts. 
Moreover,  eplimited  has  a  scan  back  procedure,  which 
looks back in time if no beats have been detected during a 
certain  period.  This  non-real-time  processing  approach 
and has therefore not been implemented in the app. 

the 

733The  current  implementation  of  the  SQI  achieves  the 
best results amongst the individual SQIs tested. However, 
Behar et al. [13] have shown that a combination of SQIs 
can give better results. Moreover, pathological ECGs can 
hamper the SQI method, which would be prejudicial for 
pathology  screening.  It  should  be  noted  though  that  AF 
does not affect the SQI classification [13]. 

The proposed AF detection has a better specificity and 
positive  predictive  value  for  short  windows 
than 
previously  reported  algorithms.  However,  it  is  not  the 
optimal AF detection algorithm, and its accuracy on other 
(out-of-sample) databases has been shown to be inferior 
[19].  Although  it  would  also  be  interesting  to  compare 
with other methods, it is difficult because most methods 
for detecting AF use longer segments. There is also much 
disagreement on how many AF beats within a tracing are 
needed 
trigger  an  AF  classification.  A  deeper 
comparative study of algorithms, window size, and noise 
sensitivity can be found in Colloca et al [19]. 

Future  work  will  include  the  implementation  of  the 
Support-Vector-Machine  (SVM)  approach  for  both  the 
estimation of the SQI and the detection of AF episodes. 

to 

 
5.  

Conclusion 

We have presented a novel Android application which 
allows the recording of ECG signals and the detection of 
AF.  The  app  also  provides  a  quality  index  for  the 
assessment of analysis reliability and feedback to the user 
to  allow  quality  improvement  at  point  of  care.  The 
implemented software has been evaluated thoroughly on 
large  and  publicly  available  databases,  and  promising 
results  have  been  presented.  Such  an  application  offers 
great promise for the development of ECG analysis in the 
mHealth context, and especially for the screening of AF 
in developing countries. The source code has been made 
freely available under an open source license and future 
improvements will be integrated into the algorithms. 

Acknowledgements 

This work was supported by the Royal Society under a 
Newton Fellowship, grant number 793/914/N/K/EST/DD 
â€“  PF/tkg/4004642  and  the  Wellcome  Trust  under  grant 
number  098461/Z/12/Z  for  â€˜The  University  of  Oxford 
Sleep and Circadian Neuroscience Institute (SCNi)â€™. 

References 

[1]  Clifford  GD,  Clifton  D.  Wireless  technology  in  disease 
management  and  medicine.  Annual  Review  of  Medicine 
2012; 63:479-492. 

[2]  Fuster  V,  Ryden  LE,  Cannom  DS,  Crijns  HJ,  Curtis  AB, 
Ellenbogen  KA,  Halperin  JL,  Le  Heuzey  JY,  Kay  GN, 
Lowe  JE,  Bertil  Olsson  S,  Prystowsky  EN,  Tamargo  JL, 
Wann  S.  ACC/AHA/ESC  2006  guidelines 
the 

for 

management of patients with atrial fibrillation. Circulation 
2006; 8(9): 651-745. 

[3]  Burns  A,  Greene  BR,  McGrath  MJ,  O'Shea  TJ,  Kuris  B, 
Ayer  SM,  Stroiescu  F,  Cionca  V.  "SHIMMERâ„¢  â€“  A 
wireless  sensor  platform  for  noninvasive  biomedical 
research," Sensors Journal, IEEE , 2010; 10(9): 527,1534. 
[4]  Shimmer-research,  available  online  at  http://shimmer-

research.com/, last viewed March 2013. 

[5]  Clifford  GD.  Signal  processing  methods  for  heart  rate 
variability,  DPhil.  Thesis,  Oxford  University,  Michaelmas 
2002. 

[6]  NygÃ¥rds ME, SÃ¶rnmo L. Delineation of the QRS complex 
using  the  envelope  of  the  ECG.  Med.  &  Biol.  Eng.  & 
Comput 1983; 21:538-547. 

[7]  Pan J, Tompkins WJ. A real-time QRS detection algorithm. 

IEEE Trans Biomed Eng 1985; 32(3):230-236. 

[8]  Hamilton  PS,  Tompkins  WJ.  Quantitative  investigation  of 
the  MIT/BIH  arrhythmia 

QRS  detection  rules  using 
database. IEEE Trans Biomed Eng 1986; 33:1157-1165. 

[9]  The  MIT-BIH  Arrhythmia  Database.  Available  online  at 
http://www.physionet.org/physiobank/database/mitdb/,  last 
viewed March 2013.  

[10] Goldberger AL, Amaral LA, Glass L, et al. : PhysioBank, 
PhysioToolkit,  and  PhysioNet:  components  of  a  new 
research 
for  complex  physiologic  signals. 
Circulation 2000; 101 (23): 215-20.  

resource 

[11] Hamilton  PS.  Open  source  ECG  analysis  software 

documentation, www.eplimited.com/osea13.pdf, 2002. 

[12] Silva I; Moody GB, Celi L. Improving the quality of ECGs 
collected using mobile phones: The PhysioNet/Computing 
in  Cardiology  Challenge  2011.  Computing  in  Cardiology, 
2011; 38 (1): 273-6. 

[13] Behar  J,  Oster  J,  Li  Q,  Clifford  GD.  ECG  signal  quality 
during  arrhythmia  and  its  application  to  false  alarm 
reduction.  IEEE  Transactions  on  Biomedical  Engineering 
In Press, 2013. 

[14] Zong  W.  Single-lead  QRS  detector  based  on  length 
transform,  Last  updated  2010,  accessed  online  May  2013 
www.physionet.org/physiotools/wfdb/app/wqrs.c 

[15] Zong  W,  Moody  GB,  Jiang  D.  A  robust  open-source 
algorithm to detect onset and duration of QRS complexes, 
Computing in Cardiology 2003; 30:737â€“740.  

[16] Lake DE, Moorman JR. Accurate estimation of entropy in 
very  short  physiological  time  series:  the  problem  of  atrial 
fibrillation  detection  in  implanted  ventricular  devices. 
American  Journal  of  Physiology-Heart  and  Circulatory 
Physiology 2011; 300:H319-H325. 

[17] Linker  DT.  Long-term  monitoring  for  detection  of  atrial 

fibrillation, US patent 7,630,756. 

[18] Li Q, Rajagopalan C, Clifford GD. Ventricular fibrillation 
and  tachycardia  classification  using  a  machine  learning 
approach. IEEE Trans on Biomed Eng 2013, In press. 

[19]  Colloca  R,  Johnson  AEW,  Mainardi  L,  Clifford  GD,  A 
support  vector  machine  approach  for  reliable  detection  of 
AF events. Computing in Cardiology 2013. 

 
Address for correspondence:  
 
J. Oster, j.oster@eng.ox.ac.uk 

734
Predicting Seizures in Intracranial EEG Recordings

Sining Ma, Jiawei Zhu

sma87@stanford.edu, jiaweiz@stanford.edu

Abstract—If seizure forecasting systems could reliably
identify periods of increased probability of seizure occur-
rence, patients who suffer from epilepsy would be able
to avoid dangerous activities and lead more normal lives.
The goal of this project is to differentiate between the
preictal and interictal states by analyzing intracranial
EEG recordings. Data for each hour are organized into
six ten-minute time sequences. Logistic Regression and
support vector machines (SVM) are applied to each time
sequence to calculate the average test false negative rate.
The idea of combining data from various time sequences
is also experimented with to examine if false negative
rates can be reduced. The results show that SVM provides
better prediction results for patients, and that combining
training examples from different time sequences does not
help improve prediction results. Since the pathogenesis of
epilepsy may vary across different species, applying the
same training models to both dogs and patients may be
problematic.

Keywords—seizure, classiﬁcation,

support vector machines (SVM)

logistic regression,

I. INTRODUCTION

Epilepsy, characterized by the occurrence of
spontaneous seizures, afﬂicts nearly 1% of the popu-
lation worldwide. Epilepsy sometimes leads to loss
of consciousness and control of bowel or bladder
function, creating not only the risk of serious injury,
but also an intense feeling of helplessness that
strongly impacts the everyday lives of epileptic
patients. If computational algorithms could reliably
predict seizure occurrences, devices designed to
warn patients of impending seizures would help
patients avoid potentially dangerous activities. Also,
medications could be taken only when necessary to
reduce overall side effects.

An epileptic patient’s brain activity can be clas-
siﬁed into 4 states: Interictal (between seizures, or
baseline), Preictal (prior to seizure), Ictal (seizure),
and Post-ictal (after seizures). The primary chal-
lenge in seizure forecasting is to differentiate be-
tween the preictal and interictal states. Past research
on seizure forecasting based on EEG has pointed out
two difﬁculties. First, preictal and interictal EEG

patterns across patients (and dogs) vary consider-
ably. Second, EEG is highly complex and varies
over time.

II. OBJECTIVE

This project represents an attempt to demonstrate
the existence and accurate classiﬁcation of the pre-
ictal brain state in dogs and humans with naturally
occurring epilepsy.

III. DATA

Data used in this project, which we obtained
from a Kaggle competition, are intracranial elec-
troencephalography (EEG) recordings sampled from
dogs and patients. The training data are organized
into ten-minute EEG clips labeled "Preictal" for pre-
seizure data segments, or "Interictal" for non-seizure
data segments. Both the preictal and interictal train-
ing data segments are numbered sequentially. The
sequence, numbered 1 - 6, represents the index of
the data segment within an hour. For example, the
sequence 6 preictal data segment represents the EEG
data between the 51st minute and the 60th minute
in the hour before a seizure occurrence. The test
data, which are preictal, are also organized into ten-
minutes EEG clips but are provided in random order.
This allows us to pick any test data segment to
verify the accuracy of every time sequence’s training
model.

Preictal training and test data segments cover one
hour prior to seizure with a ﬁve-minute seizure
horizon (Figure 1). Similarly, one hour sequences
of interictal ten-minute data segments are provided.

A. EEG recording for dogs

Intracranial EEG for dogs are sampled from 16
electrodes at 400 Hz. Thus, the canine data contain
16 features, and the data for each ten-minute time
sequence contain 16 × 240, 000 data points. Each

1

Predicting Seizures in Intracranial EEG Recordings

Sining Ma, Jiawei Zhu

sma87@stanford.edu, jiaweiz@stanford.edu

Abstract—If seizure forecasting systems could reliably
identify periods of increased probability of seizure occur-
rence, patients who suffer from epilepsy would be able
to avoid dangerous activities and lead more normal lives.
The goal of this project is to differentiate between the
preictal and interictal states by analyzing intracranial
EEG recordings. Data for each hour are organized into
six ten-minute time sequences. Logistic Regression and
support vector machines (SVM) are applied to each time
sequence to calculate the average test false negative rate.
The idea of combining data from various time sequences
is also experimented with to examine if false negative
rates can be reduced. The results show that SVM provides
better prediction results for patients, and that combining
training examples from different time sequences does not
help improve prediction results. Since the pathogenesis of
epilepsy may vary across different species, applying the
same training models to both dogs and patients may be
problematic.

Keywords—seizure, classiﬁcation,

support vector machines (SVM)

logistic regression,

I. INTRODUCTION

Epilepsy, characterized by the occurrence of
spontaneous seizures, afﬂicts nearly 1% of the popu-
lation worldwide. Epilepsy sometimes leads to loss
of consciousness and control of bowel or bladder
function, creating not only the risk of serious injury,
but also an intense feeling of helplessness that
strongly impacts the everyday lives of epileptic
patients. If computational algorithms could reliably
predict seizure occurrences, devices designed to
warn patients of impending seizures would help
patients avoid potentially dangerous activities. Also,
medications could be taken only when necessary to
reduce overall side effects.

An epileptic patient’s brain activity can be clas-
siﬁed into 4 states: Interictal (between seizures, or
baseline), Preictal (prior to seizure), Ictal (seizure),
and Post-ictal (after seizures). The primary chal-
lenge in seizure forecasting is to differentiate be-
tween the preictal and interictal states. Past research
on seizure forecasting based on EEG has pointed out
two difﬁculties. First, preictal and interictal EEG

patterns across patients (and dogs) vary consider-
ably. Second, EEG is highly complex and varies
over time.

II. OBJECTIVE

This project represents an attempt to demonstrate
the existence and accurate classiﬁcation of the pre-
ictal brain state in dogs and humans with naturally
occurring epilepsy.

III. DATA

Data used in this project, which we obtained
from a Kaggle competition, are intracranial elec-
troencephalography (EEG) recordings sampled from
dogs and patients. The training data are organized
into ten-minute EEG clips labeled "Preictal" for pre-
seizure data segments, or "Interictal" for non-seizure
data segments. Both the preictal and interictal train-
ing data segments are numbered sequentially. The
sequence, numbered 1 - 6, represents the index of
the data segment within an hour. For example, the
sequence 6 preictal data segment represents the EEG
data between the 51st minute and the 60th minute
in the hour before a seizure occurrence. The test
data, which are preictal, are also organized into ten-
minutes EEG clips but are provided in random order.
This allows us to pick any test data segment to
verify the accuracy of every time sequence’s training
model.

Preictal training and test data segments cover one
hour prior to seizure with a ﬁve-minute seizure
horizon (Figure 1). Similarly, one hour sequences
of interictal ten-minute data segments are provided.

A. EEG recording for dogs

Intracranial EEG for dogs are sampled from 16
electrodes at 400 Hz. Thus, the canine data contain
16 features, and the data for each ten-minute time
sequence contain 16 × 240, 000 data points. Each

1

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

Fig. 1: EEG recordings cover one hour

prior to seizure with a ﬁve-minute

seizure horizon

data point represents the EEG recording for elec-
trode i at some time t. The competition provided
EEG recordings for 5 dogs. We choose to use the
ﬁrst hour (6 sequences) training data for dogs 1 and
5.

IV. MODELS

A. Logistic Regression

This is a binary classiﬁcation problem, so the ﬁrst
intuitive choice is logistic regression with sigmoid
function hθ(x). We apply stochastic gradient ascent
to the following equation:

:= θj + α(y(i) − hθ(x(i)))x(i)

j

θj

where hθ(x) = g(θTx) =

1

1 + e−θTx

A ﬁxed learning rate α is used, and the imple-
mentation slowly decreases α to some value around
zero to ensure the algorithm converges to the global
minimum.

B. Support Vector Machine (SVM)

The goal of SVM classiﬁcation is to establish
and test a mapping x (cid:55)→ y from EEG spectral
features to either a preictal or an interictal label.
To achieve this goal, we use C-support vector
classiﬁcation which solves the following primal
optimization problems:

min
w,b,ξ

1
2

wTw + C

l(cid:88)

i=1

ξi

subject to yi(wTφ(xi) + b) ≥ 1 − ξi,

ξi ≥ 0, i = 1, . . . , l,

where φ(xi) maps xi into a higher-dimension space
and C > 0 is the regularization parameter. We use
the radial basis function (RBF) kernel:

K(xi, xj) = exp(−γ(cid:107)xi − xj(cid:107)2)

There are two model parameters: C and the kernel
factor γ. Using the grid search approach, we try
all combinations of C and γ, and select the com-
bination that produces the maximum classiﬁcation
accuracy. The search range for log C is from -1 to
6, and for log γ is from -3 to 4.

We then run C-SVM with the selected C and γ.
We use the same C and γ for each (individual and
combined) time sequence.

Fig. 2: EEG recordings cover one hour

prior to seizure with a ﬁve-minute

seizure horizon

B. EEG recording for patients

Intracranial EEG for patients are sampled from
15 electrodes at 5,000 Hz. Thus, the human data
contain 15 features, and the data for each ten-
minute time sequence contain 15 × 3000, 000 data
points. The competition provided EEG recordings
for 2 patients. We choose to use the ﬁrst hour (6
sequences) training data for patient 1.

2

Predicting Seizures in Intracranial EEG Recordings

Sining Ma, Jiawei Zhu

sma87@stanford.edu, jiaweiz@stanford.edu

Abstract—If seizure forecasting systems could reliably
identify periods of increased probability of seizure occur-
rence, patients who suffer from epilepsy would be able
to avoid dangerous activities and lead more normal lives.
The goal of this project is to differentiate between the
preictal and interictal states by analyzing intracranial
EEG recordings. Data for each hour are organized into
six ten-minute time sequences. Logistic Regression and
support vector machines (SVM) are applied to each time
sequence to calculate the average test false negative rate.
The idea of combining data from various time sequences
is also experimented with to examine if false negative
rates can be reduced. The results show that SVM provides
better prediction results for patients, and that combining
training examples from different time sequences does not
help improve prediction results. Since the pathogenesis of
epilepsy may vary across different species, applying the
same training models to both dogs and patients may be
problematic.

Keywords—seizure, classiﬁcation,

support vector machines (SVM)

logistic regression,

I. INTRODUCTION

Epilepsy, characterized by the occurrence of
spontaneous seizures, afﬂicts nearly 1% of the popu-
lation worldwide. Epilepsy sometimes leads to loss
of consciousness and control of bowel or bladder
function, creating not only the risk of serious injury,
but also an intense feeling of helplessness that
strongly impacts the everyday lives of epileptic
patients. If computational algorithms could reliably
predict seizure occurrences, devices designed to
warn patients of impending seizures would help
patients avoid potentially dangerous activities. Also,
medications could be taken only when necessary to
reduce overall side effects.

An epileptic patient’s brain activity can be clas-
siﬁed into 4 states: Interictal (between seizures, or
baseline), Preictal (prior to seizure), Ictal (seizure),
and Post-ictal (after seizures). The primary chal-
lenge in seizure forecasting is to differentiate be-
tween the preictal and interictal states. Past research
on seizure forecasting based on EEG has pointed out
two difﬁculties. First, preictal and interictal EEG

patterns across patients (and dogs) vary consider-
ably. Second, EEG is highly complex and varies
over time.

II. OBJECTIVE

This project represents an attempt to demonstrate
the existence and accurate classiﬁcation of the pre-
ictal brain state in dogs and humans with naturally
occurring epilepsy.

III. DATA

Data used in this project, which we obtained
from a Kaggle competition, are intracranial elec-
troencephalography (EEG) recordings sampled from
dogs and patients. The training data are organized
into ten-minute EEG clips labeled "Preictal" for pre-
seizure data segments, or "Interictal" for non-seizure
data segments. Both the preictal and interictal train-
ing data segments are numbered sequentially. The
sequence, numbered 1 - 6, represents the index of
the data segment within an hour. For example, the
sequence 6 preictal data segment represents the EEG
data between the 51st minute and the 60th minute
in the hour before a seizure occurrence. The test
data, which are preictal, are also organized into ten-
minutes EEG clips but are provided in random order.
This allows us to pick any test data segment to
verify the accuracy of every time sequence’s training
model.

Preictal training and test data segments cover one
hour prior to seizure with a ﬁve-minute seizure
horizon (Figure 1). Similarly, one hour sequences
of interictal ten-minute data segments are provided.

A. EEG recording for dogs

Intracranial EEG for dogs are sampled from 16
electrodes at 400 Hz. Thus, the canine data contain
16 features, and the data for each ten-minute time
sequence contain 16 × 240, 000 data points. Each

1

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

Fig. 1: EEG recordings cover one hour

prior to seizure with a ﬁve-minute

seizure horizon

data point represents the EEG recording for elec-
trode i at some time t. The competition provided
EEG recordings for 5 dogs. We choose to use the
ﬁrst hour (6 sequences) training data for dogs 1 and
5.

IV. MODELS

A. Logistic Regression

This is a binary classiﬁcation problem, so the ﬁrst
intuitive choice is logistic regression with sigmoid
function hθ(x). We apply stochastic gradient ascent
to the following equation:

:= θj + α(y(i) − hθ(x(i)))x(i)

j

θj

where hθ(x) = g(θTx) =

1

1 + e−θTx

A ﬁxed learning rate α is used, and the imple-
mentation slowly decreases α to some value around
zero to ensure the algorithm converges to the global
minimum.

B. Support Vector Machine (SVM)

The goal of SVM classiﬁcation is to establish
and test a mapping x (cid:55)→ y from EEG spectral
features to either a preictal or an interictal label.
To achieve this goal, we use C-support vector
classiﬁcation which solves the following primal
optimization problems:

min
w,b,ξ

1
2

wTw + C

l(cid:88)

i=1

ξi

subject to yi(wTφ(xi) + b) ≥ 1 − ξi,

ξi ≥ 0, i = 1, . . . , l,

where φ(xi) maps xi into a higher-dimension space
and C > 0 is the regularization parameter. We use
the radial basis function (RBF) kernel:

K(xi, xj) = exp(−γ(cid:107)xi − xj(cid:107)2)

There are two model parameters: C and the kernel
factor γ. Using the grid search approach, we try
all combinations of C and γ, and select the com-
bination that produces the maximum classiﬁcation
accuracy. The search range for log C is from -1 to
6, and for log γ is from -3 to 4.

We then run C-SVM with the selected C and γ.
We use the same C and γ for each (individual and
combined) time sequence.

Fig. 2: EEG recordings cover one hour

prior to seizure with a ﬁve-minute

seizure horizon

B. EEG recording for patients

Intracranial EEG for patients are sampled from
15 electrodes at 5,000 Hz. Thus, the human data
contain 15 features, and the data for each ten-
minute time sequence contain 15 × 3000, 000 data
points. The competition provided EEG recordings
for 2 patients. We choose to use the ﬁrst hour (6
sequences) training data for patient 1.

2

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

C. Calculating False Negative Rates

B. Dogs

Data for dogs and patients are categorized as
either preictal or interictal. For logistic regression,
we label preictal data examples as positive ("1"),
and interictal data examples as negative ("0"). For
SVM, we label preictal data examples as positive
("1"), and interictal examples as negative ("-1").
All test examples should be predicted as preictal,
which is positive ("1"). We are interested in the
false negative rate, which is the fraction of the
preictal test examples that the algorithm incorrectly
predicts to be interictal. A small false negative rate
implies a high probability of seizure occurrences.
In the following equation, RF N stands for false
negative rate.

RF N =

# of test examples predicted to be interictal

# of test examples

We apply logistic regression to a time sequence
10 times using 10 different
test data segments,
and compute the average of the 10 false negative
rates. We repeat this step for the other ﬁve time
sequence and compare the average false negative
rates. (For SVM, the process is the same except
we use 5 different test data segments). The time
sequence with the lowest average false negative
rate is the best
in predicting seizures. We then
combine some continuous or randomly selected ten-
minute sequences, and run the algorithms again,
calculate and compare the average false negative
rates to observe whether combining time sequences
improves the accuracy of seizure predictions.

V. RESULTS

A. SVM parameter selection

Because of the extremely long training time, we
select the last 16 × 80, 000 examples in the canine
data, and the last 15 × 100, 000 examples in the
human data to grid-search the optimal values of C
and γ.

Dog 1
Dog 5
Patient 1

C γ
8
2
2
8
1
2

Accuracy
77.8919%
84.9231%
100.0%

TABLE I: Cross Validation Results for C and γ

3

We use all the canine data, 16 × 240, 000, to
run logistic regression. Due to the aforementioned
time constraint, we use only the last 16 × 80, 000
canine training examples in each time sequence to
run SVM. We then combine sequences 1, 6 and
sequences 3, 6 to examine if the accuracy can be
improved. See Figure 3, 4, and Table II for Dog 1
and Dog 5 results.

e
t
a
R
N
F

e
g
a
r
e
v
A

e
t
a
R
N
F

e
g
a
r
e
v
A

1

0.8

0.6

0.4

0.2

0

1

0.8

0.6

0.4

0.2

0

1

2

3

4

5

6

Logistic Regression

SVM

(a) Sequences 1 to 6

4&5

5&6

Logistic Regression

SVM

(b) Combined Sequences
Fig. 3: Dog 1 Results

Dog 1
seq 1
seq 2
seq 3
seq 4
seq 5
seq 6

seq 1&6
seq 3&6
Dog 5
seq 1
seq 2
seq 3
seq 4
seq 5
seq 6

Logistic Regression

0.287635
0.355074
0.253306
0.363520
0.441084
0.408698
0.394584
0.400128

SVM

0.999345
0.143058
0.877420
0.279950
0.140827
0.931298
0.977588
0.958088

Logistic Regression

SVM

0.999345
0.143058
0.877420
0.279950
0.140827
0.931298
seq 1&6
0.977588
seq 3&6
0.958088
TABLE II: Dogs 1 and 5 Results

0.293179
0.446686
0.366449
0.526572
0.557142
0.307605
0.370788
0.385755

Predicting Seizures in Intracranial EEG Recordings

Sining Ma, Jiawei Zhu

sma87@stanford.edu, jiaweiz@stanford.edu

Abstract—If seizure forecasting systems could reliably
identify periods of increased probability of seizure occur-
rence, patients who suffer from epilepsy would be able
to avoid dangerous activities and lead more normal lives.
The goal of this project is to differentiate between the
preictal and interictal states by analyzing intracranial
EEG recordings. Data for each hour are organized into
six ten-minute time sequences. Logistic Regression and
support vector machines (SVM) are applied to each time
sequence to calculate the average test false negative rate.
The idea of combining data from various time sequences
is also experimented with to examine if false negative
rates can be reduced. The results show that SVM provides
better prediction results for patients, and that combining
training examples from different time sequences does not
help improve prediction results. Since the pathogenesis of
epilepsy may vary across different species, applying the
same training models to both dogs and patients may be
problematic.

Keywords—seizure, classiﬁcation,

support vector machines (SVM)

logistic regression,

I. INTRODUCTION

Epilepsy, characterized by the occurrence of
spontaneous seizures, afﬂicts nearly 1% of the popu-
lation worldwide. Epilepsy sometimes leads to loss
of consciousness and control of bowel or bladder
function, creating not only the risk of serious injury,
but also an intense feeling of helplessness that
strongly impacts the everyday lives of epileptic
patients. If computational algorithms could reliably
predict seizure occurrences, devices designed to
warn patients of impending seizures would help
patients avoid potentially dangerous activities. Also,
medications could be taken only when necessary to
reduce overall side effects.

An epileptic patient’s brain activity can be clas-
siﬁed into 4 states: Interictal (between seizures, or
baseline), Preictal (prior to seizure), Ictal (seizure),
and Post-ictal (after seizures). The primary chal-
lenge in seizure forecasting is to differentiate be-
tween the preictal and interictal states. Past research
on seizure forecasting based on EEG has pointed out
two difﬁculties. First, preictal and interictal EEG

patterns across patients (and dogs) vary consider-
ably. Second, EEG is highly complex and varies
over time.

II. OBJECTIVE

This project represents an attempt to demonstrate
the existence and accurate classiﬁcation of the pre-
ictal brain state in dogs and humans with naturally
occurring epilepsy.

III. DATA

Data used in this project, which we obtained
from a Kaggle competition, are intracranial elec-
troencephalography (EEG) recordings sampled from
dogs and patients. The training data are organized
into ten-minute EEG clips labeled "Preictal" for pre-
seizure data segments, or "Interictal" for non-seizure
data segments. Both the preictal and interictal train-
ing data segments are numbered sequentially. The
sequence, numbered 1 - 6, represents the index of
the data segment within an hour. For example, the
sequence 6 preictal data segment represents the EEG
data between the 51st minute and the 60th minute
in the hour before a seizure occurrence. The test
data, which are preictal, are also organized into ten-
minutes EEG clips but are provided in random order.
This allows us to pick any test data segment to
verify the accuracy of every time sequence’s training
model.

Preictal training and test data segments cover one
hour prior to seizure with a ﬁve-minute seizure
horizon (Figure 1). Similarly, one hour sequences
of interictal ten-minute data segments are provided.

A. EEG recording for dogs

Intracranial EEG for dogs are sampled from 16
electrodes at 400 Hz. Thus, the canine data contain
16 features, and the data for each ten-minute time
sequence contain 16 × 240, 000 data points. Each

1

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

Fig. 1: EEG recordings cover one hour

prior to seizure with a ﬁve-minute

seizure horizon

data point represents the EEG recording for elec-
trode i at some time t. The competition provided
EEG recordings for 5 dogs. We choose to use the
ﬁrst hour (6 sequences) training data for dogs 1 and
5.

IV. MODELS

A. Logistic Regression

This is a binary classiﬁcation problem, so the ﬁrst
intuitive choice is logistic regression with sigmoid
function hθ(x). We apply stochastic gradient ascent
to the following equation:

:= θj + α(y(i) − hθ(x(i)))x(i)

j

θj

where hθ(x) = g(θTx) =

1

1 + e−θTx

A ﬁxed learning rate α is used, and the imple-
mentation slowly decreases α to some value around
zero to ensure the algorithm converges to the global
minimum.

B. Support Vector Machine (SVM)

The goal of SVM classiﬁcation is to establish
and test a mapping x (cid:55)→ y from EEG spectral
features to either a preictal or an interictal label.
To achieve this goal, we use C-support vector
classiﬁcation which solves the following primal
optimization problems:

min
w,b,ξ

1
2

wTw + C

l(cid:88)

i=1

ξi

subject to yi(wTφ(xi) + b) ≥ 1 − ξi,

ξi ≥ 0, i = 1, . . . , l,

where φ(xi) maps xi into a higher-dimension space
and C > 0 is the regularization parameter. We use
the radial basis function (RBF) kernel:

K(xi, xj) = exp(−γ(cid:107)xi − xj(cid:107)2)

There are two model parameters: C and the kernel
factor γ. Using the grid search approach, we try
all combinations of C and γ, and select the com-
bination that produces the maximum classiﬁcation
accuracy. The search range for log C is from -1 to
6, and for log γ is from -3 to 4.

We then run C-SVM with the selected C and γ.
We use the same C and γ for each (individual and
combined) time sequence.

Fig. 2: EEG recordings cover one hour

prior to seizure with a ﬁve-minute

seizure horizon

B. EEG recording for patients

Intracranial EEG for patients are sampled from
15 electrodes at 5,000 Hz. Thus, the human data
contain 15 features, and the data for each ten-
minute time sequence contain 15 × 3000, 000 data
points. The competition provided EEG recordings
for 2 patients. We choose to use the ﬁrst hour (6
sequences) training data for patient 1.

2

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

C. Calculating False Negative Rates

B. Dogs

Data for dogs and patients are categorized as
either preictal or interictal. For logistic regression,
we label preictal data examples as positive ("1"),
and interictal data examples as negative ("0"). For
SVM, we label preictal data examples as positive
("1"), and interictal examples as negative ("-1").
All test examples should be predicted as preictal,
which is positive ("1"). We are interested in the
false negative rate, which is the fraction of the
preictal test examples that the algorithm incorrectly
predicts to be interictal. A small false negative rate
implies a high probability of seizure occurrences.
In the following equation, RF N stands for false
negative rate.

RF N =

# of test examples predicted to be interictal

# of test examples

We apply logistic regression to a time sequence
10 times using 10 different
test data segments,
and compute the average of the 10 false negative
rates. We repeat this step for the other ﬁve time
sequence and compare the average false negative
rates. (For SVM, the process is the same except
we use 5 different test data segments). The time
sequence with the lowest average false negative
rate is the best
in predicting seizures. We then
combine some continuous or randomly selected ten-
minute sequences, and run the algorithms again,
calculate and compare the average false negative
rates to observe whether combining time sequences
improves the accuracy of seizure predictions.

V. RESULTS

A. SVM parameter selection

Because of the extremely long training time, we
select the last 16 × 80, 000 examples in the canine
data, and the last 15 × 100, 000 examples in the
human data to grid-search the optimal values of C
and γ.

Dog 1
Dog 5
Patient 1

C γ
8
2
2
8
1
2

Accuracy
77.8919%
84.9231%
100.0%

TABLE I: Cross Validation Results for C and γ

3

We use all the canine data, 16 × 240, 000, to
run logistic regression. Due to the aforementioned
time constraint, we use only the last 16 × 80, 000
canine training examples in each time sequence to
run SVM. We then combine sequences 1, 6 and
sequences 3, 6 to examine if the accuracy can be
improved. See Figure 3, 4, and Table II for Dog 1
and Dog 5 results.

e
t
a
R
N
F

e
g
a
r
e
v
A

e
t
a
R
N
F

e
g
a
r
e
v
A

1

0.8

0.6

0.4

0.2

0

1

0.8

0.6

0.4

0.2

0

1

2

3

4

5

6

Logistic Regression

SVM

(a) Sequences 1 to 6

4&5

5&6

Logistic Regression

SVM

(b) Combined Sequences
Fig. 3: Dog 1 Results

Dog 1
seq 1
seq 2
seq 3
seq 4
seq 5
seq 6

seq 1&6
seq 3&6
Dog 5
seq 1
seq 2
seq 3
seq 4
seq 5
seq 6

Logistic Regression

0.287635
0.355074
0.253306
0.363520
0.441084
0.408698
0.394584
0.400128

SVM

0.999345
0.143058
0.877420
0.279950
0.140827
0.931298
0.977588
0.958088

Logistic Regression

SVM

0.999345
0.143058
0.877420
0.279950
0.140827
0.931298
seq 1&6
0.977588
seq 3&6
0.958088
TABLE II: Dogs 1 and 5 Results

0.293179
0.446686
0.366449
0.526572
0.557142
0.307605
0.370788
0.385755

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

e
t
a
R
N
F

e
g
a
r
e
v
A

e
t
a
R
N
F

e
g
a
r
e
v
A

1

0.8

0.6

0.4

0.2

0

1

0.8

0.6

0.4

0.2

0

1

2

3

4

5

6

Logistic Regression

SVM

(a) Sequences 1 to 6

4&5

5&6

Logistic Regression

SVM

(b) Combined Sequences
Fig. 4: Dog 5 Results

C. Patients

We use all the human data, 15×3, 000, 000, to run
logistic regression. Due to the aforementioned time
constraint, we use only the last 15×100, 000 training
examples in each time sequence to run SVM. We
then combine sequences 4, 5 and sequences 5, 6
to examine if the accuracy can be improved. See
Figure 5 and Table III for Patient 1 results.

e
t
a
R
N
F

e
g
a
r
e
v
A

1

0.8

0.6

0.4

0.2

0

1

3

4

2
Logistic Regression

5

6 4&5 5&6

SVM

Fig. 5: Histogram of Patients 1 Results

VI. DISCUSSION & CONCLUSION

Based on the results of dogs and patients, we
observe that combining time sequences does not

4

Patient 1

Logistic Regression

SVM

seq 1
seq 2
seq 3
seq 4
seq 5
seq 6

seq 4&5
seq 5&6

0.527982
0.543429
0.486822
0.453055
0.481161
0.523835
0.481130
0.548151

0.083046
0.225166
0.055214
0.186868
0.140582

0

0.093442
0.005538

TABLE III: Patient 1 Results

improve the results. None of the combined se-
quences produce false negative rates smaller than
the minimum of the individual sequences’ false
negative rates. Although this contradicts the intuitive
conjecture that adding more data should improve
results, the ﬁnding is not entirely surprising because
previous research has pointed out that EEG is highly
complex and varies over time. If there is little cor-
relation between any time sequences, continuous or
random selected, then combining sequences would
only add noise to each model and should not be
expected to yield better predictions.

Interestingly, while sequences 1, 3, 6 in the
human data give low SVM false negative rates,
sequences 1, 3, 6 in the canine data give surprisingly
high SVM false negative rates (close to 1). Our
surmise is that logistic regression may not have
classiﬁed the preictal and interictal states correctly
because we omitted the process of cross validation
before performing logistic regression.

We observe some patterns from the results of
the two dogs. The logistic regression false negative
rates ﬂuctuate (increase, decrease,
increase, and
ﬁnally decrease), while the SVM false negative rates
exhibit an entirely opposite, and much more volatile
trend. These trends may be evidence that pre-seizure
brain activities exhibit a high degree of ﬂuctuation.
If future medical devices can detect such ﬂuctua-
tion, then warning epileptic patients of impending
seizures may be achievable. This approach may be
more effective in forecasting seizures than solely
focusing on the false negative rates of speciﬁc time
sequences.

According to the results of patient 1, SVM
outperforms logistic regression as expected. SVM
results are all < 25%. This means that we are able to
predict seizures with reasonable accuracy. However,
all logistic regression false negative rates are around
50%. Such relative "uniformity" makes it difﬁcult to
interpret which time sequences are better in seizure

Predicting Seizures in Intracranial EEG Recordings

Sining Ma, Jiawei Zhu

sma87@stanford.edu, jiaweiz@stanford.edu

Abstract—If seizure forecasting systems could reliably
identify periods of increased probability of seizure occur-
rence, patients who suffer from epilepsy would be able
to avoid dangerous activities and lead more normal lives.
The goal of this project is to differentiate between the
preictal and interictal states by analyzing intracranial
EEG recordings. Data for each hour are organized into
six ten-minute time sequences. Logistic Regression and
support vector machines (SVM) are applied to each time
sequence to calculate the average test false negative rate.
The idea of combining data from various time sequences
is also experimented with to examine if false negative
rates can be reduced. The results show that SVM provides
better prediction results for patients, and that combining
training examples from different time sequences does not
help improve prediction results. Since the pathogenesis of
epilepsy may vary across different species, applying the
same training models to both dogs and patients may be
problematic.

Keywords—seizure, classiﬁcation,

support vector machines (SVM)

logistic regression,

I. INTRODUCTION

Epilepsy, characterized by the occurrence of
spontaneous seizures, afﬂicts nearly 1% of the popu-
lation worldwide. Epilepsy sometimes leads to loss
of consciousness and control of bowel or bladder
function, creating not only the risk of serious injury,
but also an intense feeling of helplessness that
strongly impacts the everyday lives of epileptic
patients. If computational algorithms could reliably
predict seizure occurrences, devices designed to
warn patients of impending seizures would help
patients avoid potentially dangerous activities. Also,
medications could be taken only when necessary to
reduce overall side effects.

An epileptic patient’s brain activity can be clas-
siﬁed into 4 states: Interictal (between seizures, or
baseline), Preictal (prior to seizure), Ictal (seizure),
and Post-ictal (after seizures). The primary chal-
lenge in seizure forecasting is to differentiate be-
tween the preictal and interictal states. Past research
on seizure forecasting based on EEG has pointed out
two difﬁculties. First, preictal and interictal EEG

patterns across patients (and dogs) vary consider-
ably. Second, EEG is highly complex and varies
over time.

II. OBJECTIVE

This project represents an attempt to demonstrate
the existence and accurate classiﬁcation of the pre-
ictal brain state in dogs and humans with naturally
occurring epilepsy.

III. DATA

Data used in this project, which we obtained
from a Kaggle competition, are intracranial elec-
troencephalography (EEG) recordings sampled from
dogs and patients. The training data are organized
into ten-minute EEG clips labeled "Preictal" for pre-
seizure data segments, or "Interictal" for non-seizure
data segments. Both the preictal and interictal train-
ing data segments are numbered sequentially. The
sequence, numbered 1 - 6, represents the index of
the data segment within an hour. For example, the
sequence 6 preictal data segment represents the EEG
data between the 51st minute and the 60th minute
in the hour before a seizure occurrence. The test
data, which are preictal, are also organized into ten-
minutes EEG clips but are provided in random order.
This allows us to pick any test data segment to
verify the accuracy of every time sequence’s training
model.

Preictal training and test data segments cover one
hour prior to seizure with a ﬁve-minute seizure
horizon (Figure 1). Similarly, one hour sequences
of interictal ten-minute data segments are provided.

A. EEG recording for dogs

Intracranial EEG for dogs are sampled from 16
electrodes at 400 Hz. Thus, the canine data contain
16 features, and the data for each ten-minute time
sequence contain 16 × 240, 000 data points. Each

1

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

Fig. 1: EEG recordings cover one hour

prior to seizure with a ﬁve-minute

seizure horizon

data point represents the EEG recording for elec-
trode i at some time t. The competition provided
EEG recordings for 5 dogs. We choose to use the
ﬁrst hour (6 sequences) training data for dogs 1 and
5.

IV. MODELS

A. Logistic Regression

This is a binary classiﬁcation problem, so the ﬁrst
intuitive choice is logistic regression with sigmoid
function hθ(x). We apply stochastic gradient ascent
to the following equation:

:= θj + α(y(i) − hθ(x(i)))x(i)

j

θj

where hθ(x) = g(θTx) =

1

1 + e−θTx

A ﬁxed learning rate α is used, and the imple-
mentation slowly decreases α to some value around
zero to ensure the algorithm converges to the global
minimum.

B. Support Vector Machine (SVM)

The goal of SVM classiﬁcation is to establish
and test a mapping x (cid:55)→ y from EEG spectral
features to either a preictal or an interictal label.
To achieve this goal, we use C-support vector
classiﬁcation which solves the following primal
optimization problems:

min
w,b,ξ

1
2

wTw + C

l(cid:88)

i=1

ξi

subject to yi(wTφ(xi) + b) ≥ 1 − ξi,

ξi ≥ 0, i = 1, . . . , l,

where φ(xi) maps xi into a higher-dimension space
and C > 0 is the regularization parameter. We use
the radial basis function (RBF) kernel:

K(xi, xj) = exp(−γ(cid:107)xi − xj(cid:107)2)

There are two model parameters: C and the kernel
factor γ. Using the grid search approach, we try
all combinations of C and γ, and select the com-
bination that produces the maximum classiﬁcation
accuracy. The search range for log C is from -1 to
6, and for log γ is from -3 to 4.

We then run C-SVM with the selected C and γ.
We use the same C and γ for each (individual and
combined) time sequence.

Fig. 2: EEG recordings cover one hour

prior to seizure with a ﬁve-minute

seizure horizon

B. EEG recording for patients

Intracranial EEG for patients are sampled from
15 electrodes at 5,000 Hz. Thus, the human data
contain 15 features, and the data for each ten-
minute time sequence contain 15 × 3000, 000 data
points. The competition provided EEG recordings
for 2 patients. We choose to use the ﬁrst hour (6
sequences) training data for patient 1.

2

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

C. Calculating False Negative Rates

B. Dogs

Data for dogs and patients are categorized as
either preictal or interictal. For logistic regression,
we label preictal data examples as positive ("1"),
and interictal data examples as negative ("0"). For
SVM, we label preictal data examples as positive
("1"), and interictal examples as negative ("-1").
All test examples should be predicted as preictal,
which is positive ("1"). We are interested in the
false negative rate, which is the fraction of the
preictal test examples that the algorithm incorrectly
predicts to be interictal. A small false negative rate
implies a high probability of seizure occurrences.
In the following equation, RF N stands for false
negative rate.

RF N =

# of test examples predicted to be interictal

# of test examples

We apply logistic regression to a time sequence
10 times using 10 different
test data segments,
and compute the average of the 10 false negative
rates. We repeat this step for the other ﬁve time
sequence and compare the average false negative
rates. (For SVM, the process is the same except
we use 5 different test data segments). The time
sequence with the lowest average false negative
rate is the best
in predicting seizures. We then
combine some continuous or randomly selected ten-
minute sequences, and run the algorithms again,
calculate and compare the average false negative
rates to observe whether combining time sequences
improves the accuracy of seizure predictions.

V. RESULTS

A. SVM parameter selection

Because of the extremely long training time, we
select the last 16 × 80, 000 examples in the canine
data, and the last 15 × 100, 000 examples in the
human data to grid-search the optimal values of C
and γ.

Dog 1
Dog 5
Patient 1

C γ
8
2
2
8
1
2

Accuracy
77.8919%
84.9231%
100.0%

TABLE I: Cross Validation Results for C and γ

3

We use all the canine data, 16 × 240, 000, to
run logistic regression. Due to the aforementioned
time constraint, we use only the last 16 × 80, 000
canine training examples in each time sequence to
run SVM. We then combine sequences 1, 6 and
sequences 3, 6 to examine if the accuracy can be
improved. See Figure 3, 4, and Table II for Dog 1
and Dog 5 results.

e
t
a
R
N
F

e
g
a
r
e
v
A

e
t
a
R
N
F

e
g
a
r
e
v
A

1

0.8

0.6

0.4

0.2

0

1

0.8

0.6

0.4

0.2

0

1

2

3

4

5

6

Logistic Regression

SVM

(a) Sequences 1 to 6

4&5

5&6

Logistic Regression

SVM

(b) Combined Sequences
Fig. 3: Dog 1 Results

Dog 1
seq 1
seq 2
seq 3
seq 4
seq 5
seq 6

seq 1&6
seq 3&6
Dog 5
seq 1
seq 2
seq 3
seq 4
seq 5
seq 6

Logistic Regression

0.287635
0.355074
0.253306
0.363520
0.441084
0.408698
0.394584
0.400128

SVM

0.999345
0.143058
0.877420
0.279950
0.140827
0.931298
0.977588
0.958088

Logistic Regression

SVM

0.999345
0.143058
0.877420
0.279950
0.140827
0.931298
seq 1&6
0.977588
seq 3&6
0.958088
TABLE II: Dogs 1 and 5 Results

0.293179
0.446686
0.366449
0.526572
0.557142
0.307605
0.370788
0.385755

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

e
t
a
R
N
F

e
g
a
r
e
v
A

e
t
a
R
N
F

e
g
a
r
e
v
A

1

0.8

0.6

0.4

0.2

0

1

0.8

0.6

0.4

0.2

0

1

2

3

4

5

6

Logistic Regression

SVM

(a) Sequences 1 to 6

4&5

5&6

Logistic Regression

SVM

(b) Combined Sequences
Fig. 4: Dog 5 Results

C. Patients

We use all the human data, 15×3, 000, 000, to run
logistic regression. Due to the aforementioned time
constraint, we use only the last 15×100, 000 training
examples in each time sequence to run SVM. We
then combine sequences 4, 5 and sequences 5, 6
to examine if the accuracy can be improved. See
Figure 5 and Table III for Patient 1 results.

e
t
a
R
N
F

e
g
a
r
e
v
A

1

0.8

0.6

0.4

0.2

0

1

3

4

2
Logistic Regression

5

6 4&5 5&6

SVM

Fig. 5: Histogram of Patients 1 Results

VI. DISCUSSION & CONCLUSION

Based on the results of dogs and patients, we
observe that combining time sequences does not

4

Patient 1

Logistic Regression

SVM

seq 1
seq 2
seq 3
seq 4
seq 5
seq 6

seq 4&5
seq 5&6

0.527982
0.543429
0.486822
0.453055
0.481161
0.523835
0.481130
0.548151

0.083046
0.225166
0.055214
0.186868
0.140582

0

0.093442
0.005538

TABLE III: Patient 1 Results

improve the results. None of the combined se-
quences produce false negative rates smaller than
the minimum of the individual sequences’ false
negative rates. Although this contradicts the intuitive
conjecture that adding more data should improve
results, the ﬁnding is not entirely surprising because
previous research has pointed out that EEG is highly
complex and varies over time. If there is little cor-
relation between any time sequences, continuous or
random selected, then combining sequences would
only add noise to each model and should not be
expected to yield better predictions.

Interestingly, while sequences 1, 3, 6 in the
human data give low SVM false negative rates,
sequences 1, 3, 6 in the canine data give surprisingly
high SVM false negative rates (close to 1). Our
surmise is that logistic regression may not have
classiﬁed the preictal and interictal states correctly
because we omitted the process of cross validation
before performing logistic regression.

We observe some patterns from the results of
the two dogs. The logistic regression false negative
rates ﬂuctuate (increase, decrease,
increase, and
ﬁnally decrease), while the SVM false negative rates
exhibit an entirely opposite, and much more volatile
trend. These trends may be evidence that pre-seizure
brain activities exhibit a high degree of ﬂuctuation.
If future medical devices can detect such ﬂuctua-
tion, then warning epileptic patients of impending
seizures may be achievable. This approach may be
more effective in forecasting seizures than solely
focusing on the false negative rates of speciﬁc time
sequences.

According to the results of patient 1, SVM
outperforms logistic regression as expected. SVM
results are all < 25%. This means that we are able to
predict seizures with reasonable accuracy. However,
all logistic regression false negative rates are around
50%. Such relative "uniformity" makes it difﬁcult to
interpret which time sequences are better in seizure

Predicting Seizures in Intracranial EEG Recordings

CS229 Final Project, 2014 Fall

forecasting than others. The 0 false negative rate for
sequence 6 is surprising. However, since sequence
6 closely precedes seizures, the brain’s behavior is
expected to differ drastically from that during non-
seizure periods, thus the low false negative error.

After comparing the results between dogs and
patient, we observe that sequence 6 has the lowest
false negative rate for patient 1 but not for dogs.
This inconsistency implies that the pathogenesis of
epilepsy may be different across different species.
Hence, applying the same training models to both
dogs and patients may be problematic.

[3] Y. Park, L. Luo, K. Parhi and T. Netoff

(2011). Seizure
prediction with spectral power of EEG using cost-sensitive
support vector machines. Epilepsia 52:1761-1770.

[4] J. Howbert, E. Patterson, S. Stead, B. Brinkmann, V. Vasoli,
D. Crepeau, C. Vite and B. Sturges (2014, Jan). Forecasting
Seizures in Dogs with Naturally Occurring Epilepsy. PLoS One
9(1):e81920.

[5] Snyder DE, Echauz J, Grimes DB, Litt B (2008) The statistics
of a practical seizure warning system. J Neural Eng 5: 392?401.
doi: 10.1088/1741-2560/5/4/004

[6] American Epilepsy Society Seizure Prediction Challenge. [On-

line] https://www.kaggle.com/c/seizure-prediction

VII. FUTURE

• This competition also provided data for another
three dogs and one patient. Furthermore, for
each dog and each patient, multiple hours’
worth of data are available. We could run the
same algorithms several more times to observe
patterns and anomalies. The new results could
be used to verify our conclusions.

• Instead of 6 sequences, we could divide an hour
into 12 or more sequences. That would give
us a better understanding of the pathogenesis
of epileptic seizures and the variation of the
prediction results within shorter time intervals.
• Logistic regression does not work well for
patient 1. The reason might be that human
brains are much more complicated than canine
brains. We could apply logistic regression with
regularization to ameliorate the high variance
problem.

• SVM does not work well for dogs at sequences
1, 3 and 6. The cause is the large number of
support vectors. Since the the number of sup-
port vectors determines the maximum number
of misclassiﬁed data points, we could apply ν-
SVM instead of C-SVM, and set ν = 0.5. This
approach would force only half of our data to
be support vectors and implicitly adapt C.

REFERENCES

[1] C. Hsu, C. Chang

and C. Lin.

Practical Guide to Support Vector Classiﬁcation.
http://www.csie.ntu.edu.tw/ cjlin/papers/guide/guide.pdf.

(2010, April). A
[Online]

[2] R. Andrzejak, D. Chicharro, C. Elger and F. Mormann
(2009, July). Seizure prediction: Any better than chance? Clin
Neurophysiol.

5


 

Prediction of Transcription Factors that Regulate Common Binding Motifs 

Dana Wyman and Emily Alsentzer 

CS 229, Fall 2014 

Introduction 
A.  Background 
Proper  regulation  of  mRNA  levels  is  essential  to 
nearly  all  cellular  processes.  Transcription  factors 
are  responsible  for  regulating  levels  of  mRNA.  By 
binding  to  a  specific  DNA  sequence  via  a  DNA-
binding domain, transcription factors can promote or 
block  the  recruitment  of  RNA  polymerase,  an 
enzyme  responsible  for  transcription,  effectively 
controlling  when  and  how  much  of  a  gene  is 
expressed  [1].    Predicting  the  binding  sites  of 
transcription factors is an important area of research, 
as  identifying  these  regulatory  sites  can  shed  light 
on  the  mechanisms  that  regulate  specific  genes.  A 
variety of algorithms have been developed in order 
to predict transcription factor binding sites (TFBSs) 
a priori [2]. These techniques have the potential to 
identify  novel  transcription  factor  binding  motifs. 
However,  in  some  cases,  the  transcription  factor 
responsible  for  binding  a  given  motif  is  unknown. 
Here,  we  address 
issue  using  gene  set 
composition  to  predict  which  transcription  factors 
bind common binding motifs.  This approach differs 
from  other  work  in  the  field,  as  previous  efforts 
have mainly focused on predicting targets of known 
transcription factors. 
 
B.  Data 
 I. Gene Sets 

this 

A  common  way  of  determining  which 
transcription factor regulates a given gene is to look 
for  characteristic  DNA  binding  motifs  within  the 
promoter  of 
the  gene  [3].  In  general,  each 
transcription factor has a motif around 10 base pairs 
in  length  to  which  it  preferentially  binds  [1].  
Therefore,  it  is  possible  to  sequence  genes  and 
group  them  based  on  which  transcription  factor 
site(s) their promoters contain.  One of our datasets 
is  a  list  of  transcription  factor-gene  sets  compiled 
from 
the  ChIP  Enrichment  Analysis  system 
(CHEA), the Broad Institute MsigDB database, and 
the  Encyclopedia  of  DNA  Elements  (ENCODE) 

 

1 

Project  [4].    It  includes  757  transcription  factors, 
along with the set of genes that each is expected to 
bind to and regulate, and some transcription factors 
appear with multiple gene sets. 
 
II. Expression Data 

RNA-seq  is  a  recent  technique  used  to 
quantify  gene  expression  by  directly  sequencing 
RNA molecules from a cell sample. The sequenced 
RNA  is  converted  to  a  library  of  cDNA  fragments 
and mapped to specific genes in the genome, and the 
number of reads for a gene can be used to quantify 
gene expression [5]. Fragments per kilobase of exon 
per  million  reads  mapped  (FPKM)  measurements 
are often used to quantify gene expression because 
they  allow  for  normalization  of  reads  by  gene 
length.  FPKM is defined as the following: 
 

where !!=  number  of  reads  that  align  to  a  gene,    
!!!= effective length of a gene, and N = number of 

!"#$!=!!!!!!∗10! 

 

 

reads sequenced [5]. 
Our dataset contains RNA-seq FPKM measurements 
from 95 human individuals across 27 different tissue 
types [6]. Each tissue sample contains F 
PKM measurements for 20,050 genes. The data was 
retrieved 
from  ArrayExpress  under  accession 
number E-MTAB-1733 [7]. 
 
Methods 
I.  Data Preprocessing 
A. Expression Data 

In  the  original  table,  genes  were  labeled 
using  the  Ensembl  gene  ID  convention.  These 
identifiers  are  not  directly  compatible  with  other 
bioinformatics  resources,  so  Biomart  was  used  to 
generate  a  mapping  of  Ensembl  IDs  to  official 
HGNC  gene  symbols  [8].      When  a  gene  symbol 
appeared  more 
table,  gene 
expression was summed across the rows to produce 
a  single  entry.  Finally,  FPKM  values  were  log2-

than  once 

the 

in 

 

Prediction of Transcription Factors that Regulate Common Binding Motifs 

Dana Wyman and Emily Alsentzer 

CS 229, Fall 2014 

Introduction 
A.  Background 
Proper  regulation  of  mRNA  levels  is  essential  to 
nearly  all  cellular  processes.  Transcription  factors 
are  responsible  for  regulating  levels  of  mRNA.  By 
binding  to  a  specific  DNA  sequence  via  a  DNA-
binding domain, transcription factors can promote or 
block  the  recruitment  of  RNA  polymerase,  an 
enzyme  responsible  for  transcription,  effectively 
controlling  when  and  how  much  of  a  gene  is 
expressed  [1].    Predicting  the  binding  sites  of 
transcription factors is an important area of research, 
as  identifying  these  regulatory  sites  can  shed  light 
on  the  mechanisms  that  regulate  specific  genes.  A 
variety of algorithms have been developed in order 
to predict transcription factor binding sites (TFBSs) 
a priori [2]. These techniques have the potential to 
identify  novel  transcription  factor  binding  motifs. 
However,  in  some  cases,  the  transcription  factor 
responsible  for  binding  a  given  motif  is  unknown. 
Here,  we  address 
issue  using  gene  set 
composition  to  predict  which  transcription  factors 
bind common binding motifs.  This approach differs 
from  other  work  in  the  field,  as  previous  efforts 
have mainly focused on predicting targets of known 
transcription factors. 
 
B.  Data 
 I. Gene Sets 

this 

A  common  way  of  determining  which 
transcription factor regulates a given gene is to look 
for  characteristic  DNA  binding  motifs  within  the 
promoter  of 
the  gene  [3].  In  general,  each 
transcription factor has a motif around 10 base pairs 
in  length  to  which  it  preferentially  binds  [1].  
Therefore,  it  is  possible  to  sequence  genes  and 
group  them  based  on  which  transcription  factor 
site(s) their promoters contain.  One of our datasets 
is  a  list  of  transcription  factor-gene  sets  compiled 
from 
the  ChIP  Enrichment  Analysis  system 
(CHEA), the Broad Institute MsigDB database, and 
the  Encyclopedia  of  DNA  Elements  (ENCODE) 

 

1 

Project  [4].    It  includes  757  transcription  factors, 
along with the set of genes that each is expected to 
bind to and regulate, and some transcription factors 
appear with multiple gene sets. 
 
II. Expression Data 

RNA-seq  is  a  recent  technique  used  to 
quantify  gene  expression  by  directly  sequencing 
RNA molecules from a cell sample. The sequenced 
RNA  is  converted  to  a  library  of  cDNA  fragments 
and mapped to specific genes in the genome, and the 
number of reads for a gene can be used to quantify 
gene expression [5]. Fragments per kilobase of exon 
per  million  reads  mapped  (FPKM)  measurements 
are often used to quantify gene expression because 
they  allow  for  normalization  of  reads  by  gene 
length.  FPKM is defined as the following: 
 

where !!=  number  of  reads  that  align  to  a  gene,    
!!!= effective length of a gene, and N = number of 

!"#$!=!!!!!!∗10! 

 

 

reads sequenced [5]. 
Our dataset contains RNA-seq FPKM measurements 
from 95 human individuals across 27 different tissue 
types [6]. Each tissue sample contains F 
PKM measurements for 20,050 genes. The data was 
retrieved 
from  ArrayExpress  under  accession 
number E-MTAB-1733 [7]. 
 
Methods 
I.  Data Preprocessing 
A. Expression Data 

In  the  original  table,  genes  were  labeled 
using  the  Ensembl  gene  ID  convention.  These 
identifiers  are  not  directly  compatible  with  other 
bioinformatics  resources,  so  Biomart  was  used  to 
generate  a  mapping  of  Ensembl  IDs  to  official 
HGNC  gene  symbols  [8].      When  a  gene  symbol 
appeared  more 
table,  gene 
expression was summed across the rows to produce 
a  single  entry.  Finally,  FPKM  values  were  log2-

than  once 

the 

in 

 

transformed,  which 
processing step.   
 
B. Gene Set Filtering 
 

All  gene  sets  for  species  other  than  Homo 
sapiens  were  removed.    After  filtering,  the  data 
contained 757 gene sets.  
 
II.  Assessing 

Relationship 

Between 

the 

Transcription Factor and Gene Set Expression 

first 

tested 

In  order 

to  determine  whether  gene 
expression  data  could  be  used 
to  predict 
transcription  factors  that  regulate  common  binding 
motifs,  we 
that 
transcription  factors  and  their  gene  targets  have 
correlated expression profiles. For each gene set, we 
computed the sum of the Euclidean distance of the 
TF from each gene in the gene set as shown: 
 

!"−!"#"

!!!"!#!$=!

the  assumption 

 
Then,  we  repeated  the  above  calculation  using  a 
random  gene  set  selected  from  a  list  of  the  genes 
across  all  gene  sets,  and  calculated  the  fraction  of 
times  that  value  obtained  with  a  random  gene  set 
was 
the  original  Dgeneset  out  of  N 
repetitions. Here N = 100. 
 

than 

less 

!"#"

Level  Name 

Definition 

1 

2 

3 

4 

5 

6 

Superclass 

General topology of the DBD* 

Class 

Family 

Structural blueprint of the DBD 

Sequence and functional 
similarities 

Subfamily 

Sequence-based subgroups 

Genus 

TF gene 

Factor 
‘species’ 

TF polypeptide 

 Table  1.  TFClass  Hierarchy  Definitions.  *DBD  =  DNA 
binding domain [9].  

 

2 

is  a 

standard  RNA-seq 

 

Category 
Number 

Description 

Training 
Examples 

1 
2 

3 

6 
1.1 

1.2 

2.1 

2.3 

3.1 

3.3 

3.5 

Basic Domains 
Zinc-coordinating 
DNA-binding domain 
Helix-turn-helix 
domain 
Immunoglobulin folds 
Basic leucine zipper 
factors (bZIP) 
Basic helix-loop-helix 
factors (bHLH) 
Nuclear receptors with 
C4 zinc fingers 
C2H2 zinc finger 
factors 
Homeo domain 
factors 
Fork head / winged 
helix factors 
Tryptophan cluster 
factors 
STAT domain factors 

81 
113 

105 

33 
44 

37 

42 

71 

41 

31 

17 

19 

6.2 

!!""#$#%&'=!

!

!{!!!"#"$"%
!
!

!!!"#"$"%}

 

Table 2. Superclasses and classes used 

 
II.  Classification of Transcription Factors Using the 
TFClass Hierarchy 

To  make  the  number  of  response  classes  in 
the  data  more  tractable  for  machine  learning,  the 
transcription factors were organized separately into 
superclasses  and  classes  using 
the  TFClass 
framework  orders 
hierarchy 
transcription  factors  based  on 
their  mode  of 
interaction  with  DNA  [9].  The  TFClass  Hierarchy 
(Sept.  2014  version)  was  downloaded  in  the  .obo 
ontology  format  [9].    The  superclass  and  class  of 
each transcription factor from the gene set data was 

(Table  1).  This 

 

Prediction of Transcription Factors that Regulate Common Binding Motifs 

Dana Wyman and Emily Alsentzer 

CS 229, Fall 2014 

Introduction 
A.  Background 
Proper  regulation  of  mRNA  levels  is  essential  to 
nearly  all  cellular  processes.  Transcription  factors 
are  responsible  for  regulating  levels  of  mRNA.  By 
binding  to  a  specific  DNA  sequence  via  a  DNA-
binding domain, transcription factors can promote or 
block  the  recruitment  of  RNA  polymerase,  an 
enzyme  responsible  for  transcription,  effectively 
controlling  when  and  how  much  of  a  gene  is 
expressed  [1].    Predicting  the  binding  sites  of 
transcription factors is an important area of research, 
as  identifying  these  regulatory  sites  can  shed  light 
on  the  mechanisms  that  regulate  specific  genes.  A 
variety of algorithms have been developed in order 
to predict transcription factor binding sites (TFBSs) 
a priori [2]. These techniques have the potential to 
identify  novel  transcription  factor  binding  motifs. 
However,  in  some  cases,  the  transcription  factor 
responsible  for  binding  a  given  motif  is  unknown. 
Here,  we  address 
issue  using  gene  set 
composition  to  predict  which  transcription  factors 
bind common binding motifs.  This approach differs 
from  other  work  in  the  field,  as  previous  efforts 
have mainly focused on predicting targets of known 
transcription factors. 
 
B.  Data 
 I. Gene Sets 

this 

A  common  way  of  determining  which 
transcription factor regulates a given gene is to look 
for  characteristic  DNA  binding  motifs  within  the 
promoter  of 
the  gene  [3].  In  general,  each 
transcription factor has a motif around 10 base pairs 
in  length  to  which  it  preferentially  binds  [1].  
Therefore,  it  is  possible  to  sequence  genes  and 
group  them  based  on  which  transcription  factor 
site(s) their promoters contain.  One of our datasets 
is  a  list  of  transcription  factor-gene  sets  compiled 
from 
the  ChIP  Enrichment  Analysis  system 
(CHEA), the Broad Institute MsigDB database, and 
the  Encyclopedia  of  DNA  Elements  (ENCODE) 

 

1 

Project  [4].    It  includes  757  transcription  factors, 
along with the set of genes that each is expected to 
bind to and regulate, and some transcription factors 
appear with multiple gene sets. 
 
II. Expression Data 

RNA-seq  is  a  recent  technique  used  to 
quantify  gene  expression  by  directly  sequencing 
RNA molecules from a cell sample. The sequenced 
RNA  is  converted  to  a  library  of  cDNA  fragments 
and mapped to specific genes in the genome, and the 
number of reads for a gene can be used to quantify 
gene expression [5]. Fragments per kilobase of exon 
per  million  reads  mapped  (FPKM)  measurements 
are often used to quantify gene expression because 
they  allow  for  normalization  of  reads  by  gene 
length.  FPKM is defined as the following: 
 

where !!=  number  of  reads  that  align  to  a  gene,    
!!!= effective length of a gene, and N = number of 

!"#$!=!!!!!!∗10! 

 

 

reads sequenced [5]. 
Our dataset contains RNA-seq FPKM measurements 
from 95 human individuals across 27 different tissue 
types [6]. Each tissue sample contains F 
PKM measurements for 20,050 genes. The data was 
retrieved 
from  ArrayExpress  under  accession 
number E-MTAB-1733 [7]. 
 
Methods 
I.  Data Preprocessing 
A. Expression Data 

In  the  original  table,  genes  were  labeled 
using  the  Ensembl  gene  ID  convention.  These 
identifiers  are  not  directly  compatible  with  other 
bioinformatics  resources,  so  Biomart  was  used  to 
generate  a  mapping  of  Ensembl  IDs  to  official 
HGNC  gene  symbols  [8].      When  a  gene  symbol 
appeared  more 
table,  gene 
expression was summed across the rows to produce 
a  single  entry.  Finally,  FPKM  values  were  log2-

than  once 

the 

in 

 

transformed,  which 
processing step.   
 
B. Gene Set Filtering 
 

All  gene  sets  for  species  other  than  Homo 
sapiens  were  removed.    After  filtering,  the  data 
contained 757 gene sets.  
 
II.  Assessing 

Relationship 

Between 

the 

Transcription Factor and Gene Set Expression 

first 

tested 

In  order 

to  determine  whether  gene 
expression  data  could  be  used 
to  predict 
transcription  factors  that  regulate  common  binding 
motifs,  we 
that 
transcription  factors  and  their  gene  targets  have 
correlated expression profiles. For each gene set, we 
computed the sum of the Euclidean distance of the 
TF from each gene in the gene set as shown: 
 

!"−!"#"

!!!"!#!$=!

the  assumption 

 
Then,  we  repeated  the  above  calculation  using  a 
random  gene  set  selected  from  a  list  of  the  genes 
across  all  gene  sets,  and  calculated  the  fraction  of 
times  that  value  obtained  with  a  random  gene  set 
was 
the  original  Dgeneset  out  of  N 
repetitions. Here N = 100. 
 

than 

less 

!"#"

Level  Name 

Definition 

1 

2 

3 

4 

5 

6 

Superclass 

General topology of the DBD* 

Class 

Family 

Structural blueprint of the DBD 

Sequence and functional 
similarities 

Subfamily 

Sequence-based subgroups 

Genus 

TF gene 

Factor 
‘species’ 

TF polypeptide 

 Table  1.  TFClass  Hierarchy  Definitions.  *DBD  =  DNA 
binding domain [9].  

 

2 

is  a 

standard  RNA-seq 

 

Category 
Number 

Description 

Training 
Examples 

1 
2 

3 

6 
1.1 

1.2 

2.1 

2.3 

3.1 

3.3 

3.5 

Basic Domains 
Zinc-coordinating 
DNA-binding domain 
Helix-turn-helix 
domain 
Immunoglobulin folds 
Basic leucine zipper 
factors (bZIP) 
Basic helix-loop-helix 
factors (bHLH) 
Nuclear receptors with 
C4 zinc fingers 
C2H2 zinc finger 
factors 
Homeo domain 
factors 
Fork head / winged 
helix factors 
Tryptophan cluster 
factors 
STAT domain factors 

81 
113 

105 

33 
44 

37 

42 

71 

41 

31 

17 

19 

6.2 

!!""#$#%&'=!

!

!{!!!"#"$"%
!
!

!!!"#"$"%}

 

Table 2. Superclasses and classes used 

 
II.  Classification of Transcription Factors Using the 
TFClass Hierarchy 

To  make  the  number  of  response  classes  in 
the  data  more  tractable  for  machine  learning,  the 
transcription factors were organized separately into 
superclasses  and  classes  using 
the  TFClass 
framework  orders 
hierarchy 
transcription  factors  based  on 
their  mode  of 
interaction  with  DNA  [9].  The  TFClass  Hierarchy 
(Sept.  2014  version)  was  downloaded  in  the  .obo 
ontology  format  [9].    The  superclass  and  class  of 
each transcription factor from the gene set data was 

(Table  1).  This 

 

obtained by matching its name against the records in 
this  ontology.    When  a  factor  failed  to  match,  its 
synonyms were used to search the hierarchy as well.  
At  both  the  class  and  superclass  level,  categories 
with fewer than 15 training examples were omitted. 
After this filtering, four superclasses (1, 2, 3, and 6) 
remained, as well as eight classes (1.1, 1.2, 2.1, 2.3, 
3.1, 3.3, 3.5, and 6.2) (Table 2). 
 
III.   Multinomial Elastic Net Regression 
A. Features 

implemented 

We  decided 

that  multinomial 

Each  of  the  12,089  features  is  a  gene  that 
appears at least once in any transcription factor gene 
set.  The presence of a given gene in the gene set of 
a  transcription  factor  is  represented  by  a  1  at  that 
index, and its absence is represented by 0. 
 
B. GLMnet Model 
logistic 
 
regression  was 
the  most  appropriate  machine 
learning  method  for  this  problem  because  the  data 
contains more than two classes and has binary rather 
than  continuous  numerical  features.    Because  there 
are  many  fewer  gene  set  examples  than  individual 
genes,  the  dataset  is  prone  to  overfitting.  To  best 
address  this,  we  chose  multinomial  elastic  net 
regression  as 
the  GLMnet  R 
package because it allows for variable selection via 
regularization  with  combined  L1  and  L2  norm 
penalization  [10].    After  the  model  was  trained  on 
all  of  the  data,  10-fold  cross  validation  was 
performed to obtain the test error.Equations for the 
multinomial  model  are  shown  here  as  described  in 
the GLMnet Documentation [10]: 
 
Suppose  the  response  variable  has  K  levels  G  = 
{1,2,…,K}. Here we model:  
 

!!!!!!!!!
Pr!=!!=! =!
!!!!!!!!!
!!!!
elements !!!=!(!!=!!.!! Then 
! !!!,!! !! =!− 1!
!!!!!!!!!!
!!"!!!+!!!!! −!"#

 
Let Y be the N x K indicator response matrix, with 
the  elastic-net 
!
penalized negative log-likelihood function becomes 
!!!

!!. 

!
!!!

!
!!!

in 

 

 

3 

Distribution of Bootstrap P-values 
Measuring SImilarity of Transcription 
Factor and Gene Set Expression!

400!
300!
200!
100!
0!

!

y
c
n
e
u
q
e
r
F

!
5
0
.
0
-
0

!
1
.
0
-
5
0
.
0

!
5
1
.
0
-
1
.
0

!
2
.
0
-
5
1
.
0

!
5
2
.
0
-
2
.
0

!
3
.
0
-
5
2
.
0

!
5
3
.
0
-
3
.
0

!
4
.
0
-
5
3
.
0

!
5
4
.
0
-
4
.
0

!
5
.
0
-
5
4
.
0

!
5
5
.
0
-
5
.
0

!
6
.
0
-
5
5
.
0

!
5
6
.
0
-
6
.
0

!
7
.
0
-
5
6
.
0

!
5
7
.
0
-
7
.
0

!
8
.
0
-
5
7
.
0

!
5
8
.
0
-
8
.
0

!
9
.
0
-
5
8
.
0

!
5
9
.
0
-
9
.
0

!
1
-
5
9
.
0

Bootstrap P-values!

+!!

!
!!!

!! !

. 

+!! 1−! ! !!
2

Figure  1:  Distribution  of  Bootstrap  P-values  Measuring 
Similarity  of  Transcription  Factor  and  Gene  Set 
Expression. Out of 631 gene sets tested, 291 had a significant 
p-value  (threshold  of  0.05).  This 
that  some 
transcription  factors  show  similar  expression  to  that  of  their 
gene sets across tissues, but it is not a valid assumption for the 
entire data set. 

indicates 

 

where ! is  a !!!!!matrix  of  coefficients. !! refers 
to the kth column (for outcome   category k), and !! 

It  has  been  proposed  previously 

the jth row (vector of K coefficients for variable j). 
 
Results 
 
that 
transcription  factors  exhibit  similar  expression  to 
that  of  the  targets  they  regulate  [3].  After  an 
unsuccessful attempt to use elastic net regression to 
predict  transcription  factors  using  gene  expression, 
we  decided  to  test  the  validity  of  this  statement  in 
our  data.  To  do  this,  we  calculated  the  Euclidean 
distance of the transcription factor to every gene in 

Superclass  Training Error  Test Error 

1 
2 
3 
6 

11% 
0.88% 
12% 
15% 

48% 
28% 
43% 
45% 

 

Table 3. GLMNet Error for Superclasses 

 

Prediction of Transcription Factors that Regulate Common Binding Motifs 

Dana Wyman and Emily Alsentzer 

CS 229, Fall 2014 

Introduction 
A.  Background 
Proper  regulation  of  mRNA  levels  is  essential  to 
nearly  all  cellular  processes.  Transcription  factors 
are  responsible  for  regulating  levels  of  mRNA.  By 
binding  to  a  specific  DNA  sequence  via  a  DNA-
binding domain, transcription factors can promote or 
block  the  recruitment  of  RNA  polymerase,  an 
enzyme  responsible  for  transcription,  effectively 
controlling  when  and  how  much  of  a  gene  is 
expressed  [1].    Predicting  the  binding  sites  of 
transcription factors is an important area of research, 
as  identifying  these  regulatory  sites  can  shed  light 
on  the  mechanisms  that  regulate  specific  genes.  A 
variety of algorithms have been developed in order 
to predict transcription factor binding sites (TFBSs) 
a priori [2]. These techniques have the potential to 
identify  novel  transcription  factor  binding  motifs. 
However,  in  some  cases,  the  transcription  factor 
responsible  for  binding  a  given  motif  is  unknown. 
Here,  we  address 
issue  using  gene  set 
composition  to  predict  which  transcription  factors 
bind common binding motifs.  This approach differs 
from  other  work  in  the  field,  as  previous  efforts 
have mainly focused on predicting targets of known 
transcription factors. 
 
B.  Data 
 I. Gene Sets 

this 

A  common  way  of  determining  which 
transcription factor regulates a given gene is to look 
for  characteristic  DNA  binding  motifs  within  the 
promoter  of 
the  gene  [3].  In  general,  each 
transcription factor has a motif around 10 base pairs 
in  length  to  which  it  preferentially  binds  [1].  
Therefore,  it  is  possible  to  sequence  genes  and 
group  them  based  on  which  transcription  factor 
site(s) their promoters contain.  One of our datasets 
is  a  list  of  transcription  factor-gene  sets  compiled 
from 
the  ChIP  Enrichment  Analysis  system 
(CHEA), the Broad Institute MsigDB database, and 
the  Encyclopedia  of  DNA  Elements  (ENCODE) 

 

1 

Project  [4].    It  includes  757  transcription  factors, 
along with the set of genes that each is expected to 
bind to and regulate, and some transcription factors 
appear with multiple gene sets. 
 
II. Expression Data 

RNA-seq  is  a  recent  technique  used  to 
quantify  gene  expression  by  directly  sequencing 
RNA molecules from a cell sample. The sequenced 
RNA  is  converted  to  a  library  of  cDNA  fragments 
and mapped to specific genes in the genome, and the 
number of reads for a gene can be used to quantify 
gene expression [5]. Fragments per kilobase of exon 
per  million  reads  mapped  (FPKM)  measurements 
are often used to quantify gene expression because 
they  allow  for  normalization  of  reads  by  gene 
length.  FPKM is defined as the following: 
 

where !!=  number  of  reads  that  align  to  a  gene,    
!!!= effective length of a gene, and N = number of 

!"#$!=!!!!!!∗10! 

 

 

reads sequenced [5]. 
Our dataset contains RNA-seq FPKM measurements 
from 95 human individuals across 27 different tissue 
types [6]. Each tissue sample contains F 
PKM measurements for 20,050 genes. The data was 
retrieved 
from  ArrayExpress  under  accession 
number E-MTAB-1733 [7]. 
 
Methods 
I.  Data Preprocessing 
A. Expression Data 

In  the  original  table,  genes  were  labeled 
using  the  Ensembl  gene  ID  convention.  These 
identifiers  are  not  directly  compatible  with  other 
bioinformatics  resources,  so  Biomart  was  used  to 
generate  a  mapping  of  Ensembl  IDs  to  official 
HGNC  gene  symbols  [8].      When  a  gene  symbol 
appeared  more 
table,  gene 
expression was summed across the rows to produce 
a  single  entry.  Finally,  FPKM  values  were  log2-

than  once 

the 

in 

 

transformed,  which 
processing step.   
 
B. Gene Set Filtering 
 

All  gene  sets  for  species  other  than  Homo 
sapiens  were  removed.    After  filtering,  the  data 
contained 757 gene sets.  
 
II.  Assessing 

Relationship 

Between 

the 

Transcription Factor and Gene Set Expression 

first 

tested 

In  order 

to  determine  whether  gene 
expression  data  could  be  used 
to  predict 
transcription  factors  that  regulate  common  binding 
motifs,  we 
that 
transcription  factors  and  their  gene  targets  have 
correlated expression profiles. For each gene set, we 
computed the sum of the Euclidean distance of the 
TF from each gene in the gene set as shown: 
 

!"−!"#"

!!!"!#!$=!

the  assumption 

 
Then,  we  repeated  the  above  calculation  using  a 
random  gene  set  selected  from  a  list  of  the  genes 
across  all  gene  sets,  and  calculated  the  fraction  of 
times  that  value  obtained  with  a  random  gene  set 
was 
the  original  Dgeneset  out  of  N 
repetitions. Here N = 100. 
 

than 

less 

!"#"

Level  Name 

Definition 

1 

2 

3 

4 

5 

6 

Superclass 

General topology of the DBD* 

Class 

Family 

Structural blueprint of the DBD 

Sequence and functional 
similarities 

Subfamily 

Sequence-based subgroups 

Genus 

TF gene 

Factor 
‘species’ 

TF polypeptide 

 Table  1.  TFClass  Hierarchy  Definitions.  *DBD  =  DNA 
binding domain [9].  

 

2 

is  a 

standard  RNA-seq 

 

Category 
Number 

Description 

Training 
Examples 

1 
2 

3 

6 
1.1 

1.2 

2.1 

2.3 

3.1 

3.3 

3.5 

Basic Domains 
Zinc-coordinating 
DNA-binding domain 
Helix-turn-helix 
domain 
Immunoglobulin folds 
Basic leucine zipper 
factors (bZIP) 
Basic helix-loop-helix 
factors (bHLH) 
Nuclear receptors with 
C4 zinc fingers 
C2H2 zinc finger 
factors 
Homeo domain 
factors 
Fork head / winged 
helix factors 
Tryptophan cluster 
factors 
STAT domain factors 

81 
113 

105 

33 
44 

37 

42 

71 

41 

31 

17 

19 

6.2 

!!""#$#%&'=!

!

!{!!!"#"$"%
!
!

!!!"#"$"%}

 

Table 2. Superclasses and classes used 

 
II.  Classification of Transcription Factors Using the 
TFClass Hierarchy 

To  make  the  number  of  response  classes  in 
the  data  more  tractable  for  machine  learning,  the 
transcription factors were organized separately into 
superclasses  and  classes  using 
the  TFClass 
framework  orders 
hierarchy 
transcription  factors  based  on 
their  mode  of 
interaction  with  DNA  [9].  The  TFClass  Hierarchy 
(Sept.  2014  version)  was  downloaded  in  the  .obo 
ontology  format  [9].    The  superclass  and  class  of 
each transcription factor from the gene set data was 

(Table  1).  This 

 

obtained by matching its name against the records in 
this  ontology.    When  a  factor  failed  to  match,  its 
synonyms were used to search the hierarchy as well.  
At  both  the  class  and  superclass  level,  categories 
with fewer than 15 training examples were omitted. 
After this filtering, four superclasses (1, 2, 3, and 6) 
remained, as well as eight classes (1.1, 1.2, 2.1, 2.3, 
3.1, 3.3, 3.5, and 6.2) (Table 2). 
 
III.   Multinomial Elastic Net Regression 
A. Features 

implemented 

We  decided 

that  multinomial 

Each  of  the  12,089  features  is  a  gene  that 
appears at least once in any transcription factor gene 
set.  The presence of a given gene in the gene set of 
a  transcription  factor  is  represented  by  a  1  at  that 
index, and its absence is represented by 0. 
 
B. GLMnet Model 
logistic 
 
regression  was 
the  most  appropriate  machine 
learning  method  for  this  problem  because  the  data 
contains more than two classes and has binary rather 
than  continuous  numerical  features.    Because  there 
are  many  fewer  gene  set  examples  than  individual 
genes,  the  dataset  is  prone  to  overfitting.  To  best 
address  this,  we  chose  multinomial  elastic  net 
regression  as 
the  GLMnet  R 
package because it allows for variable selection via 
regularization  with  combined  L1  and  L2  norm 
penalization  [10].    After  the  model  was  trained  on 
all  of  the  data,  10-fold  cross  validation  was 
performed to obtain the test error.Equations for the 
multinomial  model  are  shown  here  as  described  in 
the GLMnet Documentation [10]: 
 
Suppose  the  response  variable  has  K  levels  G  = 
{1,2,…,K}. Here we model:  
 

!!!!!!!!!
Pr!=!!=! =!
!!!!!!!!!
!!!!
elements !!!=!(!!=!!.!! Then 
! !!!,!! !! =!− 1!
!!!!!!!!!!
!!"!!!+!!!!! −!"#

 
Let Y be the N x K indicator response matrix, with 
the  elastic-net 
!
penalized negative log-likelihood function becomes 
!!!

!!. 

!
!!!

!
!!!

in 

 

 

3 

Distribution of Bootstrap P-values 
Measuring SImilarity of Transcription 
Factor and Gene Set Expression!

400!
300!
200!
100!
0!

!

y
c
n
e
u
q
e
r
F

!
5
0
.
0
-
0

!
1
.
0
-
5
0
.
0

!
5
1
.
0
-
1
.
0

!
2
.
0
-
5
1
.
0

!
5
2
.
0
-
2
.
0

!
3
.
0
-
5
2
.
0

!
5
3
.
0
-
3
.
0

!
4
.
0
-
5
3
.
0

!
5
4
.
0
-
4
.
0

!
5
.
0
-
5
4
.
0

!
5
5
.
0
-
5
.
0

!
6
.
0
-
5
5
.
0

!
5
6
.
0
-
6
.
0

!
7
.
0
-
5
6
.
0

!
5
7
.
0
-
7
.
0

!
8
.
0
-
5
7
.
0

!
5
8
.
0
-
8
.
0

!
9
.
0
-
5
8
.
0

!
5
9
.
0
-
9
.
0

!
1
-
5
9
.
0

Bootstrap P-values!

+!!

!
!!!

!! !

. 

+!! 1−! ! !!
2

Figure  1:  Distribution  of  Bootstrap  P-values  Measuring 
Similarity  of  Transcription  Factor  and  Gene  Set 
Expression. Out of 631 gene sets tested, 291 had a significant 
p-value  (threshold  of  0.05).  This 
that  some 
transcription  factors  show  similar  expression  to  that  of  their 
gene sets across tissues, but it is not a valid assumption for the 
entire data set. 

indicates 

 

where ! is  a !!!!!matrix  of  coefficients. !! refers 
to the kth column (for outcome   category k), and !! 

It  has  been  proposed  previously 

the jth row (vector of K coefficients for variable j). 
 
Results 
 
that 
transcription  factors  exhibit  similar  expression  to 
that  of  the  targets  they  regulate  [3].  After  an 
unsuccessful attempt to use elastic net regression to 
predict  transcription  factors  using  gene  expression, 
we  decided  to  test  the  validity  of  this  statement  in 
our  data.  To  do  this,  we  calculated  the  Euclidean 
distance of the transcription factor to every gene in 

Superclass  Training Error  Test Error 

1 
2 
3 
6 

11% 
0.88% 
12% 
15% 

48% 
28% 
43% 
45% 

 

Table 3. GLMNet Error for Superclasses 

 

Class 
1.1 
1.2 
2.1 
2.3 
3.1 
3.3 
3.5 

Training Error  Test Error 
6.8% 
11% 
7.1% 
2.8% 
12% 
19% 
24% 

39% 
78% 
67% 
35% 
39% 
45% 
76% 

Table 4. GLMNet Error for Classes 

using 

factors 

transcription 

the gene set. Then, we computed a bootstrap p-value 
for each gene set to determine whether the distance 
was greater than that of a randomly selected set.  We 
found that only 46% of the gene sets had significant 
bootstrap p-values (Figure 1), which suggested that 
predicting 
gene 
expression could have limitations for our dataset.  
In  light  of  these  findings,  we  took  an 
  
alternative  approach 
transcription 
factors by using gene set composition as features for 
a  multinomial  elastic  net  regression  model.  We 
performed 
the 
transcription  factor  superclass  and  the  transcription 
factor  class  as  the  response  variables  (Figure  2). 
Cross validation was used to determine the optimal 
lambda  value  for  each  regression.  The  regression 
predicting  

regression  analyses  using 

to  predicting 

two 

Figure  2:  Superclass  and  Class  Confusion 
Matrices. 
A)Confusion matrix for superclasses illustrating how 
training  examples  were  classified  during  the  testing 
run of multinomial GLMnet.  Entries on the diagonal 
were classified correctly. 
B)  Confusion  matrix  for  classes  illustrating  how 
training  examples  were  classified  during  the  testing 
run of multinomial GLMnet. 

A 
 
Actual 

 

Predicted Superclasses 

42 
7 
8 
1 

33 
81 
36 
7 

6 
23 
59 
7 

0 
2 
2 
18 

  transcription  factor  superclass  was  60%  accurate 
with an overall training error of 8% and an overall 
test error of 40% whereas the regression predicting 
transcription factor class was 49% accurate with an 
overall training error of 9% and an overall test error 
of 51% (Table 3 and 4). 
 
Discussion and Conclusions 

Identification  of  transcription  factors  that 
bind genes with common binding motifs can provide 
insight  into  the  regulatory  mechanisms  of  these 
genes. Our results show that gene set composition is 
a  better  predictor  of  transcription  factor  classes 
compared  to  expression  data.  Furthermore,  our 
model  is  better  able  to  predict  transcription  factor 
superclass than class, which is unsurprising because 
there  are 
training  examples  per  class 
compared to superclass.  

fewer 

Although gene set composition shows some 
promise  for  transcription  factor  prediction,  there  is 
still a need for improvement of our model. The 32% 
and 42% differences between test and training errors 
for superclass and classes respectively suggests that 
our model is overfitting the data despite the use of 
L1 and L2 norm penalized logistic regression. Other 
alternatives 
feature  selection  may  better 
eliminate overfitting. In the future, we could use L1 
norm  penalization  (lasso  regression)  or  L2  norm 
penalization (ridge regression) instead of elastic net, 
which  has  both  L1  and  L2  norm  penalization. 
Feature  selection  via  forward  search,  backwards 
search,  or  filter  feature  selection  with  mutual 

for 

B 

 

1.1 
1.2 
2.1 
2.3 
3.1 
3.3 
3.5 
6.2 

1.1 
27 
5 
1 
2 
0 
1 
0 
0 

1.2 
4 
8 
2 
7 
1 
0 
3 
0 

Actual 

4 

Predicted Classes 
2.1 
4 
5 
14 
5 
0 
3 
0 
2 

3.1 
0 
1 
2 
5 
25 
2 
0 
1 

2.3 
8 
17 
22 
46 
11 
8 
9 
8 

3.3 
1 
0 
0 
4 
3 
17 
1 
1 

3.5 
0 
1 
0 
1 
0 
0 
4 
0 

6.2 
0 
0 
1 
1 
1 
0 
0 
7 

 

Prediction of Transcription Factors that Regulate Common Binding Motifs 

Dana Wyman and Emily Alsentzer 

CS 229, Fall 2014 

Introduction 
A.  Background 
Proper  regulation  of  mRNA  levels  is  essential  to 
nearly  all  cellular  processes.  Transcription  factors 
are  responsible  for  regulating  levels  of  mRNA.  By 
binding  to  a  specific  DNA  sequence  via  a  DNA-
binding domain, transcription factors can promote or 
block  the  recruitment  of  RNA  polymerase,  an 
enzyme  responsible  for  transcription,  effectively 
controlling  when  and  how  much  of  a  gene  is 
expressed  [1].    Predicting  the  binding  sites  of 
transcription factors is an important area of research, 
as  identifying  these  regulatory  sites  can  shed  light 
on  the  mechanisms  that  regulate  specific  genes.  A 
variety of algorithms have been developed in order 
to predict transcription factor binding sites (TFBSs) 
a priori [2]. These techniques have the potential to 
identify  novel  transcription  factor  binding  motifs. 
However,  in  some  cases,  the  transcription  factor 
responsible  for  binding  a  given  motif  is  unknown. 
Here,  we  address 
issue  using  gene  set 
composition  to  predict  which  transcription  factors 
bind common binding motifs.  This approach differs 
from  other  work  in  the  field,  as  previous  efforts 
have mainly focused on predicting targets of known 
transcription factors. 
 
B.  Data 
 I. Gene Sets 

this 

A  common  way  of  determining  which 
transcription factor regulates a given gene is to look 
for  characteristic  DNA  binding  motifs  within  the 
promoter  of 
the  gene  [3].  In  general,  each 
transcription factor has a motif around 10 base pairs 
in  length  to  which  it  preferentially  binds  [1].  
Therefore,  it  is  possible  to  sequence  genes  and 
group  them  based  on  which  transcription  factor 
site(s) their promoters contain.  One of our datasets 
is  a  list  of  transcription  factor-gene  sets  compiled 
from 
the  ChIP  Enrichment  Analysis  system 
(CHEA), the Broad Institute MsigDB database, and 
the  Encyclopedia  of  DNA  Elements  (ENCODE) 

 

1 

Project  [4].    It  includes  757  transcription  factors, 
along with the set of genes that each is expected to 
bind to and regulate, and some transcription factors 
appear with multiple gene sets. 
 
II. Expression Data 

RNA-seq  is  a  recent  technique  used  to 
quantify  gene  expression  by  directly  sequencing 
RNA molecules from a cell sample. The sequenced 
RNA  is  converted  to  a  library  of  cDNA  fragments 
and mapped to specific genes in the genome, and the 
number of reads for a gene can be used to quantify 
gene expression [5]. Fragments per kilobase of exon 
per  million  reads  mapped  (FPKM)  measurements 
are often used to quantify gene expression because 
they  allow  for  normalization  of  reads  by  gene 
length.  FPKM is defined as the following: 
 

where !!=  number  of  reads  that  align  to  a  gene,    
!!!= effective length of a gene, and N = number of 

!"#$!=!!!!!!∗10! 

 

 

reads sequenced [5]. 
Our dataset contains RNA-seq FPKM measurements 
from 95 human individuals across 27 different tissue 
types [6]. Each tissue sample contains F 
PKM measurements for 20,050 genes. The data was 
retrieved 
from  ArrayExpress  under  accession 
number E-MTAB-1733 [7]. 
 
Methods 
I.  Data Preprocessing 
A. Expression Data 

In  the  original  table,  genes  were  labeled 
using  the  Ensembl  gene  ID  convention.  These 
identifiers  are  not  directly  compatible  with  other 
bioinformatics  resources,  so  Biomart  was  used  to 
generate  a  mapping  of  Ensembl  IDs  to  official 
HGNC  gene  symbols  [8].      When  a  gene  symbol 
appeared  more 
table,  gene 
expression was summed across the rows to produce 
a  single  entry.  Finally,  FPKM  values  were  log2-

than  once 

the 

in 

 

transformed,  which 
processing step.   
 
B. Gene Set Filtering 
 

All  gene  sets  for  species  other  than  Homo 
sapiens  were  removed.    After  filtering,  the  data 
contained 757 gene sets.  
 
II.  Assessing 

Relationship 

Between 

the 

Transcription Factor and Gene Set Expression 

first 

tested 

In  order 

to  determine  whether  gene 
expression  data  could  be  used 
to  predict 
transcription  factors  that  regulate  common  binding 
motifs,  we 
that 
transcription  factors  and  their  gene  targets  have 
correlated expression profiles. For each gene set, we 
computed the sum of the Euclidean distance of the 
TF from each gene in the gene set as shown: 
 

!"−!"#"

!!!"!#!$=!

the  assumption 

 
Then,  we  repeated  the  above  calculation  using  a 
random  gene  set  selected  from  a  list  of  the  genes 
across  all  gene  sets,  and  calculated  the  fraction  of 
times  that  value  obtained  with  a  random  gene  set 
was 
the  original  Dgeneset  out  of  N 
repetitions. Here N = 100. 
 

than 

less 

!"#"

Level  Name 

Definition 

1 

2 

3 

4 

5 

6 

Superclass 

General topology of the DBD* 

Class 

Family 

Structural blueprint of the DBD 

Sequence and functional 
similarities 

Subfamily 

Sequence-based subgroups 

Genus 

TF gene 

Factor 
‘species’ 

TF polypeptide 

 Table  1.  TFClass  Hierarchy  Definitions.  *DBD  =  DNA 
binding domain [9].  

 

2 

is  a 

standard  RNA-seq 

 

Category 
Number 

Description 

Training 
Examples 

1 
2 

3 

6 
1.1 

1.2 

2.1 

2.3 

3.1 

3.3 

3.5 

Basic Domains 
Zinc-coordinating 
DNA-binding domain 
Helix-turn-helix 
domain 
Immunoglobulin folds 
Basic leucine zipper 
factors (bZIP) 
Basic helix-loop-helix 
factors (bHLH) 
Nuclear receptors with 
C4 zinc fingers 
C2H2 zinc finger 
factors 
Homeo domain 
factors 
Fork head / winged 
helix factors 
Tryptophan cluster 
factors 
STAT domain factors 

81 
113 

105 

33 
44 

37 

42 

71 

41 

31 

17 

19 

6.2 

!!""#$#%&'=!

!

!{!!!"#"$"%
!
!

!!!"#"$"%}

 

Table 2. Superclasses and classes used 

 
II.  Classification of Transcription Factors Using the 
TFClass Hierarchy 

To  make  the  number  of  response  classes  in 
the  data  more  tractable  for  machine  learning,  the 
transcription factors were organized separately into 
superclasses  and  classes  using 
the  TFClass 
framework  orders 
hierarchy 
transcription  factors  based  on 
their  mode  of 
interaction  with  DNA  [9].  The  TFClass  Hierarchy 
(Sept.  2014  version)  was  downloaded  in  the  .obo 
ontology  format  [9].    The  superclass  and  class  of 
each transcription factor from the gene set data was 

(Table  1).  This 

 

obtained by matching its name against the records in 
this  ontology.    When  a  factor  failed  to  match,  its 
synonyms were used to search the hierarchy as well.  
At  both  the  class  and  superclass  level,  categories 
with fewer than 15 training examples were omitted. 
After this filtering, four superclasses (1, 2, 3, and 6) 
remained, as well as eight classes (1.1, 1.2, 2.1, 2.3, 
3.1, 3.3, 3.5, and 6.2) (Table 2). 
 
III.   Multinomial Elastic Net Regression 
A. Features 

implemented 

We  decided 

that  multinomial 

Each  of  the  12,089  features  is  a  gene  that 
appears at least once in any transcription factor gene 
set.  The presence of a given gene in the gene set of 
a  transcription  factor  is  represented  by  a  1  at  that 
index, and its absence is represented by 0. 
 
B. GLMnet Model 
logistic 
 
regression  was 
the  most  appropriate  machine 
learning  method  for  this  problem  because  the  data 
contains more than two classes and has binary rather 
than  continuous  numerical  features.    Because  there 
are  many  fewer  gene  set  examples  than  individual 
genes,  the  dataset  is  prone  to  overfitting.  To  best 
address  this,  we  chose  multinomial  elastic  net 
regression  as 
the  GLMnet  R 
package because it allows for variable selection via 
regularization  with  combined  L1  and  L2  norm 
penalization  [10].    After  the  model  was  trained  on 
all  of  the  data,  10-fold  cross  validation  was 
performed to obtain the test error.Equations for the 
multinomial  model  are  shown  here  as  described  in 
the GLMnet Documentation [10]: 
 
Suppose  the  response  variable  has  K  levels  G  = 
{1,2,…,K}. Here we model:  
 

!!!!!!!!!
Pr!=!!=! =!
!!!!!!!!!
!!!!
elements !!!=!(!!=!!.!! Then 
! !!!,!! !! =!− 1!
!!!!!!!!!!
!!"!!!+!!!!! −!"#

 
Let Y be the N x K indicator response matrix, with 
the  elastic-net 
!
penalized negative log-likelihood function becomes 
!!!

!!. 

!
!!!

!
!!!

in 

 

 

3 

Distribution of Bootstrap P-values 
Measuring SImilarity of Transcription 
Factor and Gene Set Expression!

400!
300!
200!
100!
0!

!

y
c
n
e
u
q
e
r
F

!
5
0
.
0
-
0

!
1
.
0
-
5
0
.
0

!
5
1
.
0
-
1
.
0

!
2
.
0
-
5
1
.
0

!
5
2
.
0
-
2
.
0

!
3
.
0
-
5
2
.
0

!
5
3
.
0
-
3
.
0

!
4
.
0
-
5
3
.
0

!
5
4
.
0
-
4
.
0

!
5
.
0
-
5
4
.
0

!
5
5
.
0
-
5
.
0

!
6
.
0
-
5
5
.
0

!
5
6
.
0
-
6
.
0

!
7
.
0
-
5
6
.
0

!
5
7
.
0
-
7
.
0

!
8
.
0
-
5
7
.
0

!
5
8
.
0
-
8
.
0

!
9
.
0
-
5
8
.
0

!
5
9
.
0
-
9
.
0

!
1
-
5
9
.
0

Bootstrap P-values!

+!!

!
!!!

!! !

. 

+!! 1−! ! !!
2

Figure  1:  Distribution  of  Bootstrap  P-values  Measuring 
Similarity  of  Transcription  Factor  and  Gene  Set 
Expression. Out of 631 gene sets tested, 291 had a significant 
p-value  (threshold  of  0.05).  This 
that  some 
transcription  factors  show  similar  expression  to  that  of  their 
gene sets across tissues, but it is not a valid assumption for the 
entire data set. 

indicates 

 

where ! is  a !!!!!matrix  of  coefficients. !! refers 
to the kth column (for outcome   category k), and !! 

It  has  been  proposed  previously 

the jth row (vector of K coefficients for variable j). 
 
Results 
 
that 
transcription  factors  exhibit  similar  expression  to 
that  of  the  targets  they  regulate  [3].  After  an 
unsuccessful attempt to use elastic net regression to 
predict  transcription  factors  using  gene  expression, 
we  decided  to  test  the  validity  of  this  statement  in 
our  data.  To  do  this,  we  calculated  the  Euclidean 
distance of the transcription factor to every gene in 

Superclass  Training Error  Test Error 

1 
2 
3 
6 

11% 
0.88% 
12% 
15% 

48% 
28% 
43% 
45% 

 

Table 3. GLMNet Error for Superclasses 

 

Class 
1.1 
1.2 
2.1 
2.3 
3.1 
3.3 
3.5 

Training Error  Test Error 
6.8% 
11% 
7.1% 
2.8% 
12% 
19% 
24% 

39% 
78% 
67% 
35% 
39% 
45% 
76% 

Table 4. GLMNet Error for Classes 

using 

factors 

transcription 

the gene set. Then, we computed a bootstrap p-value 
for each gene set to determine whether the distance 
was greater than that of a randomly selected set.  We 
found that only 46% of the gene sets had significant 
bootstrap p-values (Figure 1), which suggested that 
predicting 
gene 
expression could have limitations for our dataset.  
In  light  of  these  findings,  we  took  an 
  
alternative  approach 
transcription 
factors by using gene set composition as features for 
a  multinomial  elastic  net  regression  model.  We 
performed 
the 
transcription  factor  superclass  and  the  transcription 
factor  class  as  the  response  variables  (Figure  2). 
Cross validation was used to determine the optimal 
lambda  value  for  each  regression.  The  regression 
predicting  

regression  analyses  using 

to  predicting 

two 

Figure  2:  Superclass  and  Class  Confusion 
Matrices. 
A)Confusion matrix for superclasses illustrating how 
training  examples  were  classified  during  the  testing 
run of multinomial GLMnet.  Entries on the diagonal 
were classified correctly. 
B)  Confusion  matrix  for  classes  illustrating  how 
training  examples  were  classified  during  the  testing 
run of multinomial GLMnet. 

A 
 
Actual 

 

Predicted Superclasses 

42 
7 
8 
1 

33 
81 
36 
7 

6 
23 
59 
7 

0 
2 
2 
18 

  transcription  factor  superclass  was  60%  accurate 
with an overall training error of 8% and an overall 
test error of 40% whereas the regression predicting 
transcription factor class was 49% accurate with an 
overall training error of 9% and an overall test error 
of 51% (Table 3 and 4). 
 
Discussion and Conclusions 

Identification  of  transcription  factors  that 
bind genes with common binding motifs can provide 
insight  into  the  regulatory  mechanisms  of  these 
genes. Our results show that gene set composition is 
a  better  predictor  of  transcription  factor  classes 
compared  to  expression  data.  Furthermore,  our 
model  is  better  able  to  predict  transcription  factor 
superclass than class, which is unsurprising because 
there  are 
training  examples  per  class 
compared to superclass.  

fewer 

Although gene set composition shows some 
promise  for  transcription  factor  prediction,  there  is 
still a need for improvement of our model. The 32% 
and 42% differences between test and training errors 
for superclass and classes respectively suggests that 
our model is overfitting the data despite the use of 
L1 and L2 norm penalized logistic regression. Other 
alternatives 
feature  selection  may  better 
eliminate overfitting. In the future, we could use L1 
norm  penalization  (lasso  regression)  or  L2  norm 
penalization (ridge regression) instead of elastic net, 
which  has  both  L1  and  L2  norm  penalization. 
Feature  selection  via  forward  search,  backwards 
search,  or  filter  feature  selection  with  mutual 

for 

B 

 

1.1 
1.2 
2.1 
2.3 
3.1 
3.3 
3.5 
6.2 

1.1 
27 
5 
1 
2 
0 
1 
0 
0 

1.2 
4 
8 
2 
7 
1 
0 
3 
0 

Actual 

4 

Predicted Classes 
2.1 
4 
5 
14 
5 
0 
3 
0 
2 

3.1 
0 
1 
2 
5 
25 
2 
0 
1 

2.3 
8 
17 
22 
46 
11 
8 
9 
8 

3.3 
1 
0 
0 
4 
3 
17 
1 
1 

3.5 
0 
1 
0 
1 
0 
0 
4 
0 

6.2 
0 
0 
1 
1 
1 
0 
0 
7 

2.  Mathelier,  Anthony,  and  Wyeth  W.  Wasserman. 
"The  Next  Generation  of  Transcription  Factor 
Binding  Site  Prediction."  Ed.  Ilya  Ioshikhes.  PLoS 
Computational Biology 9.9 (2013) 

3.  Ernst, Jason, Heather L. Plasterer, Itamar Simon, and 
Ziv  Bar-Joseph.  "Integrating  Multiple  Evidence 
Sources  to  Predict  Transcription  Factor  Binding  in 
the Human Genome." Genome Res. 20 (2010): 526-
36. 

4.  Gentles,  A.  J.,  Alizadeh,  A.  A.,  Lee,  S.-I., 
Myklebust, J. H., Shachaf, C. M., Shahbaba, B., … 
Plevritis,  S.  K.  A  pluripotency  signature  predicts 
histologic  transformation  and  influences  survival  in 
follicular 
lymphoma  patients.  Blood,  114(15), 
(2009) 3158–66. 

5.  Mortazavi, Ali, Brian A. Williams, Kenneth Mccue, 
Lorian Schaeffer, and Barbara Wold. "Mapping and 
Quantifying  Mammalian  Transcriptomes  by  RNA-
Seq." Nature Methods 5.7 (2008): 621-28.  

6.  Fagerberg,  L.  et  al.  Analysis  of  the  human  tissue-
specific  expression  by  genome-wide  integration  of 
transcriptomics  and  antibody-based  proteomics. 
Mol. Cell. Proteomics 13 (2014): 397–406. 

7.  Rustici.G et al. 2013 ArrayExpress update - trends in 
database  growth  and  links  to  data  analysis  tools. 
Nucleic Acids Res, doi: 10.1093/nar/gks1174. 

8.  Kasprzyk, A. "BioMart: Driving a Paradigm Change 
in  Biological  Data  Management."  Database  2011.0 
(2011). 

9.  Wingender, E., Schoeps, T. and Dönitz, J.: TFClass: 
An  expandable  hierarchical  classification  of  human 
transcription  factors.  Nucleic  Acids  Res.  41,  D165-
D170 (2013). 

10.  Jerome  Friedman,  Trevor  Hastie,  Robert  Tibshirani 
(2010). Regularization Paths for Generalized Linear 
Models  via  Coordinate  Descent. 
Journal  of 
Statistical Software, 33(1), 1-22.  

11.  The  Gene  Ontology  Consortium.  Gene  ontology: 
tool for the unification of biology. Nat Genet. May 
2000;25(1):25-9. 

 

information scoring may also yield better test errors.  
 
In addition to correcting for overfitting in the 
model, there is also a need for further granularity of 
response  variables.  Although  it  is  interesting  to 
predict  transcription  factor  class  for  a  set  of  genes 
with  a  common  binding  motif,  in  order  for  these 
results  to  be  biologically  useful,  prediction  at  the 
family,  subfamily,  or  even  genus  level  is  needed. 
Additional  data  describing  the  transcription  factors 
that regulate genes with common binding motifs is 
necessary in order to predict transcription factors at 
a  finer  granularity,  and  it  is  also  needed  to  ensure 
that  there  are  training  examples  of  transcription 
factors  in  each  superclass  and  class  so  that  all  x 
superclasses and all x classes can be predicted. With 
additional  data  and  improved  measures  to  reduce 
overfitting, our approach could be a useful tool for 
identifying unknown transcription factors with a set 
of known gene targets. 
 
Future 
Previous  research  has  indicated  that  transcription 
factors  may  regulate  genes 
that  have  similar 
functional roles [3]. Therefore, another approach to 
predicting  transcription  factors  using  gene  sets 
would  be  to  use  gene  ontology  (GO)  terms  as 
features in a multinomial logistic regression model. 
GO  terms  classify  genes  by  cellular  component, 
molecular function, and biological process, and are 
organized in a hierarchy with increasing specificity 
[11].   This  hierarchical  structure  is  useful  in  this 
context  because  it  would  allow  for  different  levels 
of detail to be tested in the features. In the future, an 
approach  along  these  lines  could  further  improve 
our  ability  to  predict  which  transcription  factor 
binds to a given gene set. 
 
Acknowledgements 
We would like to thank Andrew Gentles for helping 
us  develop  our  project  idea  and  for  providing 
guidance and technical support along the way. 
 
References 
1.  Weingarten‐Gabbay,  Shira,  and  Eran  Segal.  "The 
Grammar  of  Transcriptional  Regulation."  Hum 
Genet 133 (2014): 701-11. 

 

5 

 
 
 
 
 
 
 
 
 
 


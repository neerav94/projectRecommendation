Automatic detection of plasmonic nanoparticles in tissue sections 

Dor Shaviv and Orly Liba 

1.  Introduction 

Plasmonic nanoparticles, such as gold nanorods, are gaining popularity in both medical imaging and therapeutics.  For example, they 
can be used for treating cancer. The rods are first coated with antibodies that bind to tumor specific antigens. They are then injected to 
a patient and accumulate in the tumor. Next, the patient is illuminated by infra-red light. The light is absorbed by the nanoparticles, 
causing local heating that destroys the tumor cells which the rods are bound to. The healthy cells which are not near the nanoparticles 
remain intact. It is important to quantify the binding of the nanoparticles to their target and prove that the binding is indeed specific to 
the tumor cells. Very recently, it has become feasible to image both the nanoparticles and tissue section. By using a dark-field 
microscope with an infra-red hyperspectral camera we are able to see the pathology of the tissue and the nanoparticles. However, it is 
not simple to locate and differentiate the nanoparticles from other structures in the tissue sections. 
In this project we propose an algorithm for automatic detection of nanoparticles in tissue sections by using their scattering spectrum in 
a dark field hyperspectral microscope. 
Owing to their plasmonic resonance, the gold nanorods have a peak scattering wavelength at around 900 nm. This unique scattering 
spectrum, along with the high scattering intensity of the nanorods, enables us to detect them in tissue sections by using a dark-field 
hyperspectral microscope. Although the nanorods have a very unique scattering spectrum, it is well known that their spectrum is 
sensitive to their environment and orientation. Therefore, one of the challenges in this project is the variability in the spectrum of the 
particles we wish to detect. 
Although the nanorods can be spotted in the images by eye, it can be very difficult to be sure that we are able to detect all of them in 
the tissue samples. This is because the images of the hyperspectral microscope are ultimately represented by only three channels: R, G 
and B, and do not show the full spectrum of each pixel. The large benefit of using an automatic detection scheme rather than just 
looking at the images is that it can classify the nanoparticles from the tissue by using the full spectrum. Another benefit of the 
automated algorithm is that it can detect and then count the number of nanoparticles in the image. The number of nanoparticles is 
valuable for understanding the efficiency and specificity of their binding.  
This report describes our progress in detecting the nanorods using methods learned in CS229. We have examined three methods of 
classification: logistic regression, SVM and k-means. We also looked at reducing the dimensionality of our data with PCA. The details 
and results are described below. 

2.  Experimental setup 

The gold nanorods that we are using were made in-house by the members of the de la Zerda lab. Their dimensions are 50x150 nm and 
have a peak scattering wavelength at around 900 nm. In order to stabilize them and make them bio-compatible they were coated with 
PSS-mPEG. Functionalization, i.e., adding a binding agent to the nanorods, was done by introducing antibodies which are meant to be 
tumor specific, for example anti-avb3. 
In order to create tumor models, we injected the ears of nude mice with cancer cells. Seven days after the cells were injected, we 
injected the nanorods to the tail veins of the mice. After several hours we sacrificed the mice and preserved the ears, which include the 
tumors and healthy regions. The preserved ears were sliced to 5 um thick slices and stained with H&E staining.  
We imaged the slides using the CytoViva HSI System with Enhanced Sensitivity dark-field hyperspectral microscope [1], which is 
located at SNF. The hyperspectral camera records the spectrum of each pixel at 361 sample points, at the wavelength range of 400 to 
1000 nm. The spectrums are lamp normalized, meaning that they are independent of the spectrum of the light source. Each image has 
509x512 pixels (~200 um). We used an objective with 40x magnification, which provides a pixel size of around 400 nm. We collected 
34 images of sections of mice in which nanorods were injected, 6 images of sections of mice without any injection and 1 image of 
gold nanorods on a glass slide. 

a 

b 

c 
c 

d 

  

    

  

   

 

Figure 1 a) TEM image of gold nanorods, b) scattering spectrum of the nanorods, measured with the hyperspectral microscope,  c) H&E stained tissue slice of 
a mouse ear (10x magnification). d) Diagram of a dark-field microscope.  

500600700800900100000.20.40.60.81 [nm]Automatic detection of plasmonic nanoparticles in tissue sections 

Dor Shaviv and Orly Liba 

1.  Introduction 

Plasmonic nanoparticles, such as gold nanorods, are gaining popularity in both medical imaging and therapeutics.  For example, they 
can be used for treating cancer. The rods are first coated with antibodies that bind to tumor specific antigens. They are then injected to 
a patient and accumulate in the tumor. Next, the patient is illuminated by infra-red light. The light is absorbed by the nanoparticles, 
causing local heating that destroys the tumor cells which the rods are bound to. The healthy cells which are not near the nanoparticles 
remain intact. It is important to quantify the binding of the nanoparticles to their target and prove that the binding is indeed specific to 
the tumor cells. Very recently, it has become feasible to image both the nanoparticles and tissue section. By using a dark-field 
microscope with an infra-red hyperspectral camera we are able to see the pathology of the tissue and the nanoparticles. However, it is 
not simple to locate and differentiate the nanoparticles from other structures in the tissue sections. 
In this project we propose an algorithm for automatic detection of nanoparticles in tissue sections by using their scattering spectrum in 
a dark field hyperspectral microscope. 
Owing to their plasmonic resonance, the gold nanorods have a peak scattering wavelength at around 900 nm. This unique scattering 
spectrum, along with the high scattering intensity of the nanorods, enables us to detect them in tissue sections by using a dark-field 
hyperspectral microscope. Although the nanorods have a very unique scattering spectrum, it is well known that their spectrum is 
sensitive to their environment and orientation. Therefore, one of the challenges in this project is the variability in the spectrum of the 
particles we wish to detect. 
Although the nanorods can be spotted in the images by eye, it can be very difficult to be sure that we are able to detect all of them in 
the tissue samples. This is because the images of the hyperspectral microscope are ultimately represented by only three channels: R, G 
and B, and do not show the full spectrum of each pixel. The large benefit of using an automatic detection scheme rather than just 
looking at the images is that it can classify the nanoparticles from the tissue by using the full spectrum. Another benefit of the 
automated algorithm is that it can detect and then count the number of nanoparticles in the image. The number of nanoparticles is 
valuable for understanding the efficiency and specificity of their binding.  
This report describes our progress in detecting the nanorods using methods learned in CS229. We have examined three methods of 
classification: logistic regression, SVM and k-means. We also looked at reducing the dimensionality of our data with PCA. The details 
and results are described below. 

2.  Experimental setup 

The gold nanorods that we are using were made in-house by the members of the de la Zerda lab. Their dimensions are 50x150 nm and 
have a peak scattering wavelength at around 900 nm. In order to stabilize them and make them bio-compatible they were coated with 
PSS-mPEG. Functionalization, i.e., adding a binding agent to the nanorods, was done by introducing antibodies which are meant to be 
tumor specific, for example anti-avb3. 
In order to create tumor models, we injected the ears of nude mice with cancer cells. Seven days after the cells were injected, we 
injected the nanorods to the tail veins of the mice. After several hours we sacrificed the mice and preserved the ears, which include the 
tumors and healthy regions. The preserved ears were sliced to 5 um thick slices and stained with H&E staining.  
We imaged the slides using the CytoViva HSI System with Enhanced Sensitivity dark-field hyperspectral microscope [1], which is 
located at SNF. The hyperspectral camera records the spectrum of each pixel at 361 sample points, at the wavelength range of 400 to 
1000 nm. The spectrums are lamp normalized, meaning that they are independent of the spectrum of the light source. Each image has 
509x512 pixels (~200 um). We used an objective with 40x magnification, which provides a pixel size of around 400 nm. We collected 
34 images of sections of mice in which nanorods were injected, 6 images of sections of mice without any injection and 1 image of 
gold nanorods on a glass slide. 

a 

b 

c 
c 

d 

  

    

  

   

 

Figure 1 a) TEM image of gold nanorods, b) scattering spectrum of the nanorods, measured with the hyperspectral microscope,  c) H&E stained tissue slice of 
a mouse ear (10x magnification). d) Diagram of a dark-field microscope.  

500600700800900100000.20.40.60.81 [nm]3.  Data preparation 

The raw data we use for the machine learning problem are the spectrums recorded for each pixel in the image. We have noticed that 
applying pre-processing to the raw data improves the results significantly. These are the steps we are currently performing before 
applying each of the machine learning models: 

1.  Spectrum truncation: The first 100 samples of the spectrum (400 – 566 nm) are removed because they contain mainly noise 

and do not contribute to the detection of the nanorods. Therefore, we remain with 261 feature points. 

2.  Background removal: the average signal across the spectrum was measured for each pixel. The pixels with very low values 

were disregarded because they are background and contain only noise. 

3.  Spectral smoothing: Noise in the spectrum is amplified at the edges due to the lamp normalization. We applied the Savitzky-

Golay filter, with length 33 and degree 2 to reduce the noise in the spectrum.  

4.  Normalization: The spectrum of each pixel was normalized by its maximum value. This was done to make the algorithm 

invariant to illumination.  

4.  Machine learning methods and their application 

Support vector machine (SVM): Training and prediction were done with Liblinear v1.94 [2] . We used L2-regularized L2-loss 
support vector classification (primal) with the default regularization parameter, C=1, and with a bias term (b ≠0).  

𝑚

𝑚𝑖𝑛
𝑤

   𝑤 

1
2

𝑤𝑇𝑤 + 𝐶 ∑(max (0,1 − 𝑦𝑖(𝑤𝑇𝑥𝑖 + 𝑏)))2

 

𝑖=1

When solving the dual problem, the optimization did not converge in the maximal number of iterations. We chose a linear kernel 
owing to the high number of samples and features of our data. The model was trained using two images (Fig 2 a, b). In an image of 
nanorods on glass (without tissue), each pixel above the background noise level was labeled as {1}. In an image of a tissue slide 
without nanorods, each pixel above the background noise level was labeled as {-1}. The model was tested with cross validation on the 
two training images (Fig 2 a, b) with k=10. The model was also tested qualitatively on images of tissue with nanorods. 
Logistic regression: We implemented logistic regression with stochastic gradient ascent on Matlab. The convergence criterion was 
0.05% training error, the learning parameter, α, was annealed in each iteration. We used a similar training and testing scheme as SVM. 
Batch gradient descent was also implemented but it did not converge well. 
K-means: Since we know that the nanorod spectrum is sensitive to its environment, it is preferable to train our model on more 
representing samples, i.e., tissue samples with nanorods, rather than nanorods on glass. Because we can never be sure if what we are 
seeing is a nanorod or part of the tissue, it should be beneficial to use a non-supervised learning method, such as k-means, to cluster 
the different objects in the images, and hopefully obtain a separate cluster for the nanorods which will allow us to classify them. We 
used Matlab’s k-means function, with 2, 3, 4, 5 and 6 clusters, and trained it on 4 images of nanorods in tissue. We tested our model 
against the two images containing nanorods on glass and tissue without nanorods (Fig 2 a, b), and also qualitatively. The nanorods 
cluster (positives) was determined by picking the most prevalent cluster in the image with nanorods on glass, whereas all other 
clusters were labeled negative. 
Principal component analysis (PCA): We implemented PCA on Matlab to reduce the dimensionality of the data. PCA was done on 
4 images of tissue sections with nanorods. We managed to reduce the dimension of our features from 261 to just 3 and conserve 
99.6% of the energy which is quite amazing.  
PCA + K-means (spectral clustering): Following PCA, we clustered our data in a similar manner to the previously described k-
means. We present the results for 5 clusters. The model was tested against Fig. 2 a, b. 

a 

b 

c 

  

    

   

 

Figure 2 Images used for training and testing our models. a) tissue section with no nanorods, b) nanorods on top of a glass slide, c) a tissue section in which 
nanorods are present and shown with a red-orange color.  
 

Automatic detection of plasmonic nanoparticles in tissue sections 

Dor Shaviv and Orly Liba 

1.  Introduction 

Plasmonic nanoparticles, such as gold nanorods, are gaining popularity in both medical imaging and therapeutics.  For example, they 
can be used for treating cancer. The rods are first coated with antibodies that bind to tumor specific antigens. They are then injected to 
a patient and accumulate in the tumor. Next, the patient is illuminated by infra-red light. The light is absorbed by the nanoparticles, 
causing local heating that destroys the tumor cells which the rods are bound to. The healthy cells which are not near the nanoparticles 
remain intact. It is important to quantify the binding of the nanoparticles to their target and prove that the binding is indeed specific to 
the tumor cells. Very recently, it has become feasible to image both the nanoparticles and tissue section. By using a dark-field 
microscope with an infra-red hyperspectral camera we are able to see the pathology of the tissue and the nanoparticles. However, it is 
not simple to locate and differentiate the nanoparticles from other structures in the tissue sections. 
In this project we propose an algorithm for automatic detection of nanoparticles in tissue sections by using their scattering spectrum in 
a dark field hyperspectral microscope. 
Owing to their plasmonic resonance, the gold nanorods have a peak scattering wavelength at around 900 nm. This unique scattering 
spectrum, along with the high scattering intensity of the nanorods, enables us to detect them in tissue sections by using a dark-field 
hyperspectral microscope. Although the nanorods have a very unique scattering spectrum, it is well known that their spectrum is 
sensitive to their environment and orientation. Therefore, one of the challenges in this project is the variability in the spectrum of the 
particles we wish to detect. 
Although the nanorods can be spotted in the images by eye, it can be very difficult to be sure that we are able to detect all of them in 
the tissue samples. This is because the images of the hyperspectral microscope are ultimately represented by only three channels: R, G 
and B, and do not show the full spectrum of each pixel. The large benefit of using an automatic detection scheme rather than just 
looking at the images is that it can classify the nanoparticles from the tissue by using the full spectrum. Another benefit of the 
automated algorithm is that it can detect and then count the number of nanoparticles in the image. The number of nanoparticles is 
valuable for understanding the efficiency and specificity of their binding.  
This report describes our progress in detecting the nanorods using methods learned in CS229. We have examined three methods of 
classification: logistic regression, SVM and k-means. We also looked at reducing the dimensionality of our data with PCA. The details 
and results are described below. 

2.  Experimental setup 

The gold nanorods that we are using were made in-house by the members of the de la Zerda lab. Their dimensions are 50x150 nm and 
have a peak scattering wavelength at around 900 nm. In order to stabilize them and make them bio-compatible they were coated with 
PSS-mPEG. Functionalization, i.e., adding a binding agent to the nanorods, was done by introducing antibodies which are meant to be 
tumor specific, for example anti-avb3. 
In order to create tumor models, we injected the ears of nude mice with cancer cells. Seven days after the cells were injected, we 
injected the nanorods to the tail veins of the mice. After several hours we sacrificed the mice and preserved the ears, which include the 
tumors and healthy regions. The preserved ears were sliced to 5 um thick slices and stained with H&E staining.  
We imaged the slides using the CytoViva HSI System with Enhanced Sensitivity dark-field hyperspectral microscope [1], which is 
located at SNF. The hyperspectral camera records the spectrum of each pixel at 361 sample points, at the wavelength range of 400 to 
1000 nm. The spectrums are lamp normalized, meaning that they are independent of the spectrum of the light source. Each image has 
509x512 pixels (~200 um). We used an objective with 40x magnification, which provides a pixel size of around 400 nm. We collected 
34 images of sections of mice in which nanorods were injected, 6 images of sections of mice without any injection and 1 image of 
gold nanorods on a glass slide. 

a 

b 

c 
c 

d 

  

    

  

   

 

Figure 1 a) TEM image of gold nanorods, b) scattering spectrum of the nanorods, measured with the hyperspectral microscope,  c) H&E stained tissue slice of 
a mouse ear (10x magnification). d) Diagram of a dark-field microscope.  

500600700800900100000.20.40.60.81 [nm]3.  Data preparation 

The raw data we use for the machine learning problem are the spectrums recorded for each pixel in the image. We have noticed that 
applying pre-processing to the raw data improves the results significantly. These are the steps we are currently performing before 
applying each of the machine learning models: 

1.  Spectrum truncation: The first 100 samples of the spectrum (400 – 566 nm) are removed because they contain mainly noise 

and do not contribute to the detection of the nanorods. Therefore, we remain with 261 feature points. 

2.  Background removal: the average signal across the spectrum was measured for each pixel. The pixels with very low values 

were disregarded because they are background and contain only noise. 

3.  Spectral smoothing: Noise in the spectrum is amplified at the edges due to the lamp normalization. We applied the Savitzky-

Golay filter, with length 33 and degree 2 to reduce the noise in the spectrum.  

4.  Normalization: The spectrum of each pixel was normalized by its maximum value. This was done to make the algorithm 

invariant to illumination.  

4.  Machine learning methods and their application 

Support vector machine (SVM): Training and prediction were done with Liblinear v1.94 [2] . We used L2-regularized L2-loss 
support vector classification (primal) with the default regularization parameter, C=1, and with a bias term (b ≠0).  

𝑚

𝑚𝑖𝑛
𝑤

   𝑤 

1
2

𝑤𝑇𝑤 + 𝐶 ∑(max (0,1 − 𝑦𝑖(𝑤𝑇𝑥𝑖 + 𝑏)))2

 

𝑖=1

When solving the dual problem, the optimization did not converge in the maximal number of iterations. We chose a linear kernel 
owing to the high number of samples and features of our data. The model was trained using two images (Fig 2 a, b). In an image of 
nanorods on glass (without tissue), each pixel above the background noise level was labeled as {1}. In an image of a tissue slide 
without nanorods, each pixel above the background noise level was labeled as {-1}. The model was tested with cross validation on the 
two training images (Fig 2 a, b) with k=10. The model was also tested qualitatively on images of tissue with nanorods. 
Logistic regression: We implemented logistic regression with stochastic gradient ascent on Matlab. The convergence criterion was 
0.05% training error, the learning parameter, α, was annealed in each iteration. We used a similar training and testing scheme as SVM. 
Batch gradient descent was also implemented but it did not converge well. 
K-means: Since we know that the nanorod spectrum is sensitive to its environment, it is preferable to train our model on more 
representing samples, i.e., tissue samples with nanorods, rather than nanorods on glass. Because we can never be sure if what we are 
seeing is a nanorod or part of the tissue, it should be beneficial to use a non-supervised learning method, such as k-means, to cluster 
the different objects in the images, and hopefully obtain a separate cluster for the nanorods which will allow us to classify them. We 
used Matlab’s k-means function, with 2, 3, 4, 5 and 6 clusters, and trained it on 4 images of nanorods in tissue. We tested our model 
against the two images containing nanorods on glass and tissue without nanorods (Fig 2 a, b), and also qualitatively. The nanorods 
cluster (positives) was determined by picking the most prevalent cluster in the image with nanorods on glass, whereas all other 
clusters were labeled negative. 
Principal component analysis (PCA): We implemented PCA on Matlab to reduce the dimensionality of the data. PCA was done on 
4 images of tissue sections with nanorods. We managed to reduce the dimension of our features from 261 to just 3 and conserve 
99.6% of the energy which is quite amazing.  
PCA + K-means (spectral clustering): Following PCA, we clustered our data in a similar manner to the previously described k-
means. We present the results for 5 clusters. The model was tested against Fig. 2 a, b. 

a 

b 

c 

  

    

   

 

Figure 2 Images used for training and testing our models. a) tissue section with no nanorods, b) nanorods on top of a glass slide, c) a tissue section in which 
nanorods are present and shown with a red-orange color.  
 

5.  Results 

SVM & Logistic regression  

                        
 
Predicted       true 
      0 
      1 
Precision 
Recall 
F-score 
Training error 
(# of samples) 
Test error 
(# of samples) 
# of iterations 

K-means  

               
predicted       true 
     0 
     1 
Precision 
Recall 
F-score 
Training error 
(# of samples) 
Test error 
(# of samples) 
Iterations # 
 

a 

SVM 

Stochastic logistic regression 

SVM based on k-means labels 

0 

75,791 (TN) 

2 (FP) 

1 

109 (FN) 

10,281 (TP) 

0 

75,771 

22 

1 
19 

10,371 

 (explained in section 6) 
0 
1 

75,743 

50 

195 

10,195 

0.9998 
0.9895 
0.9946 
0.13% 

(775,647) 

0.13% 
(86,183) 

9 

0.9979 
0.9982 
0.9980 
0.042% 
(777,647) 
0.047% 
(86,183) 

18 

0.9951 
0.9812 
0.9881 

- 

(490,773) 

0.28% 
(86,183) 

7 

3 clusters 

4 clusters 

5 clusters 

6 clusters 

PCA + 5 clusters 

0 

10,196 

295 

1 

194 

75,498 

0 

10,191 

176 

1 

199 

75,617 

0 

10,188 

130 

1 

202 

75,663 

0 

10,185 

25 

1 

205 

75,767 

0 

10,180 

127 

1 

210 

75,666 

0.9719 
0.9813 
0.9766 

- 

(490,773) 

0.57% 
(86,183) 

22 

0.983 
0.9808 
0.9819 

- 

(490,773) 

0.44% 
(86,183) 

91 

0.9874 
0.9806 
0.984 

- 

(490,773) 

0.39% 
(86,183) 

53 

b 

c 

0.9976 
0.9803 
0.9888 

- 

(490,773) 

0.27% 
(86,183) 

86 

d 

0.9877 
0.9798 

 
- 

(490,773) 

0.39% 
(86,183) 

37 

Figure 3: An example of one image classified by a) SVM, b) logistic regression, c) k-means with 5 clusters and d) PCA + k-means. The pixels labeled positive 
(nanorods) are marked in magenta. The yellow circles show regions which are positive for unsupervised learning and negative for supervised learning.  

a 

b 

c 

       

𝜆 [𝑛𝑚] 

 

𝜆 [𝑛𝑚] 

 

𝜆 [𝑛𝑚] 

 

Figure 4: a) The 5 cluster centers obtained by k-means. The magenta plot corresponds to the nanorod cluster. b) validation of the spectrums 
of the pixels detected as nanorods by the k-means classifier. They all have the distinctive nanorod peak. c) The principal components 
 

Automatic detection of plasmonic nanoparticles in tissue sections 

Dor Shaviv and Orly Liba 

1.  Introduction 

Plasmonic nanoparticles, such as gold nanorods, are gaining popularity in both medical imaging and therapeutics.  For example, they 
can be used for treating cancer. The rods are first coated with antibodies that bind to tumor specific antigens. They are then injected to 
a patient and accumulate in the tumor. Next, the patient is illuminated by infra-red light. The light is absorbed by the nanoparticles, 
causing local heating that destroys the tumor cells which the rods are bound to. The healthy cells which are not near the nanoparticles 
remain intact. It is important to quantify the binding of the nanoparticles to their target and prove that the binding is indeed specific to 
the tumor cells. Very recently, it has become feasible to image both the nanoparticles and tissue section. By using a dark-field 
microscope with an infra-red hyperspectral camera we are able to see the pathology of the tissue and the nanoparticles. However, it is 
not simple to locate and differentiate the nanoparticles from other structures in the tissue sections. 
In this project we propose an algorithm for automatic detection of nanoparticles in tissue sections by using their scattering spectrum in 
a dark field hyperspectral microscope. 
Owing to their plasmonic resonance, the gold nanorods have a peak scattering wavelength at around 900 nm. This unique scattering 
spectrum, along with the high scattering intensity of the nanorods, enables us to detect them in tissue sections by using a dark-field 
hyperspectral microscope. Although the nanorods have a very unique scattering spectrum, it is well known that their spectrum is 
sensitive to their environment and orientation. Therefore, one of the challenges in this project is the variability in the spectrum of the 
particles we wish to detect. 
Although the nanorods can be spotted in the images by eye, it can be very difficult to be sure that we are able to detect all of them in 
the tissue samples. This is because the images of the hyperspectral microscope are ultimately represented by only three channels: R, G 
and B, and do not show the full spectrum of each pixel. The large benefit of using an automatic detection scheme rather than just 
looking at the images is that it can classify the nanoparticles from the tissue by using the full spectrum. Another benefit of the 
automated algorithm is that it can detect and then count the number of nanoparticles in the image. The number of nanoparticles is 
valuable for understanding the efficiency and specificity of their binding.  
This report describes our progress in detecting the nanorods using methods learned in CS229. We have examined three methods of 
classification: logistic regression, SVM and k-means. We also looked at reducing the dimensionality of our data with PCA. The details 
and results are described below. 

2.  Experimental setup 

The gold nanorods that we are using were made in-house by the members of the de la Zerda lab. Their dimensions are 50x150 nm and 
have a peak scattering wavelength at around 900 nm. In order to stabilize them and make them bio-compatible they were coated with 
PSS-mPEG. Functionalization, i.e., adding a binding agent to the nanorods, was done by introducing antibodies which are meant to be 
tumor specific, for example anti-avb3. 
In order to create tumor models, we injected the ears of nude mice with cancer cells. Seven days after the cells were injected, we 
injected the nanorods to the tail veins of the mice. After several hours we sacrificed the mice and preserved the ears, which include the 
tumors and healthy regions. The preserved ears were sliced to 5 um thick slices and stained with H&E staining.  
We imaged the slides using the CytoViva HSI System with Enhanced Sensitivity dark-field hyperspectral microscope [1], which is 
located at SNF. The hyperspectral camera records the spectrum of each pixel at 361 sample points, at the wavelength range of 400 to 
1000 nm. The spectrums are lamp normalized, meaning that they are independent of the spectrum of the light source. Each image has 
509x512 pixels (~200 um). We used an objective with 40x magnification, which provides a pixel size of around 400 nm. We collected 
34 images of sections of mice in which nanorods were injected, 6 images of sections of mice without any injection and 1 image of 
gold nanorods on a glass slide. 

a 

b 

c 
c 

d 

  

    

  

   

 

Figure 1 a) TEM image of gold nanorods, b) scattering spectrum of the nanorods, measured with the hyperspectral microscope,  c) H&E stained tissue slice of 
a mouse ear (10x magnification). d) Diagram of a dark-field microscope.  

500600700800900100000.20.40.60.81 [nm]3.  Data preparation 

The raw data we use for the machine learning problem are the spectrums recorded for each pixel in the image. We have noticed that 
applying pre-processing to the raw data improves the results significantly. These are the steps we are currently performing before 
applying each of the machine learning models: 

1.  Spectrum truncation: The first 100 samples of the spectrum (400 – 566 nm) are removed because they contain mainly noise 

and do not contribute to the detection of the nanorods. Therefore, we remain with 261 feature points. 

2.  Background removal: the average signal across the spectrum was measured for each pixel. The pixels with very low values 

were disregarded because they are background and contain only noise. 

3.  Spectral smoothing: Noise in the spectrum is amplified at the edges due to the lamp normalization. We applied the Savitzky-

Golay filter, with length 33 and degree 2 to reduce the noise in the spectrum.  

4.  Normalization: The spectrum of each pixel was normalized by its maximum value. This was done to make the algorithm 

invariant to illumination.  

4.  Machine learning methods and their application 

Support vector machine (SVM): Training and prediction were done with Liblinear v1.94 [2] . We used L2-regularized L2-loss 
support vector classification (primal) with the default regularization parameter, C=1, and with a bias term (b ≠0).  

𝑚

𝑚𝑖𝑛
𝑤

   𝑤 

1
2

𝑤𝑇𝑤 + 𝐶 ∑(max (0,1 − 𝑦𝑖(𝑤𝑇𝑥𝑖 + 𝑏)))2

 

𝑖=1

When solving the dual problem, the optimization did not converge in the maximal number of iterations. We chose a linear kernel 
owing to the high number of samples and features of our data. The model was trained using two images (Fig 2 a, b). In an image of 
nanorods on glass (without tissue), each pixel above the background noise level was labeled as {1}. In an image of a tissue slide 
without nanorods, each pixel above the background noise level was labeled as {-1}. The model was tested with cross validation on the 
two training images (Fig 2 a, b) with k=10. The model was also tested qualitatively on images of tissue with nanorods. 
Logistic regression: We implemented logistic regression with stochastic gradient ascent on Matlab. The convergence criterion was 
0.05% training error, the learning parameter, α, was annealed in each iteration. We used a similar training and testing scheme as SVM. 
Batch gradient descent was also implemented but it did not converge well. 
K-means: Since we know that the nanorod spectrum is sensitive to its environment, it is preferable to train our model on more 
representing samples, i.e., tissue samples with nanorods, rather than nanorods on glass. Because we can never be sure if what we are 
seeing is a nanorod or part of the tissue, it should be beneficial to use a non-supervised learning method, such as k-means, to cluster 
the different objects in the images, and hopefully obtain a separate cluster for the nanorods which will allow us to classify them. We 
used Matlab’s k-means function, with 2, 3, 4, 5 and 6 clusters, and trained it on 4 images of nanorods in tissue. We tested our model 
against the two images containing nanorods on glass and tissue without nanorods (Fig 2 a, b), and also qualitatively. The nanorods 
cluster (positives) was determined by picking the most prevalent cluster in the image with nanorods on glass, whereas all other 
clusters were labeled negative. 
Principal component analysis (PCA): We implemented PCA on Matlab to reduce the dimensionality of the data. PCA was done on 
4 images of tissue sections with nanorods. We managed to reduce the dimension of our features from 261 to just 3 and conserve 
99.6% of the energy which is quite amazing.  
PCA + K-means (spectral clustering): Following PCA, we clustered our data in a similar manner to the previously described k-
means. We present the results for 5 clusters. The model was tested against Fig. 2 a, b. 

a 

b 

c 

  

    

   

 

Figure 2 Images used for training and testing our models. a) tissue section with no nanorods, b) nanorods on top of a glass slide, c) a tissue section in which 
nanorods are present and shown with a red-orange color.  
 

5.  Results 

SVM & Logistic regression  

                        
 
Predicted       true 
      0 
      1 
Precision 
Recall 
F-score 
Training error 
(# of samples) 
Test error 
(# of samples) 
# of iterations 

K-means  

               
predicted       true 
     0 
     1 
Precision 
Recall 
F-score 
Training error 
(# of samples) 
Test error 
(# of samples) 
Iterations # 
 

a 

SVM 

Stochastic logistic regression 

SVM based on k-means labels 

0 

75,791 (TN) 

2 (FP) 

1 

109 (FN) 

10,281 (TP) 

0 

75,771 

22 

1 
19 

10,371 

 (explained in section 6) 
0 
1 

75,743 

50 

195 

10,195 

0.9998 
0.9895 
0.9946 
0.13% 

(775,647) 

0.13% 
(86,183) 

9 

0.9979 
0.9982 
0.9980 
0.042% 
(777,647) 
0.047% 
(86,183) 

18 

0.9951 
0.9812 
0.9881 

- 

(490,773) 

0.28% 
(86,183) 

7 

3 clusters 

4 clusters 

5 clusters 

6 clusters 

PCA + 5 clusters 

0 

10,196 

295 

1 

194 

75,498 

0 

10,191 

176 

1 

199 

75,617 

0 

10,188 

130 

1 

202 

75,663 

0 

10,185 

25 

1 

205 

75,767 

0 

10,180 

127 

1 

210 

75,666 

0.9719 
0.9813 
0.9766 

- 

(490,773) 

0.57% 
(86,183) 

22 

0.983 
0.9808 
0.9819 

- 

(490,773) 

0.44% 
(86,183) 

91 

0.9874 
0.9806 
0.984 

- 

(490,773) 

0.39% 
(86,183) 

53 

b 

c 

0.9976 
0.9803 
0.9888 

- 

(490,773) 

0.27% 
(86,183) 

86 

d 

0.9877 
0.9798 

 
- 

(490,773) 

0.39% 
(86,183) 

37 

Figure 3: An example of one image classified by a) SVM, b) logistic regression, c) k-means with 5 clusters and d) PCA + k-means. The pixels labeled positive 
(nanorods) are marked in magenta. The yellow circles show regions which are positive for unsupervised learning and negative for supervised learning.  

a 

b 

c 

       

𝜆 [𝑛𝑚] 

 

𝜆 [𝑛𝑚] 

 

𝜆 [𝑛𝑚] 

 

Figure 4: a) The 5 cluster centers obtained by k-means. The magenta plot corresponds to the nanorod cluster. b) validation of the spectrums 
of the pixels detected as nanorods by the k-means classifier. They all have the distinctive nanorod peak. c) The principal components 
 

6.  Interesting observations 

1. 

It is interesting to see that k-means detects more nanorods than the supervised learning methods. Visualizing the data by 
looking at its principal components reveals that k-means detects more positives than the SVM decision boundary allows. 
Moreover, we see that the nanorods on glass are distinctly different than the nanorod cluster in the tissue section. This leads 
us to conclude that nanorods on glass have a different spectrum than in tissue section, which implies that unsupervised 
methods may be better than supervised methods in this case. 

Nanorod cluster 

Nanorods on glass 

Region classified as 
positives by k-means and 
negative by SVM 

SVM decision boundary 

Non-nanorod 

cluster 

Tissue only 

Figure 5 Visualization of the data with PCA. Red – nanorods on glass, blue – tissue only, magenta – pixels in the nanorods cluster, from 
images of tissue with nanorods (according to k-means with 5 clusters, applied on the data after PCA), cyan – pixels not in the nanorod 
cluster. The plane is the decision boundary calculated by SVM trained on the red and blue data. 

2.  Following our observation that nanorods on glass have a different spectrum than nanorods in tissue, it is interesting to create 
a supervised learning model based only on the tissue sections. Assuming that the labeling of k-means is correct (this claim is 
supported by looking at the spectrums), we trained the supervised learning model (SVM, in this case) based on the k-means 
labels. Doing this after reducing the dimensionality of the data with PCA provides insight to the difference between the 
models. As shown previously, the model trained on tissue samples increases the number of positives. The results of this 
method, when tested on the two images with nanorods only and tissue only are in section 5. 

 

Figure 6 Data visualized with PCA as in Fig. 5 with two SVM decision boundaries. Green – trained on positive and negative samples 
(nanorods on glass and tissue only), yellow – trained on the data labeled with k-means (train and test samples are from different images) 

3. 

In two of the tissue images in which nanorods were not injected, the k-means model detects positives (nanorods) near the 
edges of features. These are actually imaging artifacts caused by chromatic aberrations. Analyzing the spectrum of the 
aberrations shows a significant difference to that of the rods. Using k-means a second time, with 2 clusters, trained only on 

 

Automatic detection of plasmonic nanoparticles in tissue sections 

Dor Shaviv and Orly Liba 

1.  Introduction 

Plasmonic nanoparticles, such as gold nanorods, are gaining popularity in both medical imaging and therapeutics.  For example, they 
can be used for treating cancer. The rods are first coated with antibodies that bind to tumor specific antigens. They are then injected to 
a patient and accumulate in the tumor. Next, the patient is illuminated by infra-red light. The light is absorbed by the nanoparticles, 
causing local heating that destroys the tumor cells which the rods are bound to. The healthy cells which are not near the nanoparticles 
remain intact. It is important to quantify the binding of the nanoparticles to their target and prove that the binding is indeed specific to 
the tumor cells. Very recently, it has become feasible to image both the nanoparticles and tissue section. By using a dark-field 
microscope with an infra-red hyperspectral camera we are able to see the pathology of the tissue and the nanoparticles. However, it is 
not simple to locate and differentiate the nanoparticles from other structures in the tissue sections. 
In this project we propose an algorithm for automatic detection of nanoparticles in tissue sections by using their scattering spectrum in 
a dark field hyperspectral microscope. 
Owing to their plasmonic resonance, the gold nanorods have a peak scattering wavelength at around 900 nm. This unique scattering 
spectrum, along with the high scattering intensity of the nanorods, enables us to detect them in tissue sections by using a dark-field 
hyperspectral microscope. Although the nanorods have a very unique scattering spectrum, it is well known that their spectrum is 
sensitive to their environment and orientation. Therefore, one of the challenges in this project is the variability in the spectrum of the 
particles we wish to detect. 
Although the nanorods can be spotted in the images by eye, it can be very difficult to be sure that we are able to detect all of them in 
the tissue samples. This is because the images of the hyperspectral microscope are ultimately represented by only three channels: R, G 
and B, and do not show the full spectrum of each pixel. The large benefit of using an automatic detection scheme rather than just 
looking at the images is that it can classify the nanoparticles from the tissue by using the full spectrum. Another benefit of the 
automated algorithm is that it can detect and then count the number of nanoparticles in the image. The number of nanoparticles is 
valuable for understanding the efficiency and specificity of their binding.  
This report describes our progress in detecting the nanorods using methods learned in CS229. We have examined three methods of 
classification: logistic regression, SVM and k-means. We also looked at reducing the dimensionality of our data with PCA. The details 
and results are described below. 

2.  Experimental setup 

The gold nanorods that we are using were made in-house by the members of the de la Zerda lab. Their dimensions are 50x150 nm and 
have a peak scattering wavelength at around 900 nm. In order to stabilize them and make them bio-compatible they were coated with 
PSS-mPEG. Functionalization, i.e., adding a binding agent to the nanorods, was done by introducing antibodies which are meant to be 
tumor specific, for example anti-avb3. 
In order to create tumor models, we injected the ears of nude mice with cancer cells. Seven days after the cells were injected, we 
injected the nanorods to the tail veins of the mice. After several hours we sacrificed the mice and preserved the ears, which include the 
tumors and healthy regions. The preserved ears were sliced to 5 um thick slices and stained with H&E staining.  
We imaged the slides using the CytoViva HSI System with Enhanced Sensitivity dark-field hyperspectral microscope [1], which is 
located at SNF. The hyperspectral camera records the spectrum of each pixel at 361 sample points, at the wavelength range of 400 to 
1000 nm. The spectrums are lamp normalized, meaning that they are independent of the spectrum of the light source. Each image has 
509x512 pixels (~200 um). We used an objective with 40x magnification, which provides a pixel size of around 400 nm. We collected 
34 images of sections of mice in which nanorods were injected, 6 images of sections of mice without any injection and 1 image of 
gold nanorods on a glass slide. 

a 

b 

c 
c 

d 

  

    

  

   

 

Figure 1 a) TEM image of gold nanorods, b) scattering spectrum of the nanorods, measured with the hyperspectral microscope,  c) H&E stained tissue slice of 
a mouse ear (10x magnification). d) Diagram of a dark-field microscope.  

500600700800900100000.20.40.60.81 [nm]3.  Data preparation 

The raw data we use for the machine learning problem are the spectrums recorded for each pixel in the image. We have noticed that 
applying pre-processing to the raw data improves the results significantly. These are the steps we are currently performing before 
applying each of the machine learning models: 

1.  Spectrum truncation: The first 100 samples of the spectrum (400 – 566 nm) are removed because they contain mainly noise 

and do not contribute to the detection of the nanorods. Therefore, we remain with 261 feature points. 

2.  Background removal: the average signal across the spectrum was measured for each pixel. The pixels with very low values 

were disregarded because they are background and contain only noise. 

3.  Spectral smoothing: Noise in the spectrum is amplified at the edges due to the lamp normalization. We applied the Savitzky-

Golay filter, with length 33 and degree 2 to reduce the noise in the spectrum.  

4.  Normalization: The spectrum of each pixel was normalized by its maximum value. This was done to make the algorithm 

invariant to illumination.  

4.  Machine learning methods and their application 

Support vector machine (SVM): Training and prediction were done with Liblinear v1.94 [2] . We used L2-regularized L2-loss 
support vector classification (primal) with the default regularization parameter, C=1, and with a bias term (b ≠0).  

𝑚

𝑚𝑖𝑛
𝑤

   𝑤 

1
2

𝑤𝑇𝑤 + 𝐶 ∑(max (0,1 − 𝑦𝑖(𝑤𝑇𝑥𝑖 + 𝑏)))2

 

𝑖=1

When solving the dual problem, the optimization did not converge in the maximal number of iterations. We chose a linear kernel 
owing to the high number of samples and features of our data. The model was trained using two images (Fig 2 a, b). In an image of 
nanorods on glass (without tissue), each pixel above the background noise level was labeled as {1}. In an image of a tissue slide 
without nanorods, each pixel above the background noise level was labeled as {-1}. The model was tested with cross validation on the 
two training images (Fig 2 a, b) with k=10. The model was also tested qualitatively on images of tissue with nanorods. 
Logistic regression: We implemented logistic regression with stochastic gradient ascent on Matlab. The convergence criterion was 
0.05% training error, the learning parameter, α, was annealed in each iteration. We used a similar training and testing scheme as SVM. 
Batch gradient descent was also implemented but it did not converge well. 
K-means: Since we know that the nanorod spectrum is sensitive to its environment, it is preferable to train our model on more 
representing samples, i.e., tissue samples with nanorods, rather than nanorods on glass. Because we can never be sure if what we are 
seeing is a nanorod or part of the tissue, it should be beneficial to use a non-supervised learning method, such as k-means, to cluster 
the different objects in the images, and hopefully obtain a separate cluster for the nanorods which will allow us to classify them. We 
used Matlab’s k-means function, with 2, 3, 4, 5 and 6 clusters, and trained it on 4 images of nanorods in tissue. We tested our model 
against the two images containing nanorods on glass and tissue without nanorods (Fig 2 a, b), and also qualitatively. The nanorods 
cluster (positives) was determined by picking the most prevalent cluster in the image with nanorods on glass, whereas all other 
clusters were labeled negative. 
Principal component analysis (PCA): We implemented PCA on Matlab to reduce the dimensionality of the data. PCA was done on 
4 images of tissue sections with nanorods. We managed to reduce the dimension of our features from 261 to just 3 and conserve 
99.6% of the energy which is quite amazing.  
PCA + K-means (spectral clustering): Following PCA, we clustered our data in a similar manner to the previously described k-
means. We present the results for 5 clusters. The model was tested against Fig. 2 a, b. 

a 

b 

c 

  

    

   

 

Figure 2 Images used for training and testing our models. a) tissue section with no nanorods, b) nanorods on top of a glass slide, c) a tissue section in which 
nanorods are present and shown with a red-orange color.  
 

5.  Results 

SVM & Logistic regression  

                        
 
Predicted       true 
      0 
      1 
Precision 
Recall 
F-score 
Training error 
(# of samples) 
Test error 
(# of samples) 
# of iterations 

K-means  

               
predicted       true 
     0 
     1 
Precision 
Recall 
F-score 
Training error 
(# of samples) 
Test error 
(# of samples) 
Iterations # 
 

a 

SVM 

Stochastic logistic regression 

SVM based on k-means labels 

0 

75,791 (TN) 

2 (FP) 

1 

109 (FN) 

10,281 (TP) 

0 

75,771 

22 

1 
19 

10,371 

 (explained in section 6) 
0 
1 

75,743 

50 

195 

10,195 

0.9998 
0.9895 
0.9946 
0.13% 

(775,647) 

0.13% 
(86,183) 

9 

0.9979 
0.9982 
0.9980 
0.042% 
(777,647) 
0.047% 
(86,183) 

18 

0.9951 
0.9812 
0.9881 

- 

(490,773) 

0.28% 
(86,183) 

7 

3 clusters 

4 clusters 

5 clusters 

6 clusters 

PCA + 5 clusters 

0 

10,196 

295 

1 

194 

75,498 

0 

10,191 

176 

1 

199 

75,617 

0 

10,188 

130 

1 

202 

75,663 

0 

10,185 

25 

1 

205 

75,767 

0 

10,180 

127 

1 

210 

75,666 

0.9719 
0.9813 
0.9766 

- 

(490,773) 

0.57% 
(86,183) 

22 

0.983 
0.9808 
0.9819 

- 

(490,773) 

0.44% 
(86,183) 

91 

0.9874 
0.9806 
0.984 

- 

(490,773) 

0.39% 
(86,183) 

53 

b 

c 

0.9976 
0.9803 
0.9888 

- 

(490,773) 

0.27% 
(86,183) 

86 

d 

0.9877 
0.9798 

 
- 

(490,773) 

0.39% 
(86,183) 

37 

Figure 3: An example of one image classified by a) SVM, b) logistic regression, c) k-means with 5 clusters and d) PCA + k-means. The pixels labeled positive 
(nanorods) are marked in magenta. The yellow circles show regions which are positive for unsupervised learning and negative for supervised learning.  

a 

b 

c 

       

𝜆 [𝑛𝑚] 

 

𝜆 [𝑛𝑚] 

 

𝜆 [𝑛𝑚] 

 

Figure 4: a) The 5 cluster centers obtained by k-means. The magenta plot corresponds to the nanorod cluster. b) validation of the spectrums 
of the pixels detected as nanorods by the k-means classifier. They all have the distinctive nanorod peak. c) The principal components 
 

6.  Interesting observations 

1. 

It is interesting to see that k-means detects more nanorods than the supervised learning methods. Visualizing the data by 
looking at its principal components reveals that k-means detects more positives than the SVM decision boundary allows. 
Moreover, we see that the nanorods on glass are distinctly different than the nanorod cluster in the tissue section. This leads 
us to conclude that nanorods on glass have a different spectrum than in tissue section, which implies that unsupervised 
methods may be better than supervised methods in this case. 

Nanorod cluster 

Nanorods on glass 

Region classified as 
positives by k-means and 
negative by SVM 

SVM decision boundary 

Non-nanorod 

cluster 

Tissue only 

Figure 5 Visualization of the data with PCA. Red – nanorods on glass, blue – tissue only, magenta – pixels in the nanorods cluster, from 
images of tissue with nanorods (according to k-means with 5 clusters, applied on the data after PCA), cyan – pixels not in the nanorod 
cluster. The plane is the decision boundary calculated by SVM trained on the red and blue data. 

2.  Following our observation that nanorods on glass have a different spectrum than nanorods in tissue, it is interesting to create 
a supervised learning model based only on the tissue sections. Assuming that the labeling of k-means is correct (this claim is 
supported by looking at the spectrums), we trained the supervised learning model (SVM, in this case) based on the k-means 
labels. Doing this after reducing the dimensionality of the data with PCA provides insight to the difference between the 
models. As shown previously, the model trained on tissue samples increases the number of positives. The results of this 
method, when tested on the two images with nanorods only and tissue only are in section 5. 

 

Figure 6 Data visualized with PCA as in Fig. 5 with two SVM decision boundaries. Green – trained on positive and negative samples 
(nanorods on glass and tissue only), yellow – trained on the data labeled with k-means (train and test samples are from different images) 

3. 

In two of the tissue images in which nanorods were not injected, the k-means model detects positives (nanorods) near the 
edges of features. These are actually imaging artifacts caused by chromatic aberrations. Analyzing the spectrum of the 
aberrations shows a significant difference to that of the rods. Using k-means a second time, with 2 clusters, trained only on 

 

the pixels in the nanorod cluster (from the original 4 training images), reduces the positives in these images. The test error 
after adding the additional cluster is 0.4% (the test samples don’t include the image below). 

a 

b 

c 

Figure 7 Reduction in false positives caused by chromatic aberrations by applying an additional cluster. a) analysis of the spectrums of 
positives in the tissue samples (chromatic aberrations, blue), nanorods in tissue (magenta) and nanorods on glass (red). b) tissue section with 
false positives using 5 k-means clusters. c) tissue section with much less false positives using 5 k-means clusters and an additional k-means 
clustering step on all of the positives. 

  

   

 

7.  Summary & Discussion 

We have succeeded in detecting the gold nanorods in tissue samples with k-means, SVM, logistic regression and a combination of 
those with PCA. All had a test error that was less than 0.6%. K-means, even with only 3 clusters, does a good job detecting the rods in 
the tissue section. Increasing the number of clusters to 4, 5 and 6 further improves the classification. It was nice to see that PCA 
managed to reduce the dimension of our features from 261 to just 3 and conserve 99.6% of the energy. We have shown that the 
nanorods on a glass slide have a different spectrum than nanorods in tissue. This difference leads to a decrease in the number of pixels 
classified as positives when we use supervised learning (SVM and logistic regression) compared to unsupervised learning that was 
trained on the tissue slices. Therefore, unsupervised learning methods, such as k-means, are more suited for this task. We also found 
that chromatic aberrations are sometimes detected as nanorods and that we can reduce these false positives with an additional k-means 
cluster. 

8.  Next steps 

  Since we have found that nanorods on glass have a different spectrum than in tissue, training and testing using nanorods on glass 

is sub-optimal. Thus, we would create a ground truth of rods in tissue, perhaps by observing the spectrums at potential pixels. 
This ground truth could be used for training supervised learning models and testing all types of models. 

  We would like to try additional machine learning models, such as neural networks, SVM with different kernels and Gaussian 

mixture models. 

  Seeing that we were able to reduce the number of features from 261 to 3, could we use these 3 features to encode for color (RGB) 

and visualize the rods in the tissue sections in a 2D colored image? 

 

In addition, we would like to optimize the preprocessing of the data to allow for better background and noise removal and 
reduction of chromatic aberrations. 

  Another possible approach to improving the detection of the nanorods would be to image the tissue sections before staining them, 

since the staining changes the spectrum of the nanorods. 

 

In the future it would be nice to be able to classify multiple kinds of nanoparticles (with different scattering spectra) and perhaps 
also different cell types and organelles. 

9.  Acknowledgements 

The authors would like to thank Elliott Sorelle, Roopa Dalal and the members of the de la Zerda lab for providing the materials and 
data for this project. We would also like to that professor Andrew Ng and the TA team of CS229. 

      10.   References  
[1] http://www.cytoviva.com/wp-content/uploads/2014/04/Spec-Sheet-VNIR-enhanced-sensitivity.pdf 
[2] R.-E. Fan, K.-W. Chang, C.-J. Hsieh, X.-R. Wang, and C.-J. Lin. LIBLINEAR: A Library for Large Linear Classification, Journal 
of Machine Learning Research 9(2008), 1871-1874. Software available at http://www.csie.ntu.edu.tw/~cjlin/liblinear 


Survival Outcome Prediction for Cancer Patients based
on Gene Interaction Network Analysis and Expression

Proﬁle Classiﬁcation

Final Project Report
Alexander Herrmann

Advised by Dr. Andrew Gentles

December 11, 2014

Special Notice: This project is undertaken for both CS 229 and CS 224W with instructor con-
sent. Parts of the project used for CS 224W and CS 229, respectively, will be appropriately
identiﬁed.

1

Introduction

The classiﬁcation of gene expression proﬁles for diagnosis and survival outcome prediction
for cancer patients is an important yet challenging task in systems biology. Conventional
analysis of gene expression proﬁles generally succeeds in identifying distinct cancer cell types
as well as healthy tissues. However, the reliable prediction of cancer subtypes and survival
outcome parameters for patients suﬀering from the same type of cancer remains elusive
because the expression patterns for the majority of genetic markers are not suﬃciently dis-
tinct. In order to focus on the most informative marker subsets and allow subclassiﬁcation of
gene expression patterns, novel feature selection techniques for supervised machine learning
methods must be developed. This project aims to address this problem by reconstructing
a gene interaction network from steady-state gene expression proﬁles, characterizing certain
subsets of genes according to their topological properties and verifying these subsets’ utility
as feature selection ﬁlters for a variety of classiﬁcation algorithms.

2 Project Description and Related Work

For CS 229 the goal of the project was to subject a dataset of 13,334 genes and 1,106 lung
adenocarcinoma patient samples to a number of supervised machine learning algorithms, e.g.
logistic regression, softmax regression and Gaussian discriminant analysis (GDA) in order to
classify gene expression proﬁles according to cancer subtype and survival outcome. The brute
force approach was to apply each of the aforementioned learning algorithms to the entire
dataset without feature selection. A more nuanced but nonetheless conventional approach

1

Survival Outcome Prediction for Cancer Patients based
on Gene Interaction Network Analysis and Expression

Proﬁle Classiﬁcation

Final Project Report
Alexander Herrmann

Advised by Dr. Andrew Gentles

December 11, 2014

Special Notice: This project is undertaken for both CS 229 and CS 224W with instructor con-
sent. Parts of the project used for CS 224W and CS 229, respectively, will be appropriately
identiﬁed.

1

Introduction

The classiﬁcation of gene expression proﬁles for diagnosis and survival outcome prediction
for cancer patients is an important yet challenging task in systems biology. Conventional
analysis of gene expression proﬁles generally succeeds in identifying distinct cancer cell types
as well as healthy tissues. However, the reliable prediction of cancer subtypes and survival
outcome parameters for patients suﬀering from the same type of cancer remains elusive
because the expression patterns for the majority of genetic markers are not suﬃciently dis-
tinct. In order to focus on the most informative marker subsets and allow subclassiﬁcation of
gene expression patterns, novel feature selection techniques for supervised machine learning
methods must be developed. This project aims to address this problem by reconstructing
a gene interaction network from steady-state gene expression proﬁles, characterizing certain
subsets of genes according to their topological properties and verifying these subsets’ utility
as feature selection ﬁlters for a variety of classiﬁcation algorithms.

2 Project Description and Related Work

For CS 229 the goal of the project was to subject a dataset of 13,334 genes and 1,106 lung
adenocarcinoma patient samples to a number of supervised machine learning algorithms, e.g.
logistic regression, softmax regression and Gaussian discriminant analysis (GDA) in order to
classify gene expression proﬁles according to cancer subtype and survival outcome. The brute
force approach was to apply each of the aforementioned learning algorithms to the entire
dataset without feature selection. A more nuanced but nonetheless conventional approach

1

was to adjust the number of features to address the tradeoﬀ between bias and variance.
Feature selection was performed by ranking genes according to the correlation between their
expression values and survival outcome parameters, and choosing those with the highest
correlation as machine learning features. For this purpose Mutual Information (MI) was
used as a correlation measure. Both brute force and conventional feature selection were
then tested and compared. The patient dataset was subdivided in a random but balanced
fashion so as to allow training and testing on independent sets. After training each of the
algorithms, test success rates for the diﬀerent approaches were quantiﬁed for each algorithm
and juxtaposed against each other.

For CS 224W, the goal was to provide a novel feature selection approach for machine
learning by taking into account the topological properties of the gene interaction network
whose states are described by the aforementioned gene expression proﬁles. One topological
feature selection approach based on PageRank has been proposed in [1]. In this approach
node j in the gene interaction network is ranked according to the following iteration recipe:

j = (1 − d)cj + d
rn

N(cid:88)

i=1

Aijrn−1

i
ki

where A is the adjacency matrix, ki the degree of node i and cj is the Pearson correlation
value of gene j with the output measured in terms of survival time. The parameter d weighs
how much inﬂuence is attributed to the Pearson correlation with the output and how much
to the topology of the network via PageRank. Before a ﬁlter is applied, the optimal value of
parameter d must be estimated. This is done by splitting the training set into two subsets
for training and testing purposes. Several trials are performed for diﬀerent values of d and
the value with the best predictive result is chosen.

However, it is not obvious why a high PageRank score should be the determining cri-
terion for feature selection as opposed to some other topological property with a diﬀerent
value range. It may therefore be worthwhile to choose a diﬀerent approach and check other
topological node properties for their utility as feature selection parameters. The ﬁrst step
in this project was to reconstruct the underlying gene interaction network with the network
inference algorithm ARACNE [2]. This method uses steady-state gene expression data to
predict direct interactions between gene pairs based on MI correlation and the data process-
ing inequality (DPI). The adjacency matrix produced by ARACNE was then processed by
SNAP to compute a set of p = 18 topological network properties for each node i. These
values were used to embed each node as a coordinate point in a p-dimensional space in a
manner similar to that in [3]. Subsequently, K-means clustering was applied to these em-
bedded points to discover prominent gene clusters in p-space. Each cluster was then used
as a gene pool for the MI feature selection ﬁlter to act upon. The performance of each pool
was measured by applying the machine learning routines to the test set and comparing the
resulting success rates with those of the brute force and the conventional feature selection
approach.

2

Survival Outcome Prediction for Cancer Patients based
on Gene Interaction Network Analysis and Expression

Proﬁle Classiﬁcation

Final Project Report
Alexander Herrmann

Advised by Dr. Andrew Gentles

December 11, 2014

Special Notice: This project is undertaken for both CS 229 and CS 224W with instructor con-
sent. Parts of the project used for CS 224W and CS 229, respectively, will be appropriately
identiﬁed.

1

Introduction

The classiﬁcation of gene expression proﬁles for diagnosis and survival outcome prediction
for cancer patients is an important yet challenging task in systems biology. Conventional
analysis of gene expression proﬁles generally succeeds in identifying distinct cancer cell types
as well as healthy tissues. However, the reliable prediction of cancer subtypes and survival
outcome parameters for patients suﬀering from the same type of cancer remains elusive
because the expression patterns for the majority of genetic markers are not suﬃciently dis-
tinct. In order to focus on the most informative marker subsets and allow subclassiﬁcation of
gene expression patterns, novel feature selection techniques for supervised machine learning
methods must be developed. This project aims to address this problem by reconstructing
a gene interaction network from steady-state gene expression proﬁles, characterizing certain
subsets of genes according to their topological properties and verifying these subsets’ utility
as feature selection ﬁlters for a variety of classiﬁcation algorithms.

2 Project Description and Related Work

For CS 229 the goal of the project was to subject a dataset of 13,334 genes and 1,106 lung
adenocarcinoma patient samples to a number of supervised machine learning algorithms, e.g.
logistic regression, softmax regression and Gaussian discriminant analysis (GDA) in order to
classify gene expression proﬁles according to cancer subtype and survival outcome. The brute
force approach was to apply each of the aforementioned learning algorithms to the entire
dataset without feature selection. A more nuanced but nonetheless conventional approach

1

was to adjust the number of features to address the tradeoﬀ between bias and variance.
Feature selection was performed by ranking genes according to the correlation between their
expression values and survival outcome parameters, and choosing those with the highest
correlation as machine learning features. For this purpose Mutual Information (MI) was
used as a correlation measure. Both brute force and conventional feature selection were
then tested and compared. The patient dataset was subdivided in a random but balanced
fashion so as to allow training and testing on independent sets. After training each of the
algorithms, test success rates for the diﬀerent approaches were quantiﬁed for each algorithm
and juxtaposed against each other.

For CS 224W, the goal was to provide a novel feature selection approach for machine
learning by taking into account the topological properties of the gene interaction network
whose states are described by the aforementioned gene expression proﬁles. One topological
feature selection approach based on PageRank has been proposed in [1]. In this approach
node j in the gene interaction network is ranked according to the following iteration recipe:

j = (1 − d)cj + d
rn

N(cid:88)

i=1

Aijrn−1

i
ki

where A is the adjacency matrix, ki the degree of node i and cj is the Pearson correlation
value of gene j with the output measured in terms of survival time. The parameter d weighs
how much inﬂuence is attributed to the Pearson correlation with the output and how much
to the topology of the network via PageRank. Before a ﬁlter is applied, the optimal value of
parameter d must be estimated. This is done by splitting the training set into two subsets
for training and testing purposes. Several trials are performed for diﬀerent values of d and
the value with the best predictive result is chosen.

However, it is not obvious why a high PageRank score should be the determining cri-
terion for feature selection as opposed to some other topological property with a diﬀerent
value range. It may therefore be worthwhile to choose a diﬀerent approach and check other
topological node properties for their utility as feature selection parameters. The ﬁrst step
in this project was to reconstruct the underlying gene interaction network with the network
inference algorithm ARACNE [2]. This method uses steady-state gene expression data to
predict direct interactions between gene pairs based on MI correlation and the data process-
ing inequality (DPI). The adjacency matrix produced by ARACNE was then processed by
SNAP to compute a set of p = 18 topological network properties for each node i. These
values were used to embed each node as a coordinate point in a p-dimensional space in a
manner similar to that in [3]. Subsequently, K-means clustering was applied to these em-
bedded points to discover prominent gene clusters in p-space. Each cluster was then used
as a gene pool for the MI feature selection ﬁlter to act upon. The performance of each pool
was measured by applying the machine learning routines to the test set and comparing the
resulting success rates with those of the brute force and the conventional feature selection
approach.

2

3 Dataset

The dataset used in this project represents an agglomeration of clinical data from diﬀerent
patient groups with lung adenocarcinoma collected over many years. With 13,334 genes and
1,106 patients this data set is rather large, given that the usual number of patients used for
machine learning algorithms in cancer biology is an order of magnitude lower. For machine
learning purposes, the dataset was randomly split into a training and a test set of 563 and
543 patients, respectively, such that age, gender and other patient parameters remained
balanced to prevent skewed results due to either of these factors.

The data is comprised of two parts. The ﬁrst part is a table of gene expression values,
in which rows correspond to genes and columns to patients. Sporadically occurring missing
values were imputed with the function knnimpute in MATLAB using the 15 nearest neigh-
boring columns as measured by Euclidean distance, a standard procedure in bioinformatics.
This adjusted dataset is the starting point for the ARACNE algorithm from which the ad-
jacency matrix is inferred. For performance reasons, ARACNE was executed with a set of
one hundred patients, the minimum admissible number for the algorithm to produce a useful
reconstruction of the gene interaction network.

The second part of the dataset consists of a ﬁle containing patient IDs as rows and
survival parameters and other clinical information as columns. There are two kinds of
survival parameters considered in this project. The ﬁrst measures the patient status as to
whether the patient is dead or alive after 5 years. The second measures the cancer subtype,
a multivalued measure assuming the values {I, II, III, IV } representing increasing severity
and aggressiveness of the cancer.

4 Network Inference Algorithm and Other Methods

4.1 Network Inference Algorithm

In ARACNE, stationary gene expression proﬁles are subjected to correlation analysis in order
to infer the probability of direct links between gene pairs. ARACNE proceeds by examining
all possible pairwise interactions and then deleting all those which do not pass through its
ﬁlters. The are two ﬁlters:
(1) Mutual information (MI) ﬁlter : MI is an information theoretic relatedness measure em-
ployed to remove all links {i, j}, for which the mutual information estimate I(gi, gj) < I0, i.e.
for which the calculated mutual information approximation falls below a certain threshold
I0 determined by the user either directly or by setting a p-value.
(2) DPI ﬁlter : In order to remove what are likely inferred but non-existent direct links,
ARACNE examines all triangles {gi, gj, gk} and, using the data processing inequality (DPI)
I(g1, g3) ≤ min{I(g1, g2), I(g2, g3)}, marks the weakest link in each triad for deletion, subse-
quently disposing of all marked links and with them of all three-gene-loops in the network.

ARACNE’s complexity is O(N 3 + N 2M 2) with N and M being the number of nodes and
patient samples, respectively. The N 3 cube term results from the DPI ﬁlter whereas the
N 2M 2 term is due to the MI ﬁlter.

3

Survival Outcome Prediction for Cancer Patients based
on Gene Interaction Network Analysis and Expression

Proﬁle Classiﬁcation

Final Project Report
Alexander Herrmann

Advised by Dr. Andrew Gentles

December 11, 2014

Special Notice: This project is undertaken for both CS 229 and CS 224W with instructor con-
sent. Parts of the project used for CS 224W and CS 229, respectively, will be appropriately
identiﬁed.

1

Introduction

The classiﬁcation of gene expression proﬁles for diagnosis and survival outcome prediction
for cancer patients is an important yet challenging task in systems biology. Conventional
analysis of gene expression proﬁles generally succeeds in identifying distinct cancer cell types
as well as healthy tissues. However, the reliable prediction of cancer subtypes and survival
outcome parameters for patients suﬀering from the same type of cancer remains elusive
because the expression patterns for the majority of genetic markers are not suﬃciently dis-
tinct. In order to focus on the most informative marker subsets and allow subclassiﬁcation of
gene expression patterns, novel feature selection techniques for supervised machine learning
methods must be developed. This project aims to address this problem by reconstructing
a gene interaction network from steady-state gene expression proﬁles, characterizing certain
subsets of genes according to their topological properties and verifying these subsets’ utility
as feature selection ﬁlters for a variety of classiﬁcation algorithms.

2 Project Description and Related Work

For CS 229 the goal of the project was to subject a dataset of 13,334 genes and 1,106 lung
adenocarcinoma patient samples to a number of supervised machine learning algorithms, e.g.
logistic regression, softmax regression and Gaussian discriminant analysis (GDA) in order to
classify gene expression proﬁles according to cancer subtype and survival outcome. The brute
force approach was to apply each of the aforementioned learning algorithms to the entire
dataset without feature selection. A more nuanced but nonetheless conventional approach

1

was to adjust the number of features to address the tradeoﬀ between bias and variance.
Feature selection was performed by ranking genes according to the correlation between their
expression values and survival outcome parameters, and choosing those with the highest
correlation as machine learning features. For this purpose Mutual Information (MI) was
used as a correlation measure. Both brute force and conventional feature selection were
then tested and compared. The patient dataset was subdivided in a random but balanced
fashion so as to allow training and testing on independent sets. After training each of the
algorithms, test success rates for the diﬀerent approaches were quantiﬁed for each algorithm
and juxtaposed against each other.

For CS 224W, the goal was to provide a novel feature selection approach for machine
learning by taking into account the topological properties of the gene interaction network
whose states are described by the aforementioned gene expression proﬁles. One topological
feature selection approach based on PageRank has been proposed in [1]. In this approach
node j in the gene interaction network is ranked according to the following iteration recipe:

j = (1 − d)cj + d
rn

N(cid:88)

i=1

Aijrn−1

i
ki

where A is the adjacency matrix, ki the degree of node i and cj is the Pearson correlation
value of gene j with the output measured in terms of survival time. The parameter d weighs
how much inﬂuence is attributed to the Pearson correlation with the output and how much
to the topology of the network via PageRank. Before a ﬁlter is applied, the optimal value of
parameter d must be estimated. This is done by splitting the training set into two subsets
for training and testing purposes. Several trials are performed for diﬀerent values of d and
the value with the best predictive result is chosen.

However, it is not obvious why a high PageRank score should be the determining cri-
terion for feature selection as opposed to some other topological property with a diﬀerent
value range. It may therefore be worthwhile to choose a diﬀerent approach and check other
topological node properties for their utility as feature selection parameters. The ﬁrst step
in this project was to reconstruct the underlying gene interaction network with the network
inference algorithm ARACNE [2]. This method uses steady-state gene expression data to
predict direct interactions between gene pairs based on MI correlation and the data process-
ing inequality (DPI). The adjacency matrix produced by ARACNE was then processed by
SNAP to compute a set of p = 18 topological network properties for each node i. These
values were used to embed each node as a coordinate point in a p-dimensional space in a
manner similar to that in [3]. Subsequently, K-means clustering was applied to these em-
bedded points to discover prominent gene clusters in p-space. Each cluster was then used
as a gene pool for the MI feature selection ﬁlter to act upon. The performance of each pool
was measured by applying the machine learning routines to the test set and comparing the
resulting success rates with those of the brute force and the conventional feature selection
approach.

2

3 Dataset

The dataset used in this project represents an agglomeration of clinical data from diﬀerent
patient groups with lung adenocarcinoma collected over many years. With 13,334 genes and
1,106 patients this data set is rather large, given that the usual number of patients used for
machine learning algorithms in cancer biology is an order of magnitude lower. For machine
learning purposes, the dataset was randomly split into a training and a test set of 563 and
543 patients, respectively, such that age, gender and other patient parameters remained
balanced to prevent skewed results due to either of these factors.

The data is comprised of two parts. The ﬁrst part is a table of gene expression values,
in which rows correspond to genes and columns to patients. Sporadically occurring missing
values were imputed with the function knnimpute in MATLAB using the 15 nearest neigh-
boring columns as measured by Euclidean distance, a standard procedure in bioinformatics.
This adjusted dataset is the starting point for the ARACNE algorithm from which the ad-
jacency matrix is inferred. For performance reasons, ARACNE was executed with a set of
one hundred patients, the minimum admissible number for the algorithm to produce a useful
reconstruction of the gene interaction network.

The second part of the dataset consists of a ﬁle containing patient IDs as rows and
survival parameters and other clinical information as columns. There are two kinds of
survival parameters considered in this project. The ﬁrst measures the patient status as to
whether the patient is dead or alive after 5 years. The second measures the cancer subtype,
a multivalued measure assuming the values {I, II, III, IV } representing increasing severity
and aggressiveness of the cancer.

4 Network Inference Algorithm and Other Methods

4.1 Network Inference Algorithm

In ARACNE, stationary gene expression proﬁles are subjected to correlation analysis in order
to infer the probability of direct links between gene pairs. ARACNE proceeds by examining
all possible pairwise interactions and then deleting all those which do not pass through its
ﬁlters. The are two ﬁlters:
(1) Mutual information (MI) ﬁlter : MI is an information theoretic relatedness measure em-
ployed to remove all links {i, j}, for which the mutual information estimate I(gi, gj) < I0, i.e.
for which the calculated mutual information approximation falls below a certain threshold
I0 determined by the user either directly or by setting a p-value.
(2) DPI ﬁlter : In order to remove what are likely inferred but non-existent direct links,
ARACNE examines all triangles {gi, gj, gk} and, using the data processing inequality (DPI)
I(g1, g3) ≤ min{I(g1, g2), I(g2, g3)}, marks the weakest link in each triad for deletion, subse-
quently disposing of all marked links and with them of all three-gene-loops in the network.

ARACNE’s complexity is O(N 3 + N 2M 2) with N and M being the number of nodes and
patient samples, respectively. The N 3 cube term results from the DPI ﬁlter whereas the
N 2M 2 term is due to the MI ﬁlter.

3

4.2 Machine Learning Algorithms

In order to embed the nodes in p-space, 18 topological parameters were chosen and computed
for each node i in the network. These parameters were selected as follows:

(1) degree
(2) average degree of neighbors
(3) clustering coeﬃcient
(4) PageRank score
(5) HITS Hub score/HITS Authority score
(6) farness centrality
(7) betweenness centrality
(8) average betweenness centrality of neighbors
(9-18) the i-th component of the eigenvector associated with the 2nd (smallest nonzero)
through the 11-th eigenvalue of the Laplacian matrix

After computing each of the 18 values for each of the nodes in the ARACNE network,
they were normalized to have mean zero and standard deviation one, so as to reduce cluster-
ing distortion due to scaling. As already stated, the unsupervised learning method for the
grouping of network nodes according to their topological properties in p-space was K-means
clustering. The supervised machine learning algorithms logistic regression and GDA were
used for survival outcome prediction. Softmax regression was used for cancer stage predic-
tion. The optimization of parameters of the maximum log-likelihood function for logistic
regression and softmax regression was performed with stochastic gradient ascent. The opti-
mization of parameters for GDA was carried out by ﬁnding their maximum likelihood values
analytically. The MI estimator function used for the MI feature selection ﬁlter was adapted
from a code repository.

5 Results and Findings

The network inference was completed for a subset of 100 patients using ARACNE2 in Work-
bench 2.5.1, an improved and faster version of the original ARACNE algorithm. The cor-
responding adjacency matrix was exported as an NNF ﬁle and loaded into SNAP after
appropriate conversion. The undirected network constructed by ARACNE had one giant
connected component consisting of 13284 nodes and 268685 edges with a minimal fraction
of closed triangles resulting from application of the data processing inequality (see below).
Nodes not connected to the giant component were ignored.

The K-means clustering algorithm discovered 5 prominent clusters in p-space, with 5703,
2075, 641, 124 and 4741 nodes. Each of these clusters was then subjected to MI correlation
ranking. For each cluster and for each node an MI estimate measured the correlation of the
gene/feature values with the cancer survival and cancer subtype output values, thus ranking
each node within the cluster in descending order. For each cluster, the 10, 15 and 20 nodes
with the highest MI value were used as features for machine learning. After training and
testing for each of these instances the following results for the success rates of output value

4

Survival Outcome Prediction for Cancer Patients based
on Gene Interaction Network Analysis and Expression

Proﬁle Classiﬁcation

Final Project Report
Alexander Herrmann

Advised by Dr. Andrew Gentles

December 11, 2014

Special Notice: This project is undertaken for both CS 229 and CS 224W with instructor con-
sent. Parts of the project used for CS 224W and CS 229, respectively, will be appropriately
identiﬁed.

1

Introduction

The classiﬁcation of gene expression proﬁles for diagnosis and survival outcome prediction
for cancer patients is an important yet challenging task in systems biology. Conventional
analysis of gene expression proﬁles generally succeeds in identifying distinct cancer cell types
as well as healthy tissues. However, the reliable prediction of cancer subtypes and survival
outcome parameters for patients suﬀering from the same type of cancer remains elusive
because the expression patterns for the majority of genetic markers are not suﬃciently dis-
tinct. In order to focus on the most informative marker subsets and allow subclassiﬁcation of
gene expression patterns, novel feature selection techniques for supervised machine learning
methods must be developed. This project aims to address this problem by reconstructing
a gene interaction network from steady-state gene expression proﬁles, characterizing certain
subsets of genes according to their topological properties and verifying these subsets’ utility
as feature selection ﬁlters for a variety of classiﬁcation algorithms.

2 Project Description and Related Work

For CS 229 the goal of the project was to subject a dataset of 13,334 genes and 1,106 lung
adenocarcinoma patient samples to a number of supervised machine learning algorithms, e.g.
logistic regression, softmax regression and Gaussian discriminant analysis (GDA) in order to
classify gene expression proﬁles according to cancer subtype and survival outcome. The brute
force approach was to apply each of the aforementioned learning algorithms to the entire
dataset without feature selection. A more nuanced but nonetheless conventional approach

1

was to adjust the number of features to address the tradeoﬀ between bias and variance.
Feature selection was performed by ranking genes according to the correlation between their
expression values and survival outcome parameters, and choosing those with the highest
correlation as machine learning features. For this purpose Mutual Information (MI) was
used as a correlation measure. Both brute force and conventional feature selection were
then tested and compared. The patient dataset was subdivided in a random but balanced
fashion so as to allow training and testing on independent sets. After training each of the
algorithms, test success rates for the diﬀerent approaches were quantiﬁed for each algorithm
and juxtaposed against each other.

For CS 224W, the goal was to provide a novel feature selection approach for machine
learning by taking into account the topological properties of the gene interaction network
whose states are described by the aforementioned gene expression proﬁles. One topological
feature selection approach based on PageRank has been proposed in [1]. In this approach
node j in the gene interaction network is ranked according to the following iteration recipe:

j = (1 − d)cj + d
rn

N(cid:88)

i=1

Aijrn−1

i
ki

where A is the adjacency matrix, ki the degree of node i and cj is the Pearson correlation
value of gene j with the output measured in terms of survival time. The parameter d weighs
how much inﬂuence is attributed to the Pearson correlation with the output and how much
to the topology of the network via PageRank. Before a ﬁlter is applied, the optimal value of
parameter d must be estimated. This is done by splitting the training set into two subsets
for training and testing purposes. Several trials are performed for diﬀerent values of d and
the value with the best predictive result is chosen.

However, it is not obvious why a high PageRank score should be the determining cri-
terion for feature selection as opposed to some other topological property with a diﬀerent
value range. It may therefore be worthwhile to choose a diﬀerent approach and check other
topological node properties for their utility as feature selection parameters. The ﬁrst step
in this project was to reconstruct the underlying gene interaction network with the network
inference algorithm ARACNE [2]. This method uses steady-state gene expression data to
predict direct interactions between gene pairs based on MI correlation and the data process-
ing inequality (DPI). The adjacency matrix produced by ARACNE was then processed by
SNAP to compute a set of p = 18 topological network properties for each node i. These
values were used to embed each node as a coordinate point in a p-dimensional space in a
manner similar to that in [3]. Subsequently, K-means clustering was applied to these em-
bedded points to discover prominent gene clusters in p-space. Each cluster was then used
as a gene pool for the MI feature selection ﬁlter to act upon. The performance of each pool
was measured by applying the machine learning routines to the test set and comparing the
resulting success rates with those of the brute force and the conventional feature selection
approach.

2

3 Dataset

The dataset used in this project represents an agglomeration of clinical data from diﬀerent
patient groups with lung adenocarcinoma collected over many years. With 13,334 genes and
1,106 patients this data set is rather large, given that the usual number of patients used for
machine learning algorithms in cancer biology is an order of magnitude lower. For machine
learning purposes, the dataset was randomly split into a training and a test set of 563 and
543 patients, respectively, such that age, gender and other patient parameters remained
balanced to prevent skewed results due to either of these factors.

The data is comprised of two parts. The ﬁrst part is a table of gene expression values,
in which rows correspond to genes and columns to patients. Sporadically occurring missing
values were imputed with the function knnimpute in MATLAB using the 15 nearest neigh-
boring columns as measured by Euclidean distance, a standard procedure in bioinformatics.
This adjusted dataset is the starting point for the ARACNE algorithm from which the ad-
jacency matrix is inferred. For performance reasons, ARACNE was executed with a set of
one hundred patients, the minimum admissible number for the algorithm to produce a useful
reconstruction of the gene interaction network.

The second part of the dataset consists of a ﬁle containing patient IDs as rows and
survival parameters and other clinical information as columns. There are two kinds of
survival parameters considered in this project. The ﬁrst measures the patient status as to
whether the patient is dead or alive after 5 years. The second measures the cancer subtype,
a multivalued measure assuming the values {I, II, III, IV } representing increasing severity
and aggressiveness of the cancer.

4 Network Inference Algorithm and Other Methods

4.1 Network Inference Algorithm

In ARACNE, stationary gene expression proﬁles are subjected to correlation analysis in order
to infer the probability of direct links between gene pairs. ARACNE proceeds by examining
all possible pairwise interactions and then deleting all those which do not pass through its
ﬁlters. The are two ﬁlters:
(1) Mutual information (MI) ﬁlter : MI is an information theoretic relatedness measure em-
ployed to remove all links {i, j}, for which the mutual information estimate I(gi, gj) < I0, i.e.
for which the calculated mutual information approximation falls below a certain threshold
I0 determined by the user either directly or by setting a p-value.
(2) DPI ﬁlter : In order to remove what are likely inferred but non-existent direct links,
ARACNE examines all triangles {gi, gj, gk} and, using the data processing inequality (DPI)
I(g1, g3) ≤ min{I(g1, g2), I(g2, g3)}, marks the weakest link in each triad for deletion, subse-
quently disposing of all marked links and with them of all three-gene-loops in the network.

ARACNE’s complexity is O(N 3 + N 2M 2) with N and M being the number of nodes and
patient samples, respectively. The N 3 cube term results from the DPI ﬁlter whereas the
N 2M 2 term is due to the MI ﬁlter.

3

4.2 Machine Learning Algorithms

In order to embed the nodes in p-space, 18 topological parameters were chosen and computed
for each node i in the network. These parameters were selected as follows:

(1) degree
(2) average degree of neighbors
(3) clustering coeﬃcient
(4) PageRank score
(5) HITS Hub score/HITS Authority score
(6) farness centrality
(7) betweenness centrality
(8) average betweenness centrality of neighbors
(9-18) the i-th component of the eigenvector associated with the 2nd (smallest nonzero)
through the 11-th eigenvalue of the Laplacian matrix

After computing each of the 18 values for each of the nodes in the ARACNE network,
they were normalized to have mean zero and standard deviation one, so as to reduce cluster-
ing distortion due to scaling. As already stated, the unsupervised learning method for the
grouping of network nodes according to their topological properties in p-space was K-means
clustering. The supervised machine learning algorithms logistic regression and GDA were
used for survival outcome prediction. Softmax regression was used for cancer stage predic-
tion. The optimization of parameters of the maximum log-likelihood function for logistic
regression and softmax regression was performed with stochastic gradient ascent. The opti-
mization of parameters for GDA was carried out by ﬁnding their maximum likelihood values
analytically. The MI estimator function used for the MI feature selection ﬁlter was adapted
from a code repository.

5 Results and Findings

The network inference was completed for a subset of 100 patients using ARACNE2 in Work-
bench 2.5.1, an improved and faster version of the original ARACNE algorithm. The cor-
responding adjacency matrix was exported as an NNF ﬁle and loaded into SNAP after
appropriate conversion. The undirected network constructed by ARACNE had one giant
connected component consisting of 13284 nodes and 268685 edges with a minimal fraction
of closed triangles resulting from application of the data processing inequality (see below).
Nodes not connected to the giant component were ignored.

The K-means clustering algorithm discovered 5 prominent clusters in p-space, with 5703,
2075, 641, 124 and 4741 nodes. Each of these clusters was then subjected to MI correlation
ranking. For each cluster and for each node an MI estimate measured the correlation of the
gene/feature values with the cancer survival and cancer subtype output values, thus ranking
each node within the cluster in descending order. For each cluster, the 10, 15 and 20 nodes
with the highest MI value were used as features for machine learning. After training and
testing for each of these instances the following results for the success rates of output value

4

Figure 1: Machine Learning Success Rates

prediction were obtained (see Figure 1).

While none of the clusters appears to yield a signiﬁcant improvement in success rates
over conventional MI feature selection, especially for GDA, Cluster 3 with 641 nodes seems
to be the most promising candidate for the search of predictive features/genes as it raises the
success rates of both logistic and softmax regression. For future work, it may be more instruc-
tive to try an iterative procedure and create a subgraph of the cluster yielding the largest
improvement at each step, subsequently subjecting this subgraph to the same clustering rou-
tine and discovering subclusters which may yield a further improvement still. Subdividing
clusters in this manner may be a method to identify predictive features and examine what
topological patterns they have in common.

References

[1] Winter C, Kristiansen G, Kersting S, Roy J, Aust D, et al. Google Goes Cancer: Im-
proving Outcome Prediction for Cancer Patients by Network-Based Ranking of Marker
Genes. PLoS Comput Biol 8(5) 2012: e1002511. doi:10.1371/journal.pcbi.1002511.

[2] Margolin A, et al.: ARACNE: An Algorithm for the Reconstruction of Gene Regulatory
Networks in a Mammalian Cellular Context. BMC Bioinformatics 2006, 7(Suppl 1):S7
doi:10.1186/1471-2105-7-S1-S7.

[3] Nishikawa T, Motter AE: Discovering Network Structure Beyond Communities. Sci.

Rep. 1, 151; DOI:10.1038/srep00151 (2011)

5

LR	  (Survival)GDA	  (Survival)SR	  (Cancer	  Stage)#	  of	  Features49.91%51.93%31.12%1333452.67%60.77%68.51%1052.30%60.04%64.83%1553.59%60.22%64.27%2051.19%49.36%53.59%10050.83%51.01%41.80%1000Cluster154.88%60.41%65.19%10#	  nds154.33%58.01%65.01%155703153.04%55.62%64.82%20Cluster251.20%58.20%68.51%10#	  nds254.88%57.46%67.59%152075253.96%55.80%66.67%20Cluster357.64%61.33%68.51%10#	  nds357.64%58.01%68.51%15641355.62%55.61%67.22%20Cluster452.11%58.20%68.69%10#	  nds453.59%55.80%67.96%15124448.62%53.59%68.14%20Cluster554.14%60.22%67.77%10#	  nds552.67%57.83%67.22%154741553.04%58.38%67.22%20Network	  TopologyFeature	  Selection	  MethodNo	  Feature	  SelectionMI	  Feature	  Selection
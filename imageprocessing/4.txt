Efﬁcient Brain MRI Segmentation for 3D Printing

Applications

Timothy I. Anderson

Department of Electrical Engineering

Institute for Computational and Mathematical Engineering

Stanford University
timmya@stanford.edu

Abstract—Recent advances in computing power and additive
manufacturing (3D printing) have now made possible the efﬁ-
cient simulation, optimization, and replication of patient-speciﬁc
procedures and prosthetics for neurosurgery applications. Two
very promising applications are in ﬁnite element modeling for
brain injury simulation and detection and applying additive
manufacturing towards brain analogues or in vivo brain mod-
eling. While these applications are very promising, the problem
still remains of efﬁciently segmenting imaging data for use in
ﬁnite element models or 3D printing. In this project, we put
forth a novel algorithm for brain MRI image segmentation that
combines statistically-based segmentation techniques with partial
differential equation-based methods using neuromechanical mod-
els to provide an efﬁcient algorithm for automated brain MRI
segmentation. Findings from this project show that combining
these segmentation techniques can efﬁciently segment brain MRI
at a level of accuracy required for 3D printing applications.
Speciﬁcally, we show here that combining nonlinear ﬁltering,
k-means clustering, and active contour modeling can produce
robust segmentation of brain MRI images. We anticipate that
these results will eventually lead to the ability to simulate brain
procedures and prosthetics on a patient-speciﬁc level by using
the segmented images for ﬁnite element mesh generation or
additive manufacturing processes. When used in conjunction
with existing simulation and optimization techniques,
image
segmentation technology has many far-reaching applications in
neurosurgery, and the results from this project have brought
some of these applications closer into reach.

I. INTRODUCTION AND MOTIVATION

The advent of data-driven medicine and modern computing
power has enabled patient-speciﬁc diagnosis and treatment
based on medical imaging data. However, the primary bottle-
neck in this workﬂow remains the ability to efﬁciently segment
medical imaging data for use in simulation, modeling, and
statistical analysis. Manual image segmentation for a single CT
or MRI scan is a laborious process, often requiring expensive,
specialized software and many hours of work to segment a sin-
gle image sequence. As an image processing problem, medical
image segmentation also poses many signiﬁcant challenges
due to noisy data, low contrast images, and large variations
between patients [1].

For applications in neurosurgery and neurology, advances
in ﬁnite element modeling and additive manufacturing (3D
printing) have made possible the accurate simulation and
construction of patient-speciﬁc brain models and analogues
[2]. However, generating ﬁnite element meshes or surface

models for 3D printing requires the effective segmentation
of brain MRI images. Brain MRI images are particularly
difﬁcult to segment due to the low level of contrast between
the brain tissue, surrounding tissue, and cerebrospinal ﬂuid
[1]. The goal of this project is to create an image processing
algorithm that can effectively segment brain MRI data. We
focus on segmenting for 3D printing applications—speciﬁcally
for created patient speciﬁc brain analogues—because this area
remains less developed.

II. RELATED WORK

Several methods of image segmentation have been pro-
posed, which can be roughly divided into statistical techniques
and partial differential equation-based techniques. The most
popular statistical technique is fuzzy c-means classiﬁcation,
since it can effectively segment the image into separate classes
of signal [3]. Other statistical techniques are more advanced
and computationally intensive, such as convolutional neural
networks [4, 5]. For partial differential equation methods,
there are many models based on energy minimization and
level set methods. One of the most effective partial differential
equation-based techniques is active contour models, which ﬁt
a spline with minimal energy to the image contours (shown in
Figure 1) [6, 7]. There are also many deterministic models of
edge detection based on wavelet transform or other transform
methods [8]. Wavelet-based methods work by taking the
discrete wavelet transform of the image and combining these
to ﬁnd the edges in the image, while energy minimization
methods treat the edge contour as a ﬂexible plate and seek to
minimize its energy [6, 8].

The algorithm presented here employs a novel method
of complementing iterated active contour segmentation with
nonlinear ﬁltering and then post-processing with statistical
techniques to produce an improved ﬁnal segmentation result.
While [7] has shown that active contours in conjunction
with wavelet-based edge detection can be effective for image
segmentation, little work has been done on active contours in
conjunction with nonlinear ﬁlters. The algorithm is designed
speciﬁcally for brain MRI segmentation, and exploits the
geometric properties of the brain to improve the convergence
properties.

Efﬁcient Brain MRI Segmentation for 3D Printing

Applications

Timothy I. Anderson

Department of Electrical Engineering

Institute for Computational and Mathematical Engineering

Stanford University
timmya@stanford.edu

Abstract—Recent advances in computing power and additive
manufacturing (3D printing) have now made possible the efﬁ-
cient simulation, optimization, and replication of patient-speciﬁc
procedures and prosthetics for neurosurgery applications. Two
very promising applications are in ﬁnite element modeling for
brain injury simulation and detection and applying additive
manufacturing towards brain analogues or in vivo brain mod-
eling. While these applications are very promising, the problem
still remains of efﬁciently segmenting imaging data for use in
ﬁnite element models or 3D printing. In this project, we put
forth a novel algorithm for brain MRI image segmentation that
combines statistically-based segmentation techniques with partial
differential equation-based methods using neuromechanical mod-
els to provide an efﬁcient algorithm for automated brain MRI
segmentation. Findings from this project show that combining
these segmentation techniques can efﬁciently segment brain MRI
at a level of accuracy required for 3D printing applications.
Speciﬁcally, we show here that combining nonlinear ﬁltering,
k-means clustering, and active contour modeling can produce
robust segmentation of brain MRI images. We anticipate that
these results will eventually lead to the ability to simulate brain
procedures and prosthetics on a patient-speciﬁc level by using
the segmented images for ﬁnite element mesh generation or
additive manufacturing processes. When used in conjunction
with existing simulation and optimization techniques,
image
segmentation technology has many far-reaching applications in
neurosurgery, and the results from this project have brought
some of these applications closer into reach.

I. INTRODUCTION AND MOTIVATION

The advent of data-driven medicine and modern computing
power has enabled patient-speciﬁc diagnosis and treatment
based on medical imaging data. However, the primary bottle-
neck in this workﬂow remains the ability to efﬁciently segment
medical imaging data for use in simulation, modeling, and
statistical analysis. Manual image segmentation for a single CT
or MRI scan is a laborious process, often requiring expensive,
specialized software and many hours of work to segment a sin-
gle image sequence. As an image processing problem, medical
image segmentation also poses many signiﬁcant challenges
due to noisy data, low contrast images, and large variations
between patients [1].

For applications in neurosurgery and neurology, advances
in ﬁnite element modeling and additive manufacturing (3D
printing) have made possible the accurate simulation and
construction of patient-speciﬁc brain models and analogues
[2]. However, generating ﬁnite element meshes or surface

models for 3D printing requires the effective segmentation
of brain MRI images. Brain MRI images are particularly
difﬁcult to segment due to the low level of contrast between
the brain tissue, surrounding tissue, and cerebrospinal ﬂuid
[1]. The goal of this project is to create an image processing
algorithm that can effectively segment brain MRI data. We
focus on segmenting for 3D printing applications—speciﬁcally
for created patient speciﬁc brain analogues—because this area
remains less developed.

II. RELATED WORK

Several methods of image segmentation have been pro-
posed, which can be roughly divided into statistical techniques
and partial differential equation-based techniques. The most
popular statistical technique is fuzzy c-means classiﬁcation,
since it can effectively segment the image into separate classes
of signal [3]. Other statistical techniques are more advanced
and computationally intensive, such as convolutional neural
networks [4, 5]. For partial differential equation methods,
there are many models based on energy minimization and
level set methods. One of the most effective partial differential
equation-based techniques is active contour models, which ﬁt
a spline with minimal energy to the image contours (shown in
Figure 1) [6, 7]. There are also many deterministic models of
edge detection based on wavelet transform or other transform
methods [8]. Wavelet-based methods work by taking the
discrete wavelet transform of the image and combining these
to ﬁnd the edges in the image, while energy minimization
methods treat the edge contour as a ﬂexible plate and seek to
minimize its energy [6, 8].

The algorithm presented here employs a novel method
of complementing iterated active contour segmentation with
nonlinear ﬁltering and then post-processing with statistical
techniques to produce an improved ﬁnal segmentation result.
While [7] has shown that active contours in conjunction
with wavelet-based edge detection can be effective for image
segmentation, little work has been done on active contours in
conjunction with nonlinear ﬁlters. The algorithm is designed
speciﬁcally for brain MRI segmentation, and exploits the
geometric properties of the brain to improve the convergence
properties.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

2

(cid:34)

For this project, we used the model proposed by [11]:
− ν − λ1(u0 − c1)2

= δ(φ)

µ div

∂φ
∂t

(cid:32) ∇φ

|∇φ|

(cid:33)
+λ2(u0 − c2)2(cid:1)(cid:35)

= 0

where c1, c2 are integral functions of φ, λ1 = λ2 = 1,
ν = 0, and µ controls the stiffness of the contour. The
nonlinear PDE can be discritized and solved iteratively to
converge to a local minimum (i.e. ∂φ/∂t = 0), which will
be the locally optimal active contour. This particular active
contour model was chosen because it is not dependent on a
large edge gradient. Due to the low contrast between gray
matter and cerebrospinal ﬂuid, the edges in brain MRI will
have a low gradient, so an edge-free model is ideal for brain
MRI segmentation.

B. Brain Geometry

Because the brain is a three dimensional function, we can
also treat each individual slice of the brain as a level set Γ(x, y)
of a higher dimensional function ψ(x, y, t). Take Γ(x, y)i =
{ψ(x, y, t)|t = h× i}, i ∈ Z and h ≡ step size between brain
MRI slices, and deﬁne conv(supp Γ(x, y)) ≡ convex hull of
the support of Γ(x, y). If Γ0 ≡ largest MRI slice (by cross
sectional area), we take h = 1, and there are n slices, we
have:
conv(supp Γ0) ⊆ conv(suppΓ±1) ⊆ ··· ⊆ conv(supp Γ±n)
This property (approximately) holds for all brain slices, so
we can exploit this property for efﬁciently segmenting the
brain. That is, if we manually segment Γ0, we can propagate
the convex hull of each successive slice to remove unwanted
features outside supp Γi as well as provide an accurate initial
value for the active contour segmentation, which in turn
accelerates the convergence.

C. Image Segmentation Algorithm

The proposed algorithm uses the active contour model
proposed by [11]. In this algorithm, we combine gamma
ﬁltering with iterated active contour segmentation to improve
the ﬁnal segmentation result. Additionally,
the algorithm
employs statistical
techniques to further remove unwanted
background features and morphological post-processing to
improve the 3D printing properties. The goal is to create a
robust brain MRI segmentation system by combining these
techniques. The algorithm is given below.

Manually segment thickest slice and initialize as Γ0
for All slices above and below Γ0 do

n = Sn ∗ conv(supp Γn−1)
n = (Sn ∗ conv(supp Γn−1))2.0

Segment Sn by S(cid:48)
Gamma ﬁlter: S(cid:48)
Initialize φ0 = conv(supp Γn−1)
while active contour not converged do
Propagate active contour on image S(cid:48)

n

end while

Fig. 1: Active contour models ﬁt a spline with minimal contour
energy to the image.

III. TECHNICAL APPROACH AND MATHEMATICAL

FRAMEWORK

A. Active Contour Model
There currently exist

two main neuromechanical mod-
els. The ﬁrst is based on minimizing the distance between
functionally-related neurons [9], and the other on minimizing
the folding energy of cortical tissue [10]. The former hypoth-
esis disagrees with dissection experiments, but is more in-line
with the material properties of the brain. The latter model does
not match material properties of the brain, but does agree well
with dissection experiments. Using the latter model, from [10]
we have cortical folding governed by:

Ec
1 − ν2

c

t4
c
12

d4v
ds4 + P tc

d2v
ds2 = q

This differential equation gives the energy norm:

t4
c
12

α(s) ≡ Ec
1 − ν2
β(s) ≡ P tc

c

(cid:16) dv

(cid:17)2

(cid:32)

α(s)

ds

+ β(s)

(cid:17)2(cid:33)

ds

(cid:16) d2v

ds2

(cid:90) 1

0

1
2

E =

Active contour models seek to minimize the energy norm
of the contour [6]. Since cortical folding will naturally also
seek the locally minimal energy state, there is an inherent
connection between active contours and cortical folding. Be-
cause parameterizing a contour becomes very computationally
difﬁcult due to possible topological changes in the contour as
it evolves between iterations, we instead employ a level set
approach from [6] and treat the contour as the zero level set
of higher dimension function φ:

v(s) = {(x, y)|φ(t = 0, x, y) = 0}

We can then evolve φ according to the Hamilton-Jacobi

= F|∇φ|

∂φ
∂t

There are many choices for the force F . One of the simplest

equation:

is:

(cid:33)

(cid:32) ∇φ

|∇φ|

= |∇φ|div

∂φ
∂t

Efﬁcient Brain MRI Segmentation for 3D Printing

Applications

Timothy I. Anderson

Department of Electrical Engineering

Institute for Computational and Mathematical Engineering

Stanford University
timmya@stanford.edu

Abstract—Recent advances in computing power and additive
manufacturing (3D printing) have now made possible the efﬁ-
cient simulation, optimization, and replication of patient-speciﬁc
procedures and prosthetics for neurosurgery applications. Two
very promising applications are in ﬁnite element modeling for
brain injury simulation and detection and applying additive
manufacturing towards brain analogues or in vivo brain mod-
eling. While these applications are very promising, the problem
still remains of efﬁciently segmenting imaging data for use in
ﬁnite element models or 3D printing. In this project, we put
forth a novel algorithm for brain MRI image segmentation that
combines statistically-based segmentation techniques with partial
differential equation-based methods using neuromechanical mod-
els to provide an efﬁcient algorithm for automated brain MRI
segmentation. Findings from this project show that combining
these segmentation techniques can efﬁciently segment brain MRI
at a level of accuracy required for 3D printing applications.
Speciﬁcally, we show here that combining nonlinear ﬁltering,
k-means clustering, and active contour modeling can produce
robust segmentation of brain MRI images. We anticipate that
these results will eventually lead to the ability to simulate brain
procedures and prosthetics on a patient-speciﬁc level by using
the segmented images for ﬁnite element mesh generation or
additive manufacturing processes. When used in conjunction
with existing simulation and optimization techniques,
image
segmentation technology has many far-reaching applications in
neurosurgery, and the results from this project have brought
some of these applications closer into reach.

I. INTRODUCTION AND MOTIVATION

The advent of data-driven medicine and modern computing
power has enabled patient-speciﬁc diagnosis and treatment
based on medical imaging data. However, the primary bottle-
neck in this workﬂow remains the ability to efﬁciently segment
medical imaging data for use in simulation, modeling, and
statistical analysis. Manual image segmentation for a single CT
or MRI scan is a laborious process, often requiring expensive,
specialized software and many hours of work to segment a sin-
gle image sequence. As an image processing problem, medical
image segmentation also poses many signiﬁcant challenges
due to noisy data, low contrast images, and large variations
between patients [1].

For applications in neurosurgery and neurology, advances
in ﬁnite element modeling and additive manufacturing (3D
printing) have made possible the accurate simulation and
construction of patient-speciﬁc brain models and analogues
[2]. However, generating ﬁnite element meshes or surface

models for 3D printing requires the effective segmentation
of brain MRI images. Brain MRI images are particularly
difﬁcult to segment due to the low level of contrast between
the brain tissue, surrounding tissue, and cerebrospinal ﬂuid
[1]. The goal of this project is to create an image processing
algorithm that can effectively segment brain MRI data. We
focus on segmenting for 3D printing applications—speciﬁcally
for created patient speciﬁc brain analogues—because this area
remains less developed.

II. RELATED WORK

Several methods of image segmentation have been pro-
posed, which can be roughly divided into statistical techniques
and partial differential equation-based techniques. The most
popular statistical technique is fuzzy c-means classiﬁcation,
since it can effectively segment the image into separate classes
of signal [3]. Other statistical techniques are more advanced
and computationally intensive, such as convolutional neural
networks [4, 5]. For partial differential equation methods,
there are many models based on energy minimization and
level set methods. One of the most effective partial differential
equation-based techniques is active contour models, which ﬁt
a spline with minimal energy to the image contours (shown in
Figure 1) [6, 7]. There are also many deterministic models of
edge detection based on wavelet transform or other transform
methods [8]. Wavelet-based methods work by taking the
discrete wavelet transform of the image and combining these
to ﬁnd the edges in the image, while energy minimization
methods treat the edge contour as a ﬂexible plate and seek to
minimize its energy [6, 8].

The algorithm presented here employs a novel method
of complementing iterated active contour segmentation with
nonlinear ﬁltering and then post-processing with statistical
techniques to produce an improved ﬁnal segmentation result.
While [7] has shown that active contours in conjunction
with wavelet-based edge detection can be effective for image
segmentation, little work has been done on active contours in
conjunction with nonlinear ﬁlters. The algorithm is designed
speciﬁcally for brain MRI segmentation, and exploits the
geometric properties of the brain to improve the convergence
properties.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

2

(cid:34)

For this project, we used the model proposed by [11]:
− ν − λ1(u0 − c1)2

= δ(φ)

µ div

∂φ
∂t

(cid:32) ∇φ

|∇φ|

(cid:33)
+λ2(u0 − c2)2(cid:1)(cid:35)

= 0

where c1, c2 are integral functions of φ, λ1 = λ2 = 1,
ν = 0, and µ controls the stiffness of the contour. The
nonlinear PDE can be discritized and solved iteratively to
converge to a local minimum (i.e. ∂φ/∂t = 0), which will
be the locally optimal active contour. This particular active
contour model was chosen because it is not dependent on a
large edge gradient. Due to the low contrast between gray
matter and cerebrospinal ﬂuid, the edges in brain MRI will
have a low gradient, so an edge-free model is ideal for brain
MRI segmentation.

B. Brain Geometry

Because the brain is a three dimensional function, we can
also treat each individual slice of the brain as a level set Γ(x, y)
of a higher dimensional function ψ(x, y, t). Take Γ(x, y)i =
{ψ(x, y, t)|t = h× i}, i ∈ Z and h ≡ step size between brain
MRI slices, and deﬁne conv(supp Γ(x, y)) ≡ convex hull of
the support of Γ(x, y). If Γ0 ≡ largest MRI slice (by cross
sectional area), we take h = 1, and there are n slices, we
have:
conv(supp Γ0) ⊆ conv(suppΓ±1) ⊆ ··· ⊆ conv(supp Γ±n)
This property (approximately) holds for all brain slices, so
we can exploit this property for efﬁciently segmenting the
brain. That is, if we manually segment Γ0, we can propagate
the convex hull of each successive slice to remove unwanted
features outside supp Γi as well as provide an accurate initial
value for the active contour segmentation, which in turn
accelerates the convergence.

C. Image Segmentation Algorithm

The proposed algorithm uses the active contour model
proposed by [11]. In this algorithm, we combine gamma
ﬁltering with iterated active contour segmentation to improve
the ﬁnal segmentation result. Additionally,
the algorithm
employs statistical
techniques to further remove unwanted
background features and morphological post-processing to
improve the 3D printing properties. The goal is to create a
robust brain MRI segmentation system by combining these
techniques. The algorithm is given below.

Manually segment thickest slice and initialize as Γ0
for All slices above and below Γ0 do

n = Sn ∗ conv(supp Γn−1)
n = (Sn ∗ conv(supp Γn−1))2.0

Segment Sn by S(cid:48)
Gamma ﬁlter: S(cid:48)
Initialize φ0 = conv(supp Γn−1)
while active contour not converged do
Propagate active contour on image S(cid:48)

n

end while

Fig. 1: Active contour models ﬁt a spline with minimal contour
energy to the image.

III. TECHNICAL APPROACH AND MATHEMATICAL

FRAMEWORK

A. Active Contour Model
There currently exist

two main neuromechanical mod-
els. The ﬁrst is based on minimizing the distance between
functionally-related neurons [9], and the other on minimizing
the folding energy of cortical tissue [10]. The former hypoth-
esis disagrees with dissection experiments, but is more in-line
with the material properties of the brain. The latter model does
not match material properties of the brain, but does agree well
with dissection experiments. Using the latter model, from [10]
we have cortical folding governed by:

Ec
1 − ν2

c

t4
c
12

d4v
ds4 + P tc

d2v
ds2 = q

This differential equation gives the energy norm:

t4
c
12

α(s) ≡ Ec
1 − ν2
β(s) ≡ P tc

c

(cid:16) dv

(cid:17)2

(cid:32)

α(s)

ds

+ β(s)

(cid:17)2(cid:33)

ds

(cid:16) d2v

ds2

(cid:90) 1

0

1
2

E =

Active contour models seek to minimize the energy norm
of the contour [6]. Since cortical folding will naturally also
seek the locally minimal energy state, there is an inherent
connection between active contours and cortical folding. Be-
cause parameterizing a contour becomes very computationally
difﬁcult due to possible topological changes in the contour as
it evolves between iterations, we instead employ a level set
approach from [6] and treat the contour as the zero level set
of higher dimension function φ:

v(s) = {(x, y)|φ(t = 0, x, y) = 0}

We can then evolve φ according to the Hamilton-Jacobi

= F|∇φ|

∂φ
∂t

There are many choices for the force F . One of the simplest

equation:

is:

(cid:33)

(cid:32) ∇φ

|∇φ|

= |∇φ|div

∂φ
∂t

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

3

n = (Sn ∗ conv(supp Γn−1))1.5
S(cid:48)
Initialize φ(cid:48)
Repeat active contour iteration
Perform k-means clustering with k = 4
Record minimum centroid

0 = φconverged

end for
kavg = average lowest centroid of k-means data
Threshold each slice by kavg
Morphological post processing on segmented slices

IV. EXPERIMENTAL RESULTS

A. Algorithm and Evaluation of System Parameters

After manually segmenting the initial slice, ﬁrst step in
segmenting an intermediate slice is to load the MRI image
from the image sequence. The MRI sequence contains 120
images, and the voxel size was 1mm3.

Original slice image

We can roughly segment the raw MRI image using the
convex hull of the mask from the previous slice. Because the
support of each successive slice is a subset of the previous
slice, we can use this property to efﬁciently remove the skull
from the image.

ﬁnal contour will converge to a contour which does not
contain the dura mater or other unwanted material. We found
experimentally that γ = 2.0 produced good results for this
step, however any γ value that sufﬁciently suppresses the dura
mater and gray matter would be valid.

Gamma Filter 1 (γ = 2.0)

Active Contour Segmentation 1

For the second active contour segmentation, we apply a
gamma ﬁlter with a more moderate value (γ = 1.5 in this
case), then segment with the same active contour algorithm,
using the contour found in the previous step as the initial guess.
The active contour converges to a locally minimal energy
value, so the purpose of the ﬁrst active contour segmentation
is to ﬁnd an initial guess for the second segmentation that
will converge to the correct contour. Were we to use the
convex hull of the previous slice as the initial guess, unwanted
features such as the dura mater would be included in the
ﬁnal segmentation, and features such as separation between
brain folds would be lost. For this step, we use a more
ﬂexible active contour than in the previous step i.e. do not
penalize curvature as strongly in the contour optimization.
From a neuromechanical standpoint, a more ﬂexible contour
when segmenting the gray matter is justiﬁed due to the lower
stiffness of gray matter relative to white matter and prevalent
folds in the brain structure.

Gamma Filter 2 (γ = 1.5)

Active Contour Segmentation 2

Initial Mask

Initial Segmentation

The active contour segmentation occurs in two steps. First,
we apply a gamma ﬁlter with γ large to make the white
matter dominant in the image. Then, we use the active contour
algorithm from [11] (using the implementation in [12]) to
segment the image using the gamma ﬁlter. The purpose of
this step is to segment primarily the white matter, so the

After segmenting each slice, we perform k-means clustering
on the histogram of the image using k = 4. For each slice, the
lowest centroid was recorded. The minimum centroids were
then averaged to ﬁnd an average value for the background
throughout
the entire image sequence. Using this average
value, the segmented slices were thresholded to produce to
the ﬁnal binary mask.

Efﬁcient Brain MRI Segmentation for 3D Printing

Applications

Timothy I. Anderson

Department of Electrical Engineering

Institute for Computational and Mathematical Engineering

Stanford University
timmya@stanford.edu

Abstract—Recent advances in computing power and additive
manufacturing (3D printing) have now made possible the efﬁ-
cient simulation, optimization, and replication of patient-speciﬁc
procedures and prosthetics for neurosurgery applications. Two
very promising applications are in ﬁnite element modeling for
brain injury simulation and detection and applying additive
manufacturing towards brain analogues or in vivo brain mod-
eling. While these applications are very promising, the problem
still remains of efﬁciently segmenting imaging data for use in
ﬁnite element models or 3D printing. In this project, we put
forth a novel algorithm for brain MRI image segmentation that
combines statistically-based segmentation techniques with partial
differential equation-based methods using neuromechanical mod-
els to provide an efﬁcient algorithm for automated brain MRI
segmentation. Findings from this project show that combining
these segmentation techniques can efﬁciently segment brain MRI
at a level of accuracy required for 3D printing applications.
Speciﬁcally, we show here that combining nonlinear ﬁltering,
k-means clustering, and active contour modeling can produce
robust segmentation of brain MRI images. We anticipate that
these results will eventually lead to the ability to simulate brain
procedures and prosthetics on a patient-speciﬁc level by using
the segmented images for ﬁnite element mesh generation or
additive manufacturing processes. When used in conjunction
with existing simulation and optimization techniques,
image
segmentation technology has many far-reaching applications in
neurosurgery, and the results from this project have brought
some of these applications closer into reach.

I. INTRODUCTION AND MOTIVATION

The advent of data-driven medicine and modern computing
power has enabled patient-speciﬁc diagnosis and treatment
based on medical imaging data. However, the primary bottle-
neck in this workﬂow remains the ability to efﬁciently segment
medical imaging data for use in simulation, modeling, and
statistical analysis. Manual image segmentation for a single CT
or MRI scan is a laborious process, often requiring expensive,
specialized software and many hours of work to segment a sin-
gle image sequence. As an image processing problem, medical
image segmentation also poses many signiﬁcant challenges
due to noisy data, low contrast images, and large variations
between patients [1].

For applications in neurosurgery and neurology, advances
in ﬁnite element modeling and additive manufacturing (3D
printing) have made possible the accurate simulation and
construction of patient-speciﬁc brain models and analogues
[2]. However, generating ﬁnite element meshes or surface

models for 3D printing requires the effective segmentation
of brain MRI images. Brain MRI images are particularly
difﬁcult to segment due to the low level of contrast between
the brain tissue, surrounding tissue, and cerebrospinal ﬂuid
[1]. The goal of this project is to create an image processing
algorithm that can effectively segment brain MRI data. We
focus on segmenting for 3D printing applications—speciﬁcally
for created patient speciﬁc brain analogues—because this area
remains less developed.

II. RELATED WORK

Several methods of image segmentation have been pro-
posed, which can be roughly divided into statistical techniques
and partial differential equation-based techniques. The most
popular statistical technique is fuzzy c-means classiﬁcation,
since it can effectively segment the image into separate classes
of signal [3]. Other statistical techniques are more advanced
and computationally intensive, such as convolutional neural
networks [4, 5]. For partial differential equation methods,
there are many models based on energy minimization and
level set methods. One of the most effective partial differential
equation-based techniques is active contour models, which ﬁt
a spline with minimal energy to the image contours (shown in
Figure 1) [6, 7]. There are also many deterministic models of
edge detection based on wavelet transform or other transform
methods [8]. Wavelet-based methods work by taking the
discrete wavelet transform of the image and combining these
to ﬁnd the edges in the image, while energy minimization
methods treat the edge contour as a ﬂexible plate and seek to
minimize its energy [6, 8].

The algorithm presented here employs a novel method
of complementing iterated active contour segmentation with
nonlinear ﬁltering and then post-processing with statistical
techniques to produce an improved ﬁnal segmentation result.
While [7] has shown that active contours in conjunction
with wavelet-based edge detection can be effective for image
segmentation, little work has been done on active contours in
conjunction with nonlinear ﬁlters. The algorithm is designed
speciﬁcally for brain MRI segmentation, and exploits the
geometric properties of the brain to improve the convergence
properties.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

2

(cid:34)

For this project, we used the model proposed by [11]:
− ν − λ1(u0 − c1)2

= δ(φ)

µ div

∂φ
∂t

(cid:32) ∇φ

|∇φ|

(cid:33)
+λ2(u0 − c2)2(cid:1)(cid:35)

= 0

where c1, c2 are integral functions of φ, λ1 = λ2 = 1,
ν = 0, and µ controls the stiffness of the contour. The
nonlinear PDE can be discritized and solved iteratively to
converge to a local minimum (i.e. ∂φ/∂t = 0), which will
be the locally optimal active contour. This particular active
contour model was chosen because it is not dependent on a
large edge gradient. Due to the low contrast between gray
matter and cerebrospinal ﬂuid, the edges in brain MRI will
have a low gradient, so an edge-free model is ideal for brain
MRI segmentation.

B. Brain Geometry

Because the brain is a three dimensional function, we can
also treat each individual slice of the brain as a level set Γ(x, y)
of a higher dimensional function ψ(x, y, t). Take Γ(x, y)i =
{ψ(x, y, t)|t = h× i}, i ∈ Z and h ≡ step size between brain
MRI slices, and deﬁne conv(supp Γ(x, y)) ≡ convex hull of
the support of Γ(x, y). If Γ0 ≡ largest MRI slice (by cross
sectional area), we take h = 1, and there are n slices, we
have:
conv(supp Γ0) ⊆ conv(suppΓ±1) ⊆ ··· ⊆ conv(supp Γ±n)
This property (approximately) holds for all brain slices, so
we can exploit this property for efﬁciently segmenting the
brain. That is, if we manually segment Γ0, we can propagate
the convex hull of each successive slice to remove unwanted
features outside supp Γi as well as provide an accurate initial
value for the active contour segmentation, which in turn
accelerates the convergence.

C. Image Segmentation Algorithm

The proposed algorithm uses the active contour model
proposed by [11]. In this algorithm, we combine gamma
ﬁltering with iterated active contour segmentation to improve
the ﬁnal segmentation result. Additionally,
the algorithm
employs statistical
techniques to further remove unwanted
background features and morphological post-processing to
improve the 3D printing properties. The goal is to create a
robust brain MRI segmentation system by combining these
techniques. The algorithm is given below.

Manually segment thickest slice and initialize as Γ0
for All slices above and below Γ0 do

n = Sn ∗ conv(supp Γn−1)
n = (Sn ∗ conv(supp Γn−1))2.0

Segment Sn by S(cid:48)
Gamma ﬁlter: S(cid:48)
Initialize φ0 = conv(supp Γn−1)
while active contour not converged do
Propagate active contour on image S(cid:48)

n

end while

Fig. 1: Active contour models ﬁt a spline with minimal contour
energy to the image.

III. TECHNICAL APPROACH AND MATHEMATICAL

FRAMEWORK

A. Active Contour Model
There currently exist

two main neuromechanical mod-
els. The ﬁrst is based on minimizing the distance between
functionally-related neurons [9], and the other on minimizing
the folding energy of cortical tissue [10]. The former hypoth-
esis disagrees with dissection experiments, but is more in-line
with the material properties of the brain. The latter model does
not match material properties of the brain, but does agree well
with dissection experiments. Using the latter model, from [10]
we have cortical folding governed by:

Ec
1 − ν2

c

t4
c
12

d4v
ds4 + P tc

d2v
ds2 = q

This differential equation gives the energy norm:

t4
c
12

α(s) ≡ Ec
1 − ν2
β(s) ≡ P tc

c

(cid:16) dv

(cid:17)2

(cid:32)

α(s)

ds

+ β(s)

(cid:17)2(cid:33)

ds

(cid:16) d2v

ds2

(cid:90) 1

0

1
2

E =

Active contour models seek to minimize the energy norm
of the contour [6]. Since cortical folding will naturally also
seek the locally minimal energy state, there is an inherent
connection between active contours and cortical folding. Be-
cause parameterizing a contour becomes very computationally
difﬁcult due to possible topological changes in the contour as
it evolves between iterations, we instead employ a level set
approach from [6] and treat the contour as the zero level set
of higher dimension function φ:

v(s) = {(x, y)|φ(t = 0, x, y) = 0}

We can then evolve φ according to the Hamilton-Jacobi

= F|∇φ|

∂φ
∂t

There are many choices for the force F . One of the simplest

equation:

is:

(cid:33)

(cid:32) ∇φ

|∇φ|

= |∇φ|div

∂φ
∂t

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

3

n = (Sn ∗ conv(supp Γn−1))1.5
S(cid:48)
Initialize φ(cid:48)
Repeat active contour iteration
Perform k-means clustering with k = 4
Record minimum centroid

0 = φconverged

end for
kavg = average lowest centroid of k-means data
Threshold each slice by kavg
Morphological post processing on segmented slices

IV. EXPERIMENTAL RESULTS

A. Algorithm and Evaluation of System Parameters

After manually segmenting the initial slice, ﬁrst step in
segmenting an intermediate slice is to load the MRI image
from the image sequence. The MRI sequence contains 120
images, and the voxel size was 1mm3.

Original slice image

We can roughly segment the raw MRI image using the
convex hull of the mask from the previous slice. Because the
support of each successive slice is a subset of the previous
slice, we can use this property to efﬁciently remove the skull
from the image.

ﬁnal contour will converge to a contour which does not
contain the dura mater or other unwanted material. We found
experimentally that γ = 2.0 produced good results for this
step, however any γ value that sufﬁciently suppresses the dura
mater and gray matter would be valid.

Gamma Filter 1 (γ = 2.0)

Active Contour Segmentation 1

For the second active contour segmentation, we apply a
gamma ﬁlter with a more moderate value (γ = 1.5 in this
case), then segment with the same active contour algorithm,
using the contour found in the previous step as the initial guess.
The active contour converges to a locally minimal energy
value, so the purpose of the ﬁrst active contour segmentation
is to ﬁnd an initial guess for the second segmentation that
will converge to the correct contour. Were we to use the
convex hull of the previous slice as the initial guess, unwanted
features such as the dura mater would be included in the
ﬁnal segmentation, and features such as separation between
brain folds would be lost. For this step, we use a more
ﬂexible active contour than in the previous step i.e. do not
penalize curvature as strongly in the contour optimization.
From a neuromechanical standpoint, a more ﬂexible contour
when segmenting the gray matter is justiﬁed due to the lower
stiffness of gray matter relative to white matter and prevalent
folds in the brain structure.

Gamma Filter 2 (γ = 1.5)

Active Contour Segmentation 2

Initial Mask

Initial Segmentation

The active contour segmentation occurs in two steps. First,
we apply a gamma ﬁlter with γ large to make the white
matter dominant in the image. Then, we use the active contour
algorithm from [11] (using the implementation in [12]) to
segment the image using the gamma ﬁlter. The purpose of
this step is to segment primarily the white matter, so the

After segmenting each slice, we perform k-means clustering
on the histogram of the image using k = 4. For each slice, the
lowest centroid was recorded. The minimum centroids were
then averaged to ﬁnd an average value for the background
throughout
the entire image sequence. Using this average
value, the segmented slices were thresholded to produce to
the ﬁnal binary mask.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

4

B. Comparison to Other Approaches

Compared to manual segmentation, the given algorithm is
signiﬁcantly faster. Manual segmentation takes about 1-2 days
of work on average, whereas this algorithm segmented the
test sequence in 519 sec. (after manual segmentation of the
initialization slice). The presented algorithm is very promising
since its runtime is fast enough to be effective for clini-
cal applications. The given segmentation algorithm also out-
performed several existing image processing techniques. For
example, ﬁgure 2 shows that the segmentation performance is
worse with simple adaptive thresholding.

Image segmented with algorithm
presented in this project.

Plain adaptive thresholding via
Otsu’s algorithm.

Fig. 2: Comparison of presented algorithm with adaptive
thresholding.

Additionally, using an edge-dependent active contour model
(i.e. a model which includes a stopping function in the
Hamiltonian) does not perform as well as the given algorithm.
As shown by ﬁgure 3, the given algorithm is much more
effective at preserving the structure of the brain slice and
removing artifacts and spurious regions from thresholding.
Edge-based active contour models work well where there are
sharply delineated edges in an image. However, since the
attenuation coefﬁcient for cerebrospinal ﬂuid, white matter,
and gray matter are similar, there brain MRI does not have
clearly delineated edges, so an edge-based active contour will
perform poorly.

Histogram after segmentation, with k-means centroids

Final segmented image

For 3D printing applications, we do post-processing on the
segmented masks to remove artifacts from the thresholding.
Speciﬁcally, we erode then dilate the mask. Very small or thin
regions are usually artifacts and can potentially cause issues
when replicating the brain sample via 3D printing since they
are usually below the accuracy threshold of most commercially
available printers.

Mask before post-processing

Mask after post-processing

Image segmented with algorithm
developed in this project.

Image
segmented with
dependent active contour.

edge-

Fig. 3: Comparison between presented algorithm and similar
algorithm with edge-dependent active contour.

Efﬁcient Brain MRI Segmentation for 3D Printing

Applications

Timothy I. Anderson

Department of Electrical Engineering

Institute for Computational and Mathematical Engineering

Stanford University
timmya@stanford.edu

Abstract—Recent advances in computing power and additive
manufacturing (3D printing) have now made possible the efﬁ-
cient simulation, optimization, and replication of patient-speciﬁc
procedures and prosthetics for neurosurgery applications. Two
very promising applications are in ﬁnite element modeling for
brain injury simulation and detection and applying additive
manufacturing towards brain analogues or in vivo brain mod-
eling. While these applications are very promising, the problem
still remains of efﬁciently segmenting imaging data for use in
ﬁnite element models or 3D printing. In this project, we put
forth a novel algorithm for brain MRI image segmentation that
combines statistically-based segmentation techniques with partial
differential equation-based methods using neuromechanical mod-
els to provide an efﬁcient algorithm for automated brain MRI
segmentation. Findings from this project show that combining
these segmentation techniques can efﬁciently segment brain MRI
at a level of accuracy required for 3D printing applications.
Speciﬁcally, we show here that combining nonlinear ﬁltering,
k-means clustering, and active contour modeling can produce
robust segmentation of brain MRI images. We anticipate that
these results will eventually lead to the ability to simulate brain
procedures and prosthetics on a patient-speciﬁc level by using
the segmented images for ﬁnite element mesh generation or
additive manufacturing processes. When used in conjunction
with existing simulation and optimization techniques,
image
segmentation technology has many far-reaching applications in
neurosurgery, and the results from this project have brought
some of these applications closer into reach.

I. INTRODUCTION AND MOTIVATION

The advent of data-driven medicine and modern computing
power has enabled patient-speciﬁc diagnosis and treatment
based on medical imaging data. However, the primary bottle-
neck in this workﬂow remains the ability to efﬁciently segment
medical imaging data for use in simulation, modeling, and
statistical analysis. Manual image segmentation for a single CT
or MRI scan is a laborious process, often requiring expensive,
specialized software and many hours of work to segment a sin-
gle image sequence. As an image processing problem, medical
image segmentation also poses many signiﬁcant challenges
due to noisy data, low contrast images, and large variations
between patients [1].

For applications in neurosurgery and neurology, advances
in ﬁnite element modeling and additive manufacturing (3D
printing) have made possible the accurate simulation and
construction of patient-speciﬁc brain models and analogues
[2]. However, generating ﬁnite element meshes or surface

models for 3D printing requires the effective segmentation
of brain MRI images. Brain MRI images are particularly
difﬁcult to segment due to the low level of contrast between
the brain tissue, surrounding tissue, and cerebrospinal ﬂuid
[1]. The goal of this project is to create an image processing
algorithm that can effectively segment brain MRI data. We
focus on segmenting for 3D printing applications—speciﬁcally
for created patient speciﬁc brain analogues—because this area
remains less developed.

II. RELATED WORK

Several methods of image segmentation have been pro-
posed, which can be roughly divided into statistical techniques
and partial differential equation-based techniques. The most
popular statistical technique is fuzzy c-means classiﬁcation,
since it can effectively segment the image into separate classes
of signal [3]. Other statistical techniques are more advanced
and computationally intensive, such as convolutional neural
networks [4, 5]. For partial differential equation methods,
there are many models based on energy minimization and
level set methods. One of the most effective partial differential
equation-based techniques is active contour models, which ﬁt
a spline with minimal energy to the image contours (shown in
Figure 1) [6, 7]. There are also many deterministic models of
edge detection based on wavelet transform or other transform
methods [8]. Wavelet-based methods work by taking the
discrete wavelet transform of the image and combining these
to ﬁnd the edges in the image, while energy minimization
methods treat the edge contour as a ﬂexible plate and seek to
minimize its energy [6, 8].

The algorithm presented here employs a novel method
of complementing iterated active contour segmentation with
nonlinear ﬁltering and then post-processing with statistical
techniques to produce an improved ﬁnal segmentation result.
While [7] has shown that active contours in conjunction
with wavelet-based edge detection can be effective for image
segmentation, little work has been done on active contours in
conjunction with nonlinear ﬁlters. The algorithm is designed
speciﬁcally for brain MRI segmentation, and exploits the
geometric properties of the brain to improve the convergence
properties.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

2

(cid:34)

For this project, we used the model proposed by [11]:
− ν − λ1(u0 − c1)2

= δ(φ)

µ div

∂φ
∂t

(cid:32) ∇φ

|∇φ|

(cid:33)
+λ2(u0 − c2)2(cid:1)(cid:35)

= 0

where c1, c2 are integral functions of φ, λ1 = λ2 = 1,
ν = 0, and µ controls the stiffness of the contour. The
nonlinear PDE can be discritized and solved iteratively to
converge to a local minimum (i.e. ∂φ/∂t = 0), which will
be the locally optimal active contour. This particular active
contour model was chosen because it is not dependent on a
large edge gradient. Due to the low contrast between gray
matter and cerebrospinal ﬂuid, the edges in brain MRI will
have a low gradient, so an edge-free model is ideal for brain
MRI segmentation.

B. Brain Geometry

Because the brain is a three dimensional function, we can
also treat each individual slice of the brain as a level set Γ(x, y)
of a higher dimensional function ψ(x, y, t). Take Γ(x, y)i =
{ψ(x, y, t)|t = h× i}, i ∈ Z and h ≡ step size between brain
MRI slices, and deﬁne conv(supp Γ(x, y)) ≡ convex hull of
the support of Γ(x, y). If Γ0 ≡ largest MRI slice (by cross
sectional area), we take h = 1, and there are n slices, we
have:
conv(supp Γ0) ⊆ conv(suppΓ±1) ⊆ ··· ⊆ conv(supp Γ±n)
This property (approximately) holds for all brain slices, so
we can exploit this property for efﬁciently segmenting the
brain. That is, if we manually segment Γ0, we can propagate
the convex hull of each successive slice to remove unwanted
features outside supp Γi as well as provide an accurate initial
value for the active contour segmentation, which in turn
accelerates the convergence.

C. Image Segmentation Algorithm

The proposed algorithm uses the active contour model
proposed by [11]. In this algorithm, we combine gamma
ﬁltering with iterated active contour segmentation to improve
the ﬁnal segmentation result. Additionally,
the algorithm
employs statistical
techniques to further remove unwanted
background features and morphological post-processing to
improve the 3D printing properties. The goal is to create a
robust brain MRI segmentation system by combining these
techniques. The algorithm is given below.

Manually segment thickest slice and initialize as Γ0
for All slices above and below Γ0 do

n = Sn ∗ conv(supp Γn−1)
n = (Sn ∗ conv(supp Γn−1))2.0

Segment Sn by S(cid:48)
Gamma ﬁlter: S(cid:48)
Initialize φ0 = conv(supp Γn−1)
while active contour not converged do
Propagate active contour on image S(cid:48)

n

end while

Fig. 1: Active contour models ﬁt a spline with minimal contour
energy to the image.

III. TECHNICAL APPROACH AND MATHEMATICAL

FRAMEWORK

A. Active Contour Model
There currently exist

two main neuromechanical mod-
els. The ﬁrst is based on minimizing the distance between
functionally-related neurons [9], and the other on minimizing
the folding energy of cortical tissue [10]. The former hypoth-
esis disagrees with dissection experiments, but is more in-line
with the material properties of the brain. The latter model does
not match material properties of the brain, but does agree well
with dissection experiments. Using the latter model, from [10]
we have cortical folding governed by:

Ec
1 − ν2

c

t4
c
12

d4v
ds4 + P tc

d2v
ds2 = q

This differential equation gives the energy norm:

t4
c
12

α(s) ≡ Ec
1 − ν2
β(s) ≡ P tc

c

(cid:16) dv

(cid:17)2

(cid:32)

α(s)

ds

+ β(s)

(cid:17)2(cid:33)

ds

(cid:16) d2v

ds2

(cid:90) 1

0

1
2

E =

Active contour models seek to minimize the energy norm
of the contour [6]. Since cortical folding will naturally also
seek the locally minimal energy state, there is an inherent
connection between active contours and cortical folding. Be-
cause parameterizing a contour becomes very computationally
difﬁcult due to possible topological changes in the contour as
it evolves between iterations, we instead employ a level set
approach from [6] and treat the contour as the zero level set
of higher dimension function φ:

v(s) = {(x, y)|φ(t = 0, x, y) = 0}

We can then evolve φ according to the Hamilton-Jacobi

= F|∇φ|

∂φ
∂t

There are many choices for the force F . One of the simplest

equation:

is:

(cid:33)

(cid:32) ∇φ

|∇φ|

= |∇φ|div

∂φ
∂t

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

3

n = (Sn ∗ conv(supp Γn−1))1.5
S(cid:48)
Initialize φ(cid:48)
Repeat active contour iteration
Perform k-means clustering with k = 4
Record minimum centroid

0 = φconverged

end for
kavg = average lowest centroid of k-means data
Threshold each slice by kavg
Morphological post processing on segmented slices

IV. EXPERIMENTAL RESULTS

A. Algorithm and Evaluation of System Parameters

After manually segmenting the initial slice, ﬁrst step in
segmenting an intermediate slice is to load the MRI image
from the image sequence. The MRI sequence contains 120
images, and the voxel size was 1mm3.

Original slice image

We can roughly segment the raw MRI image using the
convex hull of the mask from the previous slice. Because the
support of each successive slice is a subset of the previous
slice, we can use this property to efﬁciently remove the skull
from the image.

ﬁnal contour will converge to a contour which does not
contain the dura mater or other unwanted material. We found
experimentally that γ = 2.0 produced good results for this
step, however any γ value that sufﬁciently suppresses the dura
mater and gray matter would be valid.

Gamma Filter 1 (γ = 2.0)

Active Contour Segmentation 1

For the second active contour segmentation, we apply a
gamma ﬁlter with a more moderate value (γ = 1.5 in this
case), then segment with the same active contour algorithm,
using the contour found in the previous step as the initial guess.
The active contour converges to a locally minimal energy
value, so the purpose of the ﬁrst active contour segmentation
is to ﬁnd an initial guess for the second segmentation that
will converge to the correct contour. Were we to use the
convex hull of the previous slice as the initial guess, unwanted
features such as the dura mater would be included in the
ﬁnal segmentation, and features such as separation between
brain folds would be lost. For this step, we use a more
ﬂexible active contour than in the previous step i.e. do not
penalize curvature as strongly in the contour optimization.
From a neuromechanical standpoint, a more ﬂexible contour
when segmenting the gray matter is justiﬁed due to the lower
stiffness of gray matter relative to white matter and prevalent
folds in the brain structure.

Gamma Filter 2 (γ = 1.5)

Active Contour Segmentation 2

Initial Mask

Initial Segmentation

The active contour segmentation occurs in two steps. First,
we apply a gamma ﬁlter with γ large to make the white
matter dominant in the image. Then, we use the active contour
algorithm from [11] (using the implementation in [12]) to
segment the image using the gamma ﬁlter. The purpose of
this step is to segment primarily the white matter, so the

After segmenting each slice, we perform k-means clustering
on the histogram of the image using k = 4. For each slice, the
lowest centroid was recorded. The minimum centroids were
then averaged to ﬁnd an average value for the background
throughout
the entire image sequence. Using this average
value, the segmented slices were thresholded to produce to
the ﬁnal binary mask.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

4

B. Comparison to Other Approaches

Compared to manual segmentation, the given algorithm is
signiﬁcantly faster. Manual segmentation takes about 1-2 days
of work on average, whereas this algorithm segmented the
test sequence in 519 sec. (after manual segmentation of the
initialization slice). The presented algorithm is very promising
since its runtime is fast enough to be effective for clini-
cal applications. The given segmentation algorithm also out-
performed several existing image processing techniques. For
example, ﬁgure 2 shows that the segmentation performance is
worse with simple adaptive thresholding.

Image segmented with algorithm
presented in this project.

Plain adaptive thresholding via
Otsu’s algorithm.

Fig. 2: Comparison of presented algorithm with adaptive
thresholding.

Additionally, using an edge-dependent active contour model
(i.e. a model which includes a stopping function in the
Hamiltonian) does not perform as well as the given algorithm.
As shown by ﬁgure 3, the given algorithm is much more
effective at preserving the structure of the brain slice and
removing artifacts and spurious regions from thresholding.
Edge-based active contour models work well where there are
sharply delineated edges in an image. However, since the
attenuation coefﬁcient for cerebrospinal ﬂuid, white matter,
and gray matter are similar, there brain MRI does not have
clearly delineated edges, so an edge-based active contour will
perform poorly.

Histogram after segmentation, with k-means centroids

Final segmented image

For 3D printing applications, we do post-processing on the
segmented masks to remove artifacts from the thresholding.
Speciﬁcally, we erode then dilate the mask. Very small or thin
regions are usually artifacts and can potentially cause issues
when replicating the brain sample via 3D printing since they
are usually below the accuracy threshold of most commercially
available printers.

Mask before post-processing

Mask after post-processing

Image segmented with algorithm
developed in this project.

Image
segmented with
dependent active contour.

edge-

Fig. 3: Comparison between presented algorithm and similar
algorithm with edge-dependent active contour.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

5

Fig. 4: Plot showing 1-norm of error with respect to distance
from reference slice. Plot shows that forward propagation error
grows very little, while backward propagation error grows
signiﬁcantly.

Fig. 5: Surface model generated via marching cubes method
[13] using images segmented with the presented algorithm.

Overall, the presented image processing algorithm is sig-
niﬁcantly more effective than other similar methods or the
substituent parts of the algorithm. While statistically-based
algorithms may have better performance [4], the presented
algorithm is fast, effective, and requires no training set or prior
knowledge on the image other than manual segmentation of
the thickest slice by cross-sectional area.

V. DISCUSSION

The process images show that

the algorithm is able to
successfully segment brain MRI images. The gamma ﬁltering
also signiﬁcantly increased the performance of the active
contour algorithm. This can be attributed to the nonlinearity of
the gamma ﬁlter increasing the gradient of the edges, which

Fig. 6: Model printed via fused deposition modeling (FDM).

in turn aided the convergence of the active contour. Using k-
means clustering to ﬁnd a suitable threshold for binarizing the
image in the ﬁnal step also yielded physically accurate results.
To quantitatively measure the error from segmentation, we
ﬁrst manually segmented and binarized a subset of the original
brain MRI images. To evaluate the error, we used the 1-norm
of the difference between the two images to measure the num-
ber of pixels that differed between the manual and automated
segmentation. That is, Error = ||IM anual − IAutomated||1,
where I represents the vectorized image.

Figure 4 shows the results of the error analysis. Here,
we deﬁne ”forward propagation” as segmenting slices that
come after the reference slice in the MRI image sequence,
and ”backward propagation” as segmenting slices before the
reference slice. The error plot shows that the errors remain
relatively small for the forward propagation. This is most likely
due to the well-behaved geometry of the slices segmented in
the forward propagation. The error for the backwards propaga-
tion was much larger, which we attribute to two factors. First,
our assumption of the brain region being compactly supported
breaks down in the last slices containing the relevant brain
structure e.g. in the slices containing only the temporal lobes.
Secondly, in these lower slices, there are many different kinds
of tissue we do not wish to segment, such as the eyes and
cerebellum. These tissues were removed during the manual
segmentation, but our geometric model for the brain would not
have removed these during the initial segmentation, causing
signiﬁcant errors in the ﬁnal segmentation result.

For 3D printing applications, we were able to successfully
render the segmented slices into a surface model (Figure 5)
using the marching cubes method and then convert this to an
STL ﬁle using [13]. The surface model was then printed using
fused deposition modeling (FDM) (Figure 6). The printing
results show that
the morphological post-processing (edge
smoothing and small region removal) improved the quality of
the surface model and reduced structural errors while printing.
While there are some regions of the model where details are
lost, these regions are minimal and the 3D printed model is

Efﬁcient Brain MRI Segmentation for 3D Printing

Applications

Timothy I. Anderson

Department of Electrical Engineering

Institute for Computational and Mathematical Engineering

Stanford University
timmya@stanford.edu

Abstract—Recent advances in computing power and additive
manufacturing (3D printing) have now made possible the efﬁ-
cient simulation, optimization, and replication of patient-speciﬁc
procedures and prosthetics for neurosurgery applications. Two
very promising applications are in ﬁnite element modeling for
brain injury simulation and detection and applying additive
manufacturing towards brain analogues or in vivo brain mod-
eling. While these applications are very promising, the problem
still remains of efﬁciently segmenting imaging data for use in
ﬁnite element models or 3D printing. In this project, we put
forth a novel algorithm for brain MRI image segmentation that
combines statistically-based segmentation techniques with partial
differential equation-based methods using neuromechanical mod-
els to provide an efﬁcient algorithm for automated brain MRI
segmentation. Findings from this project show that combining
these segmentation techniques can efﬁciently segment brain MRI
at a level of accuracy required for 3D printing applications.
Speciﬁcally, we show here that combining nonlinear ﬁltering,
k-means clustering, and active contour modeling can produce
robust segmentation of brain MRI images. We anticipate that
these results will eventually lead to the ability to simulate brain
procedures and prosthetics on a patient-speciﬁc level by using
the segmented images for ﬁnite element mesh generation or
additive manufacturing processes. When used in conjunction
with existing simulation and optimization techniques,
image
segmentation technology has many far-reaching applications in
neurosurgery, and the results from this project have brought
some of these applications closer into reach.

I. INTRODUCTION AND MOTIVATION

The advent of data-driven medicine and modern computing
power has enabled patient-speciﬁc diagnosis and treatment
based on medical imaging data. However, the primary bottle-
neck in this workﬂow remains the ability to efﬁciently segment
medical imaging data for use in simulation, modeling, and
statistical analysis. Manual image segmentation for a single CT
or MRI scan is a laborious process, often requiring expensive,
specialized software and many hours of work to segment a sin-
gle image sequence. As an image processing problem, medical
image segmentation also poses many signiﬁcant challenges
due to noisy data, low contrast images, and large variations
between patients [1].

For applications in neurosurgery and neurology, advances
in ﬁnite element modeling and additive manufacturing (3D
printing) have made possible the accurate simulation and
construction of patient-speciﬁc brain models and analogues
[2]. However, generating ﬁnite element meshes or surface

models for 3D printing requires the effective segmentation
of brain MRI images. Brain MRI images are particularly
difﬁcult to segment due to the low level of contrast between
the brain tissue, surrounding tissue, and cerebrospinal ﬂuid
[1]. The goal of this project is to create an image processing
algorithm that can effectively segment brain MRI data. We
focus on segmenting for 3D printing applications—speciﬁcally
for created patient speciﬁc brain analogues—because this area
remains less developed.

II. RELATED WORK

Several methods of image segmentation have been pro-
posed, which can be roughly divided into statistical techniques
and partial differential equation-based techniques. The most
popular statistical technique is fuzzy c-means classiﬁcation,
since it can effectively segment the image into separate classes
of signal [3]. Other statistical techniques are more advanced
and computationally intensive, such as convolutional neural
networks [4, 5]. For partial differential equation methods,
there are many models based on energy minimization and
level set methods. One of the most effective partial differential
equation-based techniques is active contour models, which ﬁt
a spline with minimal energy to the image contours (shown in
Figure 1) [6, 7]. There are also many deterministic models of
edge detection based on wavelet transform or other transform
methods [8]. Wavelet-based methods work by taking the
discrete wavelet transform of the image and combining these
to ﬁnd the edges in the image, while energy minimization
methods treat the edge contour as a ﬂexible plate and seek to
minimize its energy [6, 8].

The algorithm presented here employs a novel method
of complementing iterated active contour segmentation with
nonlinear ﬁltering and then post-processing with statistical
techniques to produce an improved ﬁnal segmentation result.
While [7] has shown that active contours in conjunction
with wavelet-based edge detection can be effective for image
segmentation, little work has been done on active contours in
conjunction with nonlinear ﬁlters. The algorithm is designed
speciﬁcally for brain MRI segmentation, and exploits the
geometric properties of the brain to improve the convergence
properties.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

2

(cid:34)

For this project, we used the model proposed by [11]:
− ν − λ1(u0 − c1)2

= δ(φ)

µ div

∂φ
∂t

(cid:32) ∇φ

|∇φ|

(cid:33)
+λ2(u0 − c2)2(cid:1)(cid:35)

= 0

where c1, c2 are integral functions of φ, λ1 = λ2 = 1,
ν = 0, and µ controls the stiffness of the contour. The
nonlinear PDE can be discritized and solved iteratively to
converge to a local minimum (i.e. ∂φ/∂t = 0), which will
be the locally optimal active contour. This particular active
contour model was chosen because it is not dependent on a
large edge gradient. Due to the low contrast between gray
matter and cerebrospinal ﬂuid, the edges in brain MRI will
have a low gradient, so an edge-free model is ideal for brain
MRI segmentation.

B. Brain Geometry

Because the brain is a three dimensional function, we can
also treat each individual slice of the brain as a level set Γ(x, y)
of a higher dimensional function ψ(x, y, t). Take Γ(x, y)i =
{ψ(x, y, t)|t = h× i}, i ∈ Z and h ≡ step size between brain
MRI slices, and deﬁne conv(supp Γ(x, y)) ≡ convex hull of
the support of Γ(x, y). If Γ0 ≡ largest MRI slice (by cross
sectional area), we take h = 1, and there are n slices, we
have:
conv(supp Γ0) ⊆ conv(suppΓ±1) ⊆ ··· ⊆ conv(supp Γ±n)
This property (approximately) holds for all brain slices, so
we can exploit this property for efﬁciently segmenting the
brain. That is, if we manually segment Γ0, we can propagate
the convex hull of each successive slice to remove unwanted
features outside supp Γi as well as provide an accurate initial
value for the active contour segmentation, which in turn
accelerates the convergence.

C. Image Segmentation Algorithm

The proposed algorithm uses the active contour model
proposed by [11]. In this algorithm, we combine gamma
ﬁltering with iterated active contour segmentation to improve
the ﬁnal segmentation result. Additionally,
the algorithm
employs statistical
techniques to further remove unwanted
background features and morphological post-processing to
improve the 3D printing properties. The goal is to create a
robust brain MRI segmentation system by combining these
techniques. The algorithm is given below.

Manually segment thickest slice and initialize as Γ0
for All slices above and below Γ0 do

n = Sn ∗ conv(supp Γn−1)
n = (Sn ∗ conv(supp Γn−1))2.0

Segment Sn by S(cid:48)
Gamma ﬁlter: S(cid:48)
Initialize φ0 = conv(supp Γn−1)
while active contour not converged do
Propagate active contour on image S(cid:48)

n

end while

Fig. 1: Active contour models ﬁt a spline with minimal contour
energy to the image.

III. TECHNICAL APPROACH AND MATHEMATICAL

FRAMEWORK

A. Active Contour Model
There currently exist

two main neuromechanical mod-
els. The ﬁrst is based on minimizing the distance between
functionally-related neurons [9], and the other on minimizing
the folding energy of cortical tissue [10]. The former hypoth-
esis disagrees with dissection experiments, but is more in-line
with the material properties of the brain. The latter model does
not match material properties of the brain, but does agree well
with dissection experiments. Using the latter model, from [10]
we have cortical folding governed by:

Ec
1 − ν2

c

t4
c
12

d4v
ds4 + P tc

d2v
ds2 = q

This differential equation gives the energy norm:

t4
c
12

α(s) ≡ Ec
1 − ν2
β(s) ≡ P tc

c

(cid:16) dv

(cid:17)2

(cid:32)

α(s)

ds

+ β(s)

(cid:17)2(cid:33)

ds

(cid:16) d2v

ds2

(cid:90) 1

0

1
2

E =

Active contour models seek to minimize the energy norm
of the contour [6]. Since cortical folding will naturally also
seek the locally minimal energy state, there is an inherent
connection between active contours and cortical folding. Be-
cause parameterizing a contour becomes very computationally
difﬁcult due to possible topological changes in the contour as
it evolves between iterations, we instead employ a level set
approach from [6] and treat the contour as the zero level set
of higher dimension function φ:

v(s) = {(x, y)|φ(t = 0, x, y) = 0}

We can then evolve φ according to the Hamilton-Jacobi

= F|∇φ|

∂φ
∂t

There are many choices for the force F . One of the simplest

equation:

is:

(cid:33)

(cid:32) ∇φ

|∇φ|

= |∇φ|div

∂φ
∂t

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

3

n = (Sn ∗ conv(supp Γn−1))1.5
S(cid:48)
Initialize φ(cid:48)
Repeat active contour iteration
Perform k-means clustering with k = 4
Record minimum centroid

0 = φconverged

end for
kavg = average lowest centroid of k-means data
Threshold each slice by kavg
Morphological post processing on segmented slices

IV. EXPERIMENTAL RESULTS

A. Algorithm and Evaluation of System Parameters

After manually segmenting the initial slice, ﬁrst step in
segmenting an intermediate slice is to load the MRI image
from the image sequence. The MRI sequence contains 120
images, and the voxel size was 1mm3.

Original slice image

We can roughly segment the raw MRI image using the
convex hull of the mask from the previous slice. Because the
support of each successive slice is a subset of the previous
slice, we can use this property to efﬁciently remove the skull
from the image.

ﬁnal contour will converge to a contour which does not
contain the dura mater or other unwanted material. We found
experimentally that γ = 2.0 produced good results for this
step, however any γ value that sufﬁciently suppresses the dura
mater and gray matter would be valid.

Gamma Filter 1 (γ = 2.0)

Active Contour Segmentation 1

For the second active contour segmentation, we apply a
gamma ﬁlter with a more moderate value (γ = 1.5 in this
case), then segment with the same active contour algorithm,
using the contour found in the previous step as the initial guess.
The active contour converges to a locally minimal energy
value, so the purpose of the ﬁrst active contour segmentation
is to ﬁnd an initial guess for the second segmentation that
will converge to the correct contour. Were we to use the
convex hull of the previous slice as the initial guess, unwanted
features such as the dura mater would be included in the
ﬁnal segmentation, and features such as separation between
brain folds would be lost. For this step, we use a more
ﬂexible active contour than in the previous step i.e. do not
penalize curvature as strongly in the contour optimization.
From a neuromechanical standpoint, a more ﬂexible contour
when segmenting the gray matter is justiﬁed due to the lower
stiffness of gray matter relative to white matter and prevalent
folds in the brain structure.

Gamma Filter 2 (γ = 1.5)

Active Contour Segmentation 2

Initial Mask

Initial Segmentation

The active contour segmentation occurs in two steps. First,
we apply a gamma ﬁlter with γ large to make the white
matter dominant in the image. Then, we use the active contour
algorithm from [11] (using the implementation in [12]) to
segment the image using the gamma ﬁlter. The purpose of
this step is to segment primarily the white matter, so the

After segmenting each slice, we perform k-means clustering
on the histogram of the image using k = 4. For each slice, the
lowest centroid was recorded. The minimum centroids were
then averaged to ﬁnd an average value for the background
throughout
the entire image sequence. Using this average
value, the segmented slices were thresholded to produce to
the ﬁnal binary mask.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

4

B. Comparison to Other Approaches

Compared to manual segmentation, the given algorithm is
signiﬁcantly faster. Manual segmentation takes about 1-2 days
of work on average, whereas this algorithm segmented the
test sequence in 519 sec. (after manual segmentation of the
initialization slice). The presented algorithm is very promising
since its runtime is fast enough to be effective for clini-
cal applications. The given segmentation algorithm also out-
performed several existing image processing techniques. For
example, ﬁgure 2 shows that the segmentation performance is
worse with simple adaptive thresholding.

Image segmented with algorithm
presented in this project.

Plain adaptive thresholding via
Otsu’s algorithm.

Fig. 2: Comparison of presented algorithm with adaptive
thresholding.

Additionally, using an edge-dependent active contour model
(i.e. a model which includes a stopping function in the
Hamiltonian) does not perform as well as the given algorithm.
As shown by ﬁgure 3, the given algorithm is much more
effective at preserving the structure of the brain slice and
removing artifacts and spurious regions from thresholding.
Edge-based active contour models work well where there are
sharply delineated edges in an image. However, since the
attenuation coefﬁcient for cerebrospinal ﬂuid, white matter,
and gray matter are similar, there brain MRI does not have
clearly delineated edges, so an edge-based active contour will
perform poorly.

Histogram after segmentation, with k-means centroids

Final segmented image

For 3D printing applications, we do post-processing on the
segmented masks to remove artifacts from the thresholding.
Speciﬁcally, we erode then dilate the mask. Very small or thin
regions are usually artifacts and can potentially cause issues
when replicating the brain sample via 3D printing since they
are usually below the accuracy threshold of most commercially
available printers.

Mask before post-processing

Mask after post-processing

Image segmented with algorithm
developed in this project.

Image
segmented with
dependent active contour.

edge-

Fig. 3: Comparison between presented algorithm and similar
algorithm with edge-dependent active contour.

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

5

Fig. 4: Plot showing 1-norm of error with respect to distance
from reference slice. Plot shows that forward propagation error
grows very little, while backward propagation error grows
signiﬁcantly.

Fig. 5: Surface model generated via marching cubes method
[13] using images segmented with the presented algorithm.

Overall, the presented image processing algorithm is sig-
niﬁcantly more effective than other similar methods or the
substituent parts of the algorithm. While statistically-based
algorithms may have better performance [4], the presented
algorithm is fast, effective, and requires no training set or prior
knowledge on the image other than manual segmentation of
the thickest slice by cross-sectional area.

V. DISCUSSION

The process images show that

the algorithm is able to
successfully segment brain MRI images. The gamma ﬁltering
also signiﬁcantly increased the performance of the active
contour algorithm. This can be attributed to the nonlinearity of
the gamma ﬁlter increasing the gradient of the edges, which

Fig. 6: Model printed via fused deposition modeling (FDM).

in turn aided the convergence of the active contour. Using k-
means clustering to ﬁnd a suitable threshold for binarizing the
image in the ﬁnal step also yielded physically accurate results.
To quantitatively measure the error from segmentation, we
ﬁrst manually segmented and binarized a subset of the original
brain MRI images. To evaluate the error, we used the 1-norm
of the difference between the two images to measure the num-
ber of pixels that differed between the manual and automated
segmentation. That is, Error = ||IM anual − IAutomated||1,
where I represents the vectorized image.

Figure 4 shows the results of the error analysis. Here,
we deﬁne ”forward propagation” as segmenting slices that
come after the reference slice in the MRI image sequence,
and ”backward propagation” as segmenting slices before the
reference slice. The error plot shows that the errors remain
relatively small for the forward propagation. This is most likely
due to the well-behaved geometry of the slices segmented in
the forward propagation. The error for the backwards propaga-
tion was much larger, which we attribute to two factors. First,
our assumption of the brain region being compactly supported
breaks down in the last slices containing the relevant brain
structure e.g. in the slices containing only the temporal lobes.
Secondly, in these lower slices, there are many different kinds
of tissue we do not wish to segment, such as the eyes and
cerebellum. These tissues were removed during the manual
segmentation, but our geometric model for the brain would not
have removed these during the initial segmentation, causing
signiﬁcant errors in the ﬁnal segmentation result.

For 3D printing applications, we were able to successfully
render the segmented slices into a surface model (Figure 5)
using the marching cubes method and then convert this to an
STL ﬁle using [13]. The surface model was then printed using
fused deposition modeling (FDM) (Figure 6). The printing
results show that
the morphological post-processing (edge
smoothing and small region removal) improved the quality of
the surface model and reduced structural errors while printing.
While there are some regions of the model where details are
lost, these regions are minimal and the 3D printed model is

T. I. Anderson

Efﬁcient Brain MRI Segmentation for 3D Printing Applications

6

[5] S. Khare, N. Gupta, and V. Srivastava, “Optimization
technique, curve ﬁtting and machine learning used to
detect brain tumor in mri,” in Computer Communication
and Systems, 2014 International Conference on, Feb
2014, pp. 254–259.

[6] M. Kass, A. Witkin, and D. Terzopoulos, “Snakes: Ac-
tive contour models,” International Journal of Computer
Vision, vol. 1, no. 4, pp. 321–331, 1988.

[7] S. W. Yoon, H. S. Shin, S. D. Min, and M. Lee, “Medical
endoscopic image segmentation with multi-resolution
deformation,” in 2007 9th International Conference on e-
Health Networking, Application and Services.
Institute
of Electrical & Electronics Engineers (IEEE), June 2007.
[8] Y. Zhang, Z. Dong, L. Wu, S. Wang, and Z. Zhou,
“Feature extraction of brain MRI by stationary wavelet
transform,” in 2010 International Conference on Biomed-
ical Engineering and Computer Science.
Institute of
Electrical & Electronics Engineers (IEEE), April 2010.
[9] D. C. V. Essen, “A tension-based theory of morphogen-
esis and compact wiring in the central nervous system,”
Nature, vol. 385, no. 6614, pp. 313–318, jan 1997.

[10] S. Budday, P. Steinmann, and E. Kuhl, “The role of
mechanics during brain development,” Journal of the
Mechanics and Physics of Solids, vol. 72, pp. 75–92,
December 2014.

[11] T. Chan and L. Vese, “Active contours without edges,”
IEEE Transactions on Image Processing, vol. 10, no. 2,
pp. 266–277, 2001.

2015.

[12] S.

Lankton,

“Active

contour

segmentation,”

http://www.mathworks.com/matlabcentral/ﬁleexchange/19567-
active-contour-segmentation, 2008–2015.

[13] W. Rasband, “Imagej,” http://imagej.nih.gov/ij/, 1997–

accurate enough to be used for brain analogue modeling.

VI. CONCLUSIONS AND FUTURE WORK

This project developed an algorithm that combined nonlin-
ear ﬁltering, active contour modeling, statistical thresholding,
and morphological post-processing into a novel algorithm
that can robustly segment brain MRI images. The runtime
of the presented algorithm is signiﬁcantly faster than manual
segmentation and other existing semi-automated segmentation
workﬂows, and the algorithm was still very effective at ex-
tracting the relevant brain tissue from the MRI images. The
algorithm was less effective at removing the eyes, cerebellum,
and dura mater, but these issues can be easily overcome in the
future with improvements in preprocessing the image. Future
work for this should focus on employing more advanced
statistical techniques in the image segmentation algorithm.
Two particular areas of interest are using more advanced
computer vision techniques to identify and remove non-brain
tissues in the lower brain slices, and use statistical learning
techniques to more accurately predict the geometric evolution
of the brain between slices according to the Hamilton-Jacobi
equation. Overall, nonlinear ﬁltering signiﬁcantly improves
the performance of active contour models in environments
with weak edges, and combining statistical and morphological
techniques with nonlinear ﬁlters and active contours can very
efﬁciently segment brain MRI images at a level of accuracy
suitable for neurosugery and 3D printing applications.

ACKNOWLEDGMENT

Many thanks to Prof. Gordon Wetzstein and Prof. Ellen
Kuhl for their support and instruction this quarter. Also many
thanks to Kushagr Gupta for his mentorship on the image
processing portion of this project, and Rijk De Rooij for his
guidance on the neuromechanics portion of the project as well
as volunteering his brain scan to be the test sample.

REFERENCES

[1] M. A. Balafar, A. R. Ramli, M.

I. Saripan, and
S. Mashohor, “Review of brain MRI image segmentation
methods,” Artiﬁcial Intelligence Review, vol. 33, no. 3,
pp. 261–274, January 2010.

[2] M. B. Panzer, B. S. Myers, B. P. Capehart, and C. R.
Bass, “Development of a ﬁnite element model for blast
brain injury and the effects of CSF cavitation,” Annals of
Biomedical Engineering, vol. 40, no. 7, pp. 1530–1544,
February 2012.

[3] M. Balafar, A. Ramli, M. Saripan, R. Mahmud, and
S. Mashohor, “Medical image segmentation using fuzzy
c-mean (fcm) and dominant grey levels of image,” in
Visual Information Engineering, 2008. VIE 2008. 5th
International Conference on, July 2008, pp. 314–317.

[4] M. Rostami, J. Ghasemi, and R. Ghaderi, “Neural net-
work for enhancement of fcm based brain mri segmen-
tation,” in Fuzzy Systems (IFSC), 2013 13th Iranian
Conference on, Aug 2013, pp. 1–4.


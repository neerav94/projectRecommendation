Visualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

Visualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

4 outside of the pass band, blocks most of the black body emission from soot and chemilumenscence
from other species (e.g. CH*) [2]. Therefore, by collecting the OH* emission, we obtain a global,
path-integrated image of the reaction zone.

Figure 2: Schematic of test set-up with imaging equipment.

An example of each of the raw images is shown in Figure 3. At the outset of this project the
author had access to data from 29 tests, this project focuses on the analysis of images from 11 of
these tests (Test 13 - Test 23), and in particular on the analysis of the 14,207 schlieren images and
16,386 OH* chemiluminescence images collected for each of these tests. Note that the number of
OH* chemiluminescence images exceeds the number of schlieren images due to the greater amount
of on-board storage on the Photron APX i2 camera as compared to the MotionPro X3 Plus. This
work was divided into a number of tasks and subtasks, all aimed towards applying the techniques
covered in EE278 in order to better understand the combustion process with hybrid rocket motors.
The speciﬁc tasks and the approach taken toward achieving them are discussed in the methodology.

2 Methodology

2.1 Correcting OH* Images

The UV sensitive Photron APX i2 camera used to collect the OH* images was slightly damaged,
resulting in bad pixel values in certain columns within each image. An example of the raw images
produced by the camera is show in Figure 4. The damaged pixels occupied speciﬁc columns within
each image but the number and location of the columns that were aﬀected varied from test to
test. The values of the damaged pixels did not remain constant, they could occupy any value from
0 to 1. Extensive analysis of the raw images revealed that although the columns containing the
damaged pixels varied, they were always a subset of the same group of columns. Any columns
that contained any values exactly equal to 0 or 1 typically represented damaged columns, as with
normal operation the camera was not saturating or underexposed. All columns that contained these
values were identiﬁed for each test. These potentially damaged columns were then compared across
all tests, and any columns that appeared to be damaged in multiple tests were ﬂagged. Code was
then developed to step through each of these columns and ﬁnd any pixels greater than 2 standard
deviations from the median of itself and the 2 pixels to either side. These pixels were replaced with
the mean value of the pixel to either side of it. This approach was adopted to minimize the aﬀect
of any standard ﬁltering operation on the undamaged majority of the OH* pixels. An example of
the results of this process is shown in Figure 4.

2.2 Aligning OH* and Schlieren Images

The schlieren and OH* images needed to be aligned in order to gain insight into where combustion
takes place within the turbulent boundary layer above hybrid rocket fuels. The process for doing
this was divided into two steps, ﬁrst projecting the images onto the same plane with the same scale,
then lining the images up by focusing on the alignment of the leading edge of the fuel grain.

2

O2Top viewSchlieren CameraOH* ChemiluminescenceColor Video CameraVisualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

4 outside of the pass band, blocks most of the black body emission from soot and chemilumenscence
from other species (e.g. CH*) [2]. Therefore, by collecting the OH* emission, we obtain a global,
path-integrated image of the reaction zone.

Figure 2: Schematic of test set-up with imaging equipment.

An example of each of the raw images is shown in Figure 3. At the outset of this project the
author had access to data from 29 tests, this project focuses on the analysis of images from 11 of
these tests (Test 13 - Test 23), and in particular on the analysis of the 14,207 schlieren images and
16,386 OH* chemiluminescence images collected for each of these tests. Note that the number of
OH* chemiluminescence images exceeds the number of schlieren images due to the greater amount
of on-board storage on the Photron APX i2 camera as compared to the MotionPro X3 Plus. This
work was divided into a number of tasks and subtasks, all aimed towards applying the techniques
covered in EE278 in order to better understand the combustion process with hybrid rocket motors.
The speciﬁc tasks and the approach taken toward achieving them are discussed in the methodology.

2 Methodology

2.1 Correcting OH* Images

The UV sensitive Photron APX i2 camera used to collect the OH* images was slightly damaged,
resulting in bad pixel values in certain columns within each image. An example of the raw images
produced by the camera is show in Figure 4. The damaged pixels occupied speciﬁc columns within
each image but the number and location of the columns that were aﬀected varied from test to
test. The values of the damaged pixels did not remain constant, they could occupy any value from
0 to 1. Extensive analysis of the raw images revealed that although the columns containing the
damaged pixels varied, they were always a subset of the same group of columns. Any columns
that contained any values exactly equal to 0 or 1 typically represented damaged columns, as with
normal operation the camera was not saturating or underexposed. All columns that contained these
values were identiﬁed for each test. These potentially damaged columns were then compared across
all tests, and any columns that appeared to be damaged in multiple tests were ﬂagged. Code was
then developed to step through each of these columns and ﬁnd any pixels greater than 2 standard
deviations from the median of itself and the 2 pixels to either side. These pixels were replaced with
the mean value of the pixel to either side of it. This approach was adopted to minimize the aﬀect
of any standard ﬁltering operation on the undamaged majority of the OH* pixels. An example of
the results of this process is shown in Figure 4.

2.2 Aligning OH* and Schlieren Images

The schlieren and OH* images needed to be aligned in order to gain insight into where combustion
takes place within the turbulent boundary layer above hybrid rocket fuels. The process for doing
this was divided into two steps, ﬁrst projecting the images onto the same plane with the same scale,
then lining the images up by focusing on the alignment of the leading edge of the fuel grain.

2

O2Top viewSchlieren CameraOH* ChemiluminescenceColor Video Camera(a) Raw Color Image

(b) Raw OH* Image

Figure 3: Examples of raw image from each camera. Test shown is the combustion of BP with
gaseous oxygen at elevated pressure.

(c) Raw Schlieren Image

2.2.1 Projecting Images

The schlieren and OH* images were triggered together and recorded at the same frame rate. How-
ever, it was not possible to give both cameras a square view of the test section simultaneously. Some
projection error in the OH* images was inevitable since schlieren optics require a straight uninter-
rupted path through the test section. Figure 2 shows the test set-up and the location of the cameras.
It can be seen that the OH* camera does not sit perpendicular to the test section, but rather sits an
angle of approximately 15 degrees1. Future work could consider the use of a beam-splitter to negate
the need for this correction and to remove any bias in the OH* images resulting from integrating
the signal through an oﬀ-normal path; however, an appropriate beam-splitter was not available at
the time of this work.

A method was developed to remove projection error and to ensure consistent alignment of OH*
and schlieren images regardless of their scale. Grid images were taken prior to each test. The raw
OH* images were aﬀected by some noise, the signal to noise ratio in the OH* grids was improved
by taking the mean of many OH* grid images prior to analyzing them. The separation of the
gridpoints in ”real-space” is known apriori to be dx = 5.08 mm (0.2 in) and dy = 2.54 mm (0.1
in). The gridpoints are detected using a scheme originally developed by Miller [3] that was modiﬁed

1This projection angle is calculated by looking at the mean horizontal distortion of the OH* grid images

3

Visualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

4 outside of the pass band, blocks most of the black body emission from soot and chemilumenscence
from other species (e.g. CH*) [2]. Therefore, by collecting the OH* emission, we obtain a global,
path-integrated image of the reaction zone.

Figure 2: Schematic of test set-up with imaging equipment.

An example of each of the raw images is shown in Figure 3. At the outset of this project the
author had access to data from 29 tests, this project focuses on the analysis of images from 11 of
these tests (Test 13 - Test 23), and in particular on the analysis of the 14,207 schlieren images and
16,386 OH* chemiluminescence images collected for each of these tests. Note that the number of
OH* chemiluminescence images exceeds the number of schlieren images due to the greater amount
of on-board storage on the Photron APX i2 camera as compared to the MotionPro X3 Plus. This
work was divided into a number of tasks and subtasks, all aimed towards applying the techniques
covered in EE278 in order to better understand the combustion process with hybrid rocket motors.
The speciﬁc tasks and the approach taken toward achieving them are discussed in the methodology.

2 Methodology

2.1 Correcting OH* Images

The UV sensitive Photron APX i2 camera used to collect the OH* images was slightly damaged,
resulting in bad pixel values in certain columns within each image. An example of the raw images
produced by the camera is show in Figure 4. The damaged pixels occupied speciﬁc columns within
each image but the number and location of the columns that were aﬀected varied from test to
test. The values of the damaged pixels did not remain constant, they could occupy any value from
0 to 1. Extensive analysis of the raw images revealed that although the columns containing the
damaged pixels varied, they were always a subset of the same group of columns. Any columns
that contained any values exactly equal to 0 or 1 typically represented damaged columns, as with
normal operation the camera was not saturating or underexposed. All columns that contained these
values were identiﬁed for each test. These potentially damaged columns were then compared across
all tests, and any columns that appeared to be damaged in multiple tests were ﬂagged. Code was
then developed to step through each of these columns and ﬁnd any pixels greater than 2 standard
deviations from the median of itself and the 2 pixels to either side. These pixels were replaced with
the mean value of the pixel to either side of it. This approach was adopted to minimize the aﬀect
of any standard ﬁltering operation on the undamaged majority of the OH* pixels. An example of
the results of this process is shown in Figure 4.

2.2 Aligning OH* and Schlieren Images

The schlieren and OH* images needed to be aligned in order to gain insight into where combustion
takes place within the turbulent boundary layer above hybrid rocket fuels. The process for doing
this was divided into two steps, ﬁrst projecting the images onto the same plane with the same scale,
then lining the images up by focusing on the alignment of the leading edge of the fuel grain.

2

O2Top viewSchlieren CameraOH* ChemiluminescenceColor Video Camera(a) Raw Color Image

(b) Raw OH* Image

Figure 3: Examples of raw image from each camera. Test shown is the combustion of BP with
gaseous oxygen at elevated pressure.

(c) Raw Schlieren Image

2.2.1 Projecting Images

The schlieren and OH* images were triggered together and recorded at the same frame rate. How-
ever, it was not possible to give both cameras a square view of the test section simultaneously. Some
projection error in the OH* images was inevitable since schlieren optics require a straight uninter-
rupted path through the test section. Figure 2 shows the test set-up and the location of the cameras.
It can be seen that the OH* camera does not sit perpendicular to the test section, but rather sits an
angle of approximately 15 degrees1. Future work could consider the use of a beam-splitter to negate
the need for this correction and to remove any bias in the OH* images resulting from integrating
the signal through an oﬀ-normal path; however, an appropriate beam-splitter was not available at
the time of this work.

A method was developed to remove projection error and to ensure consistent alignment of OH*
and schlieren images regardless of their scale. Grid images were taken prior to each test. The raw
OH* images were aﬀected by some noise, the signal to noise ratio in the OH* grids was improved
by taking the mean of many OH* grid images prior to analyzing them. The separation of the
gridpoints in ”real-space” is known apriori to be dx = 5.08 mm (0.2 in) and dy = 2.54 mm (0.1
in). The gridpoints are detected using a scheme originally developed by Miller [3] that was modiﬁed

1This projection angle is calculated by looking at the mean horizontal distortion of the OH* grid images

3

(a) Raw OH* Image

(b) OH* Image with Damaged Pixel Removal

Figure 4: Test 22. Grid image with and without damaged pixel removal.

for this purpose. The user must ﬁrst manually identify the three gridpoints in the bottom left of
the image. The algorithm then evaluates the pixel intensities around each of these points and ﬁts a
Gaussian to these intensities; the center of the gridpoint is taken as the center of the ﬁtted gaussian.
The extent of the region to be evaluated around the gridpoint is deﬁned to be a window of ±3 pixels.
The code then estimates the expected number of pixels between gridpoints (both in the horizontal
and vertical directions), estimates a new center for the next gridpoint, re-evaluates the Gaussian
in the region around this point and ﬁnds the new center location. This process is repeated across
each row and up all columns to be evaluated. Figure 5 shows an example of detected gridpoints
overlaid over the schlieren grid image.
In this way the code adjusts for any error introduced by
the user in selecting the original gridpoints or any distortion to the grid introduced by the optics.
After identiﬁcation, a 2D cubic polynomial is ﬁt to the location of all of the gridpoints to map the
x,y location in pixel space to the x,y location in real space. The location of the schlieren and OH*
pixels in real space is then known. However, this process has not yet projected the images onto the
same plane, it has simply determined the mapping of the images to their location in real space. The
schlieren and OH* images now need to be projected onto the same uniform grid in order to overlay
them. A uniform grid of x,y locations in real space is generated such that there is no reduction in
resolution for either image. For all images, a uniform grid was generated such that a single pixel
represents 0.1 mm in each direction. This typically scaled the images to a little over 1.5 times their
initial size. With this methodology, the schlieren and OH* images were transformed to have the
same size and scale, but in order to concurrently analyze and display them they needed to be aligned,
the approach for this is described in the following subsection.

Figure 5: Example of detected grid points for schlieren grid image.

2.2.2 Overlaying Images

The images were not able to be aligned directly by overlaying a single grid point due to the diﬀerence
in the location of the gridpoints relative to the test article. This diﬀerence is an artifact of projection
error applied to the normal distance between the physical grid and test article. The grid image was
installed in front of the test section, and the fuel grain sits within the test section, thus, the location

4

Visualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

4 outside of the pass band, blocks most of the black body emission from soot and chemilumenscence
from other species (e.g. CH*) [2]. Therefore, by collecting the OH* emission, we obtain a global,
path-integrated image of the reaction zone.

Figure 2: Schematic of test set-up with imaging equipment.

An example of each of the raw images is shown in Figure 3. At the outset of this project the
author had access to data from 29 tests, this project focuses on the analysis of images from 11 of
these tests (Test 13 - Test 23), and in particular on the analysis of the 14,207 schlieren images and
16,386 OH* chemiluminescence images collected for each of these tests. Note that the number of
OH* chemiluminescence images exceeds the number of schlieren images due to the greater amount
of on-board storage on the Photron APX i2 camera as compared to the MotionPro X3 Plus. This
work was divided into a number of tasks and subtasks, all aimed towards applying the techniques
covered in EE278 in order to better understand the combustion process with hybrid rocket motors.
The speciﬁc tasks and the approach taken toward achieving them are discussed in the methodology.

2 Methodology

2.1 Correcting OH* Images

The UV sensitive Photron APX i2 camera used to collect the OH* images was slightly damaged,
resulting in bad pixel values in certain columns within each image. An example of the raw images
produced by the camera is show in Figure 4. The damaged pixels occupied speciﬁc columns within
each image but the number and location of the columns that were aﬀected varied from test to
test. The values of the damaged pixels did not remain constant, they could occupy any value from
0 to 1. Extensive analysis of the raw images revealed that although the columns containing the
damaged pixels varied, they were always a subset of the same group of columns. Any columns
that contained any values exactly equal to 0 or 1 typically represented damaged columns, as with
normal operation the camera was not saturating or underexposed. All columns that contained these
values were identiﬁed for each test. These potentially damaged columns were then compared across
all tests, and any columns that appeared to be damaged in multiple tests were ﬂagged. Code was
then developed to step through each of these columns and ﬁnd any pixels greater than 2 standard
deviations from the median of itself and the 2 pixels to either side. These pixels were replaced with
the mean value of the pixel to either side of it. This approach was adopted to minimize the aﬀect
of any standard ﬁltering operation on the undamaged majority of the OH* pixels. An example of
the results of this process is shown in Figure 4.

2.2 Aligning OH* and Schlieren Images

The schlieren and OH* images needed to be aligned in order to gain insight into where combustion
takes place within the turbulent boundary layer above hybrid rocket fuels. The process for doing
this was divided into two steps, ﬁrst projecting the images onto the same plane with the same scale,
then lining the images up by focusing on the alignment of the leading edge of the fuel grain.

2

O2Top viewSchlieren CameraOH* ChemiluminescenceColor Video Camera(a) Raw Color Image

(b) Raw OH* Image

Figure 3: Examples of raw image from each camera. Test shown is the combustion of BP with
gaseous oxygen at elevated pressure.

(c) Raw Schlieren Image

2.2.1 Projecting Images

The schlieren and OH* images were triggered together and recorded at the same frame rate. How-
ever, it was not possible to give both cameras a square view of the test section simultaneously. Some
projection error in the OH* images was inevitable since schlieren optics require a straight uninter-
rupted path through the test section. Figure 2 shows the test set-up and the location of the cameras.
It can be seen that the OH* camera does not sit perpendicular to the test section, but rather sits an
angle of approximately 15 degrees1. Future work could consider the use of a beam-splitter to negate
the need for this correction and to remove any bias in the OH* images resulting from integrating
the signal through an oﬀ-normal path; however, an appropriate beam-splitter was not available at
the time of this work.

A method was developed to remove projection error and to ensure consistent alignment of OH*
and schlieren images regardless of their scale. Grid images were taken prior to each test. The raw
OH* images were aﬀected by some noise, the signal to noise ratio in the OH* grids was improved
by taking the mean of many OH* grid images prior to analyzing them. The separation of the
gridpoints in ”real-space” is known apriori to be dx = 5.08 mm (0.2 in) and dy = 2.54 mm (0.1
in). The gridpoints are detected using a scheme originally developed by Miller [3] that was modiﬁed

1This projection angle is calculated by looking at the mean horizontal distortion of the OH* grid images

3

(a) Raw OH* Image

(b) OH* Image with Damaged Pixel Removal

Figure 4: Test 22. Grid image with and without damaged pixel removal.

for this purpose. The user must ﬁrst manually identify the three gridpoints in the bottom left of
the image. The algorithm then evaluates the pixel intensities around each of these points and ﬁts a
Gaussian to these intensities; the center of the gridpoint is taken as the center of the ﬁtted gaussian.
The extent of the region to be evaluated around the gridpoint is deﬁned to be a window of ±3 pixels.
The code then estimates the expected number of pixels between gridpoints (both in the horizontal
and vertical directions), estimates a new center for the next gridpoint, re-evaluates the Gaussian
in the region around this point and ﬁnds the new center location. This process is repeated across
each row and up all columns to be evaluated. Figure 5 shows an example of detected gridpoints
overlaid over the schlieren grid image.
In this way the code adjusts for any error introduced by
the user in selecting the original gridpoints or any distortion to the grid introduced by the optics.
After identiﬁcation, a 2D cubic polynomial is ﬁt to the location of all of the gridpoints to map the
x,y location in pixel space to the x,y location in real space. The location of the schlieren and OH*
pixels in real space is then known. However, this process has not yet projected the images onto the
same plane, it has simply determined the mapping of the images to their location in real space. The
schlieren and OH* images now need to be projected onto the same uniform grid in order to overlay
them. A uniform grid of x,y locations in real space is generated such that there is no reduction in
resolution for either image. For all images, a uniform grid was generated such that a single pixel
represents 0.1 mm in each direction. This typically scaled the images to a little over 1.5 times their
initial size. With this methodology, the schlieren and OH* images were transformed to have the
same size and scale, but in order to concurrently analyze and display them they needed to be aligned,
the approach for this is described in the following subsection.

Figure 5: Example of detected grid points for schlieren grid image.

2.2.2 Overlaying Images

The images were not able to be aligned directly by overlaying a single grid point due to the diﬀerence
in the location of the gridpoints relative to the test article. This diﬀerence is an artifact of projection
error applied to the normal distance between the physical grid and test article. The grid image was
installed in front of the test section, and the fuel grain sits within the test section, thus, the location

4

of the gridpoints relative to the fuel grain as seen by the OH* camera was diﬀerent to the location
of those same points in the schlieren images. As an example, the point immediately ahead of the
fuel grain in the schlieren image would typically sit within the fuel grain in the OH* image. An
alternative alignment approach was required. Initially, cross correlation of the two images was the
intended alignment method, however, the slight distortion of the fuel grain leading edge proﬁle in
the OH* images resulting from re-projection of the image led to a very low signal to noise ratio in
the phase correlation. Thus, a clear cross correlation peak corresponding to the alignment of the
two images was not always able to be identiﬁed. Instead, simple minimization of squared diﬀerence
per pixel between the images was used in order to align them. The fore end of the fuel grain is the
region around which accuracy is required, and thus only the region around the front of the fuel grain
was used to align the OH* images to the full schlieren images. Care had to be taken to only look at
the overlapping region of the two images. This approach worked successfully for aligning the images
in all 11 tests.

Following alignment, it was desirable to display the aligned schlieren and OH* images using a
custom colormap to false-color the OH* images. Matlab does not allow the use of two distinct
colormaps to be used in a single ﬁgure. Thus, in order to display greyscale schlieren images overlaid
with false-color OH* images, the schlieren images were converted to RGB with equal weights in all
three components, producing the desired greyscale image. The OH* images were overlaid over the
schlieren image with the custom violet colormap and a transparency of 50%. An example of the
ﬁgures produced with these display properties is shown in Figure 6.

Figure 6: Example overlaid schlieren and OH* image. The image shown is for the combustion of
BP and oxygen at elevated pressure.

2.3 OH* Intensity

The mean intensity within the OH* chemiluminescence images was investigated in order to quantify
the burn time, and compare that with the burn time determined from the pressure trace. The
variations in mean intensity with time also give insight into the unstable nature of the ﬂames. The
approach for this work was very straightforward, the mean pixel value for each image was calculated
across the entire re-projected image. The values of mean intensity were then normalized to range
from 0 to 1. Future work for this task will focus on overlaying the results of this analysis with the
combustion chamber pressure versus time trace in order to investigate the correlation between the
number of OH* radicals and the chamber pressure.

2.4 Edge Detection

One of the major contributions from the combustion visualization tests is the quantiﬁcation of the
growth rate of the turbulent boundary layer, and the ﬂame location within that boundary layer, for
typical hybrid motor operating conditions.

2.4.1 Fuel Grain

The fuel grain location was initially estimated from the proﬁle of the fuel grain prior to ignition.
The ﬁrst schlieren image for each test was used for this purpose. The image was gaussian ﬁltered

5

Visualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

4 outside of the pass band, blocks most of the black body emission from soot and chemilumenscence
from other species (e.g. CH*) [2]. Therefore, by collecting the OH* emission, we obtain a global,
path-integrated image of the reaction zone.

Figure 2: Schematic of test set-up with imaging equipment.

An example of each of the raw images is shown in Figure 3. At the outset of this project the
author had access to data from 29 tests, this project focuses on the analysis of images from 11 of
these tests (Test 13 - Test 23), and in particular on the analysis of the 14,207 schlieren images and
16,386 OH* chemiluminescence images collected for each of these tests. Note that the number of
OH* chemiluminescence images exceeds the number of schlieren images due to the greater amount
of on-board storage on the Photron APX i2 camera as compared to the MotionPro X3 Plus. This
work was divided into a number of tasks and subtasks, all aimed towards applying the techniques
covered in EE278 in order to better understand the combustion process with hybrid rocket motors.
The speciﬁc tasks and the approach taken toward achieving them are discussed in the methodology.

2 Methodology

2.1 Correcting OH* Images

The UV sensitive Photron APX i2 camera used to collect the OH* images was slightly damaged,
resulting in bad pixel values in certain columns within each image. An example of the raw images
produced by the camera is show in Figure 4. The damaged pixels occupied speciﬁc columns within
each image but the number and location of the columns that were aﬀected varied from test to
test. The values of the damaged pixels did not remain constant, they could occupy any value from
0 to 1. Extensive analysis of the raw images revealed that although the columns containing the
damaged pixels varied, they were always a subset of the same group of columns. Any columns
that contained any values exactly equal to 0 or 1 typically represented damaged columns, as with
normal operation the camera was not saturating or underexposed. All columns that contained these
values were identiﬁed for each test. These potentially damaged columns were then compared across
all tests, and any columns that appeared to be damaged in multiple tests were ﬂagged. Code was
then developed to step through each of these columns and ﬁnd any pixels greater than 2 standard
deviations from the median of itself and the 2 pixels to either side. These pixels were replaced with
the mean value of the pixel to either side of it. This approach was adopted to minimize the aﬀect
of any standard ﬁltering operation on the undamaged majority of the OH* pixels. An example of
the results of this process is shown in Figure 4.

2.2 Aligning OH* and Schlieren Images

The schlieren and OH* images needed to be aligned in order to gain insight into where combustion
takes place within the turbulent boundary layer above hybrid rocket fuels. The process for doing
this was divided into two steps, ﬁrst projecting the images onto the same plane with the same scale,
then lining the images up by focusing on the alignment of the leading edge of the fuel grain.

2

O2Top viewSchlieren CameraOH* ChemiluminescenceColor Video Camera(a) Raw Color Image

(b) Raw OH* Image

Figure 3: Examples of raw image from each camera. Test shown is the combustion of BP with
gaseous oxygen at elevated pressure.

(c) Raw Schlieren Image

2.2.1 Projecting Images

The schlieren and OH* images were triggered together and recorded at the same frame rate. How-
ever, it was not possible to give both cameras a square view of the test section simultaneously. Some
projection error in the OH* images was inevitable since schlieren optics require a straight uninter-
rupted path through the test section. Figure 2 shows the test set-up and the location of the cameras.
It can be seen that the OH* camera does not sit perpendicular to the test section, but rather sits an
angle of approximately 15 degrees1. Future work could consider the use of a beam-splitter to negate
the need for this correction and to remove any bias in the OH* images resulting from integrating
the signal through an oﬀ-normal path; however, an appropriate beam-splitter was not available at
the time of this work.

A method was developed to remove projection error and to ensure consistent alignment of OH*
and schlieren images regardless of their scale. Grid images were taken prior to each test. The raw
OH* images were aﬀected by some noise, the signal to noise ratio in the OH* grids was improved
by taking the mean of many OH* grid images prior to analyzing them. The separation of the
gridpoints in ”real-space” is known apriori to be dx = 5.08 mm (0.2 in) and dy = 2.54 mm (0.1
in). The gridpoints are detected using a scheme originally developed by Miller [3] that was modiﬁed

1This projection angle is calculated by looking at the mean horizontal distortion of the OH* grid images

3

(a) Raw OH* Image

(b) OH* Image with Damaged Pixel Removal

Figure 4: Test 22. Grid image with and without damaged pixel removal.

for this purpose. The user must ﬁrst manually identify the three gridpoints in the bottom left of
the image. The algorithm then evaluates the pixel intensities around each of these points and ﬁts a
Gaussian to these intensities; the center of the gridpoint is taken as the center of the ﬁtted gaussian.
The extent of the region to be evaluated around the gridpoint is deﬁned to be a window of ±3 pixels.
The code then estimates the expected number of pixels between gridpoints (both in the horizontal
and vertical directions), estimates a new center for the next gridpoint, re-evaluates the Gaussian
in the region around this point and ﬁnds the new center location. This process is repeated across
each row and up all columns to be evaluated. Figure 5 shows an example of detected gridpoints
overlaid over the schlieren grid image.
In this way the code adjusts for any error introduced by
the user in selecting the original gridpoints or any distortion to the grid introduced by the optics.
After identiﬁcation, a 2D cubic polynomial is ﬁt to the location of all of the gridpoints to map the
x,y location in pixel space to the x,y location in real space. The location of the schlieren and OH*
pixels in real space is then known. However, this process has not yet projected the images onto the
same plane, it has simply determined the mapping of the images to their location in real space. The
schlieren and OH* images now need to be projected onto the same uniform grid in order to overlay
them. A uniform grid of x,y locations in real space is generated such that there is no reduction in
resolution for either image. For all images, a uniform grid was generated such that a single pixel
represents 0.1 mm in each direction. This typically scaled the images to a little over 1.5 times their
initial size. With this methodology, the schlieren and OH* images were transformed to have the
same size and scale, but in order to concurrently analyze and display them they needed to be aligned,
the approach for this is described in the following subsection.

Figure 5: Example of detected grid points for schlieren grid image.

2.2.2 Overlaying Images

The images were not able to be aligned directly by overlaying a single grid point due to the diﬀerence
in the location of the gridpoints relative to the test article. This diﬀerence is an artifact of projection
error applied to the normal distance between the physical grid and test article. The grid image was
installed in front of the test section, and the fuel grain sits within the test section, thus, the location

4

of the gridpoints relative to the fuel grain as seen by the OH* camera was diﬀerent to the location
of those same points in the schlieren images. As an example, the point immediately ahead of the
fuel grain in the schlieren image would typically sit within the fuel grain in the OH* image. An
alternative alignment approach was required. Initially, cross correlation of the two images was the
intended alignment method, however, the slight distortion of the fuel grain leading edge proﬁle in
the OH* images resulting from re-projection of the image led to a very low signal to noise ratio in
the phase correlation. Thus, a clear cross correlation peak corresponding to the alignment of the
two images was not always able to be identiﬁed. Instead, simple minimization of squared diﬀerence
per pixel between the images was used in order to align them. The fore end of the fuel grain is the
region around which accuracy is required, and thus only the region around the front of the fuel grain
was used to align the OH* images to the full schlieren images. Care had to be taken to only look at
the overlapping region of the two images. This approach worked successfully for aligning the images
in all 11 tests.

Following alignment, it was desirable to display the aligned schlieren and OH* images using a
custom colormap to false-color the OH* images. Matlab does not allow the use of two distinct
colormaps to be used in a single ﬁgure. Thus, in order to display greyscale schlieren images overlaid
with false-color OH* images, the schlieren images were converted to RGB with equal weights in all
three components, producing the desired greyscale image. The OH* images were overlaid over the
schlieren image with the custom violet colormap and a transparency of 50%. An example of the
ﬁgures produced with these display properties is shown in Figure 6.

Figure 6: Example overlaid schlieren and OH* image. The image shown is for the combustion of
BP and oxygen at elevated pressure.

2.3 OH* Intensity

The mean intensity within the OH* chemiluminescence images was investigated in order to quantify
the burn time, and compare that with the burn time determined from the pressure trace. The
variations in mean intensity with time also give insight into the unstable nature of the ﬂames. The
approach for this work was very straightforward, the mean pixel value for each image was calculated
across the entire re-projected image. The values of mean intensity were then normalized to range
from 0 to 1. Future work for this task will focus on overlaying the results of this analysis with the
combustion chamber pressure versus time trace in order to investigate the correlation between the
number of OH* radicals and the chamber pressure.

2.4 Edge Detection

One of the major contributions from the combustion visualization tests is the quantiﬁcation of the
growth rate of the turbulent boundary layer, and the ﬂame location within that boundary layer, for
typical hybrid motor operating conditions.

2.4.1 Fuel Grain

The fuel grain location was initially estimated from the proﬁle of the fuel grain prior to ignition.
The ﬁrst schlieren image for each test was used for this purpose. The image was gaussian ﬁltered

5

then binarized using Otsu’s method. Following binarization, small dark regions and white holes were
removed. The Canny edge detector was then applied to trace the fuel grain proﬁle. The Canny edge
detector ﬁrst smooths the image with a Gaussian ﬁlter, in this case a standard deviation of σ = 1.1
was used for the ﬁltering operation. The Canny edge detector approximates gradient magnitude
and angle across the image, applies non-maxima suppression to the gradient magnitude, then uses
double thresholding to detect strong and weak edge pixels. All weak edge pixels not connected with
strong edge pixels are rejected. Thresholds of 0.2 and 0.5 were found to be successful threshold
values for the weak and strong edges, respectively. Following the application of the edge detector
the region surrounding the fuel grain was then isolated to remove undesired window edges around
the periphery of the image. This approach with these inputs successfully identiﬁed the fuel grain
edge in the ﬁrst schlieren image for all tests. An example of the resulting fuel grain trace is shown
in Figure 7.

Figure 7: Fuel grain edge detection overlaid on grayscale schlieren image. The image shown is for
the combustion of BP and oxygen at elevated pressure.

2.4.2 Flame Location

The ﬂame location was quantiﬁed by looking at the mean OH* chemiluminescence images. Hybrid
rocket combustion theory assumes an inﬁnitely thin ﬂame sheet. Thus, the ﬁrst step in quantifying
the ﬂame location involved approximating the combustion zone as a region of unit pixel thickness.
The location of the ﬂame was assumed to be the location of peak OH* intensity within each column
in the vicinity of the the fuel grain. In order to avoid the inclusion of noisy points far from the
main ﬂame front, each column was only included if the peak intensity exceeded a threshold of 0.05.
Future work should look at evaluating the thickness of the ﬂame sheet by investigating the vertical
distribution of the ﬂame at various points along the fuel grain.

Figure 8: Flame location identiﬁcation overlaid on OH* image with custom colormap. The image
shown is for the combustion of BP and oxygen at elevated pressure.

2.4.3 Boundary Layer

Detecting the boundary layer in the mean images proved somewhat challenging.
In general the
variations in image intensity within the freestream are less than those within the boundary layer
and the boundary between these two regions can easily be identiﬁed with the naked eye. However,

6

Visualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

4 outside of the pass band, blocks most of the black body emission from soot and chemilumenscence
from other species (e.g. CH*) [2]. Therefore, by collecting the OH* emission, we obtain a global,
path-integrated image of the reaction zone.

Figure 2: Schematic of test set-up with imaging equipment.

An example of each of the raw images is shown in Figure 3. At the outset of this project the
author had access to data from 29 tests, this project focuses on the analysis of images from 11 of
these tests (Test 13 - Test 23), and in particular on the analysis of the 14,207 schlieren images and
16,386 OH* chemiluminescence images collected for each of these tests. Note that the number of
OH* chemiluminescence images exceeds the number of schlieren images due to the greater amount
of on-board storage on the Photron APX i2 camera as compared to the MotionPro X3 Plus. This
work was divided into a number of tasks and subtasks, all aimed towards applying the techniques
covered in EE278 in order to better understand the combustion process with hybrid rocket motors.
The speciﬁc tasks and the approach taken toward achieving them are discussed in the methodology.

2 Methodology

2.1 Correcting OH* Images

The UV sensitive Photron APX i2 camera used to collect the OH* images was slightly damaged,
resulting in bad pixel values in certain columns within each image. An example of the raw images
produced by the camera is show in Figure 4. The damaged pixels occupied speciﬁc columns within
each image but the number and location of the columns that were aﬀected varied from test to
test. The values of the damaged pixels did not remain constant, they could occupy any value from
0 to 1. Extensive analysis of the raw images revealed that although the columns containing the
damaged pixels varied, they were always a subset of the same group of columns. Any columns
that contained any values exactly equal to 0 or 1 typically represented damaged columns, as with
normal operation the camera was not saturating or underexposed. All columns that contained these
values were identiﬁed for each test. These potentially damaged columns were then compared across
all tests, and any columns that appeared to be damaged in multiple tests were ﬂagged. Code was
then developed to step through each of these columns and ﬁnd any pixels greater than 2 standard
deviations from the median of itself and the 2 pixels to either side. These pixels were replaced with
the mean value of the pixel to either side of it. This approach was adopted to minimize the aﬀect
of any standard ﬁltering operation on the undamaged majority of the OH* pixels. An example of
the results of this process is shown in Figure 4.

2.2 Aligning OH* and Schlieren Images

The schlieren and OH* images needed to be aligned in order to gain insight into where combustion
takes place within the turbulent boundary layer above hybrid rocket fuels. The process for doing
this was divided into two steps, ﬁrst projecting the images onto the same plane with the same scale,
then lining the images up by focusing on the alignment of the leading edge of the fuel grain.

2

O2Top viewSchlieren CameraOH* ChemiluminescenceColor Video Camera(a) Raw Color Image

(b) Raw OH* Image

Figure 3: Examples of raw image from each camera. Test shown is the combustion of BP with
gaseous oxygen at elevated pressure.

(c) Raw Schlieren Image

2.2.1 Projecting Images

The schlieren and OH* images were triggered together and recorded at the same frame rate. How-
ever, it was not possible to give both cameras a square view of the test section simultaneously. Some
projection error in the OH* images was inevitable since schlieren optics require a straight uninter-
rupted path through the test section. Figure 2 shows the test set-up and the location of the cameras.
It can be seen that the OH* camera does not sit perpendicular to the test section, but rather sits an
angle of approximately 15 degrees1. Future work could consider the use of a beam-splitter to negate
the need for this correction and to remove any bias in the OH* images resulting from integrating
the signal through an oﬀ-normal path; however, an appropriate beam-splitter was not available at
the time of this work.

A method was developed to remove projection error and to ensure consistent alignment of OH*
and schlieren images regardless of their scale. Grid images were taken prior to each test. The raw
OH* images were aﬀected by some noise, the signal to noise ratio in the OH* grids was improved
by taking the mean of many OH* grid images prior to analyzing them. The separation of the
gridpoints in ”real-space” is known apriori to be dx = 5.08 mm (0.2 in) and dy = 2.54 mm (0.1
in). The gridpoints are detected using a scheme originally developed by Miller [3] that was modiﬁed

1This projection angle is calculated by looking at the mean horizontal distortion of the OH* grid images

3

(a) Raw OH* Image

(b) OH* Image with Damaged Pixel Removal

Figure 4: Test 22. Grid image with and without damaged pixel removal.

for this purpose. The user must ﬁrst manually identify the three gridpoints in the bottom left of
the image. The algorithm then evaluates the pixel intensities around each of these points and ﬁts a
Gaussian to these intensities; the center of the gridpoint is taken as the center of the ﬁtted gaussian.
The extent of the region to be evaluated around the gridpoint is deﬁned to be a window of ±3 pixels.
The code then estimates the expected number of pixels between gridpoints (both in the horizontal
and vertical directions), estimates a new center for the next gridpoint, re-evaluates the Gaussian
in the region around this point and ﬁnds the new center location. This process is repeated across
each row and up all columns to be evaluated. Figure 5 shows an example of detected gridpoints
overlaid over the schlieren grid image.
In this way the code adjusts for any error introduced by
the user in selecting the original gridpoints or any distortion to the grid introduced by the optics.
After identiﬁcation, a 2D cubic polynomial is ﬁt to the location of all of the gridpoints to map the
x,y location in pixel space to the x,y location in real space. The location of the schlieren and OH*
pixels in real space is then known. However, this process has not yet projected the images onto the
same plane, it has simply determined the mapping of the images to their location in real space. The
schlieren and OH* images now need to be projected onto the same uniform grid in order to overlay
them. A uniform grid of x,y locations in real space is generated such that there is no reduction in
resolution for either image. For all images, a uniform grid was generated such that a single pixel
represents 0.1 mm in each direction. This typically scaled the images to a little over 1.5 times their
initial size. With this methodology, the schlieren and OH* images were transformed to have the
same size and scale, but in order to concurrently analyze and display them they needed to be aligned,
the approach for this is described in the following subsection.

Figure 5: Example of detected grid points for schlieren grid image.

2.2.2 Overlaying Images

The images were not able to be aligned directly by overlaying a single grid point due to the diﬀerence
in the location of the gridpoints relative to the test article. This diﬀerence is an artifact of projection
error applied to the normal distance between the physical grid and test article. The grid image was
installed in front of the test section, and the fuel grain sits within the test section, thus, the location

4

of the gridpoints relative to the fuel grain as seen by the OH* camera was diﬀerent to the location
of those same points in the schlieren images. As an example, the point immediately ahead of the
fuel grain in the schlieren image would typically sit within the fuel grain in the OH* image. An
alternative alignment approach was required. Initially, cross correlation of the two images was the
intended alignment method, however, the slight distortion of the fuel grain leading edge proﬁle in
the OH* images resulting from re-projection of the image led to a very low signal to noise ratio in
the phase correlation. Thus, a clear cross correlation peak corresponding to the alignment of the
two images was not always able to be identiﬁed. Instead, simple minimization of squared diﬀerence
per pixel between the images was used in order to align them. The fore end of the fuel grain is the
region around which accuracy is required, and thus only the region around the front of the fuel grain
was used to align the OH* images to the full schlieren images. Care had to be taken to only look at
the overlapping region of the two images. This approach worked successfully for aligning the images
in all 11 tests.

Following alignment, it was desirable to display the aligned schlieren and OH* images using a
custom colormap to false-color the OH* images. Matlab does not allow the use of two distinct
colormaps to be used in a single ﬁgure. Thus, in order to display greyscale schlieren images overlaid
with false-color OH* images, the schlieren images were converted to RGB with equal weights in all
three components, producing the desired greyscale image. The OH* images were overlaid over the
schlieren image with the custom violet colormap and a transparency of 50%. An example of the
ﬁgures produced with these display properties is shown in Figure 6.

Figure 6: Example overlaid schlieren and OH* image. The image shown is for the combustion of
BP and oxygen at elevated pressure.

2.3 OH* Intensity

The mean intensity within the OH* chemiluminescence images was investigated in order to quantify
the burn time, and compare that with the burn time determined from the pressure trace. The
variations in mean intensity with time also give insight into the unstable nature of the ﬂames. The
approach for this work was very straightforward, the mean pixel value for each image was calculated
across the entire re-projected image. The values of mean intensity were then normalized to range
from 0 to 1. Future work for this task will focus on overlaying the results of this analysis with the
combustion chamber pressure versus time trace in order to investigate the correlation between the
number of OH* radicals and the chamber pressure.

2.4 Edge Detection

One of the major contributions from the combustion visualization tests is the quantiﬁcation of the
growth rate of the turbulent boundary layer, and the ﬂame location within that boundary layer, for
typical hybrid motor operating conditions.

2.4.1 Fuel Grain

The fuel grain location was initially estimated from the proﬁle of the fuel grain prior to ignition.
The ﬁrst schlieren image for each test was used for this purpose. The image was gaussian ﬁltered

5

then binarized using Otsu’s method. Following binarization, small dark regions and white holes were
removed. The Canny edge detector was then applied to trace the fuel grain proﬁle. The Canny edge
detector ﬁrst smooths the image with a Gaussian ﬁlter, in this case a standard deviation of σ = 1.1
was used for the ﬁltering operation. The Canny edge detector approximates gradient magnitude
and angle across the image, applies non-maxima suppression to the gradient magnitude, then uses
double thresholding to detect strong and weak edge pixels. All weak edge pixels not connected with
strong edge pixels are rejected. Thresholds of 0.2 and 0.5 were found to be successful threshold
values for the weak and strong edges, respectively. Following the application of the edge detector
the region surrounding the fuel grain was then isolated to remove undesired window edges around
the periphery of the image. This approach with these inputs successfully identiﬁed the fuel grain
edge in the ﬁrst schlieren image for all tests. An example of the resulting fuel grain trace is shown
in Figure 7.

Figure 7: Fuel grain edge detection overlaid on grayscale schlieren image. The image shown is for
the combustion of BP and oxygen at elevated pressure.

2.4.2 Flame Location

The ﬂame location was quantiﬁed by looking at the mean OH* chemiluminescence images. Hybrid
rocket combustion theory assumes an inﬁnitely thin ﬂame sheet. Thus, the ﬁrst step in quantifying
the ﬂame location involved approximating the combustion zone as a region of unit pixel thickness.
The location of the ﬂame was assumed to be the location of peak OH* intensity within each column
in the vicinity of the the fuel grain. In order to avoid the inclusion of noisy points far from the
main ﬂame front, each column was only included if the peak intensity exceeded a threshold of 0.05.
Future work should look at evaluating the thickness of the ﬂame sheet by investigating the vertical
distribution of the ﬂame at various points along the fuel grain.

Figure 8: Flame location identiﬁcation overlaid on OH* image with custom colormap. The image
shown is for the combustion of BP and oxygen at elevated pressure.

2.4.3 Boundary Layer

Detecting the boundary layer in the mean images proved somewhat challenging.
In general the
variations in image intensity within the freestream are less than those within the boundary layer
and the boundary between these two regions can easily be identiﬁed with the naked eye. However,

6

all attempts to use this knowledge to directly diﬀerentiate and/or threshold the image proved un-
successful. The direct application of standard edge detectors and ﬁlters covered in EE368 could not
be applied as these methods always picked up on features and gradients in the freestream and within
the boundary layer. This is an issue that has been encountered by others working with schlieren
images, see references [4, 5, 6]. The approach that proved successful for this work involved the
adoption of the 2D bilateral ﬁlter adopted by Smith [7, 4, 5] as well as the use of the matlab entropy
ﬁlter [8].

The 2D bilaterial ﬁlter is an edge preserving ﬁlter that minimizes the diﬀerence in like regions
whilst preserving strong edges [7]. The bilateral ﬁlter applies a Gaussian kernal on the domain and
range of the image, for this work standard deviations of σd = 4 and σr = 0.1 were used for the
domain and range respectively. The width of the kernal was deﬁned to be w = 3σd + 1. The aﬀect
of the bilateral ﬁlter on the mean schlieren image and the entropy ﬁltered image is shown in Figure
9. The matlab entropy ﬁlter was applied after bilateral ﬁltering using a disk structuring element
with a radius of 3 pixels. The entropy ﬁlter converts each pixel location to a value representing the
statistical measure of randomness in the region around that pixel. The entropy ﬁlter is sensitive to
noise and thus the application of the bilateral ﬁlter prior to applying the entropy ﬁlter was required.
This can be most clearly seen by looking at the result of entropy ﬁltering with and without bilateral
ﬁltering, Figure 9. The output values from the entropy ﬁlter were scaled to the default range for a
greyscale image and the image was binarized using Otsu’s method. Small and medium regions less
than 1000 pixels in size were then removed. The high intensity region of the image, corresponding to
the boundary layer, was eroded using a disk structuring element of radius 10 in order to counter the
dilative eﬀect of the entropy ﬁlter. The Canny edge detector was then applied using σ = 1.1 again
for the Gaussian ﬁlter along with weak and strong edge thresholds of 0.1 and 0.5, respectively. The
region around the fuel grain was isolated and small positive regions less than 500 pixels in size were
again removed. The second application of small region removal was required to remove any edges
that were previously connected to the window frame. This approach isolated edges around the the
boundary layer and the base of the fuel grain. The x,y locations of this edge were found and the
upper region, corresponding to the boundary layer edge, was isolated.

(a) Raw Schlieren Image

(b) Schlieren Image Bilateral Filter

(c) Schlieren Image Entropy Filter

(d) Schlieren Image Bilateral then Entropy Filter

Figure 9: Test 26. Eﬀect of bilateral and entropy ﬁlters on schlieren image. The image shown is for
the combustion of BP and oxygen at elevated pressure.

3 Results

The projection and alignment code was successfully implemented on all images (11 tests with 14,207
schlieren images and 16,386 OH* chemiluminescence images).

The edge detection algorithm described above was applied to numerous test images. The algo-
rithm appeared to perform well on individual images of both atmospheric chamber pressure and

7

Visualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

4 outside of the pass band, blocks most of the black body emission from soot and chemilumenscence
from other species (e.g. CH*) [2]. Therefore, by collecting the OH* emission, we obtain a global,
path-integrated image of the reaction zone.

Figure 2: Schematic of test set-up with imaging equipment.

An example of each of the raw images is shown in Figure 3. At the outset of this project the
author had access to data from 29 tests, this project focuses on the analysis of images from 11 of
these tests (Test 13 - Test 23), and in particular on the analysis of the 14,207 schlieren images and
16,386 OH* chemiluminescence images collected for each of these tests. Note that the number of
OH* chemiluminescence images exceeds the number of schlieren images due to the greater amount
of on-board storage on the Photron APX i2 camera as compared to the MotionPro X3 Plus. This
work was divided into a number of tasks and subtasks, all aimed towards applying the techniques
covered in EE278 in order to better understand the combustion process with hybrid rocket motors.
The speciﬁc tasks and the approach taken toward achieving them are discussed in the methodology.

2 Methodology

2.1 Correcting OH* Images

The UV sensitive Photron APX i2 camera used to collect the OH* images was slightly damaged,
resulting in bad pixel values in certain columns within each image. An example of the raw images
produced by the camera is show in Figure 4. The damaged pixels occupied speciﬁc columns within
each image but the number and location of the columns that were aﬀected varied from test to
test. The values of the damaged pixels did not remain constant, they could occupy any value from
0 to 1. Extensive analysis of the raw images revealed that although the columns containing the
damaged pixels varied, they were always a subset of the same group of columns. Any columns
that contained any values exactly equal to 0 or 1 typically represented damaged columns, as with
normal operation the camera was not saturating or underexposed. All columns that contained these
values were identiﬁed for each test. These potentially damaged columns were then compared across
all tests, and any columns that appeared to be damaged in multiple tests were ﬂagged. Code was
then developed to step through each of these columns and ﬁnd any pixels greater than 2 standard
deviations from the median of itself and the 2 pixels to either side. These pixels were replaced with
the mean value of the pixel to either side of it. This approach was adopted to minimize the aﬀect
of any standard ﬁltering operation on the undamaged majority of the OH* pixels. An example of
the results of this process is shown in Figure 4.

2.2 Aligning OH* and Schlieren Images

The schlieren and OH* images needed to be aligned in order to gain insight into where combustion
takes place within the turbulent boundary layer above hybrid rocket fuels. The process for doing
this was divided into two steps, ﬁrst projecting the images onto the same plane with the same scale,
then lining the images up by focusing on the alignment of the leading edge of the fuel grain.

2

O2Top viewSchlieren CameraOH* ChemiluminescenceColor Video Camera(a) Raw Color Image

(b) Raw OH* Image

Figure 3: Examples of raw image from each camera. Test shown is the combustion of BP with
gaseous oxygen at elevated pressure.

(c) Raw Schlieren Image

2.2.1 Projecting Images

The schlieren and OH* images were triggered together and recorded at the same frame rate. How-
ever, it was not possible to give both cameras a square view of the test section simultaneously. Some
projection error in the OH* images was inevitable since schlieren optics require a straight uninter-
rupted path through the test section. Figure 2 shows the test set-up and the location of the cameras.
It can be seen that the OH* camera does not sit perpendicular to the test section, but rather sits an
angle of approximately 15 degrees1. Future work could consider the use of a beam-splitter to negate
the need for this correction and to remove any bias in the OH* images resulting from integrating
the signal through an oﬀ-normal path; however, an appropriate beam-splitter was not available at
the time of this work.

A method was developed to remove projection error and to ensure consistent alignment of OH*
and schlieren images regardless of their scale. Grid images were taken prior to each test. The raw
OH* images were aﬀected by some noise, the signal to noise ratio in the OH* grids was improved
by taking the mean of many OH* grid images prior to analyzing them. The separation of the
gridpoints in ”real-space” is known apriori to be dx = 5.08 mm (0.2 in) and dy = 2.54 mm (0.1
in). The gridpoints are detected using a scheme originally developed by Miller [3] that was modiﬁed

1This projection angle is calculated by looking at the mean horizontal distortion of the OH* grid images

3

(a) Raw OH* Image

(b) OH* Image with Damaged Pixel Removal

Figure 4: Test 22. Grid image with and without damaged pixel removal.

for this purpose. The user must ﬁrst manually identify the three gridpoints in the bottom left of
the image. The algorithm then evaluates the pixel intensities around each of these points and ﬁts a
Gaussian to these intensities; the center of the gridpoint is taken as the center of the ﬁtted gaussian.
The extent of the region to be evaluated around the gridpoint is deﬁned to be a window of ±3 pixels.
The code then estimates the expected number of pixels between gridpoints (both in the horizontal
and vertical directions), estimates a new center for the next gridpoint, re-evaluates the Gaussian
in the region around this point and ﬁnds the new center location. This process is repeated across
each row and up all columns to be evaluated. Figure 5 shows an example of detected gridpoints
overlaid over the schlieren grid image.
In this way the code adjusts for any error introduced by
the user in selecting the original gridpoints or any distortion to the grid introduced by the optics.
After identiﬁcation, a 2D cubic polynomial is ﬁt to the location of all of the gridpoints to map the
x,y location in pixel space to the x,y location in real space. The location of the schlieren and OH*
pixels in real space is then known. However, this process has not yet projected the images onto the
same plane, it has simply determined the mapping of the images to their location in real space. The
schlieren and OH* images now need to be projected onto the same uniform grid in order to overlay
them. A uniform grid of x,y locations in real space is generated such that there is no reduction in
resolution for either image. For all images, a uniform grid was generated such that a single pixel
represents 0.1 mm in each direction. This typically scaled the images to a little over 1.5 times their
initial size. With this methodology, the schlieren and OH* images were transformed to have the
same size and scale, but in order to concurrently analyze and display them they needed to be aligned,
the approach for this is described in the following subsection.

Figure 5: Example of detected grid points for schlieren grid image.

2.2.2 Overlaying Images

The images were not able to be aligned directly by overlaying a single grid point due to the diﬀerence
in the location of the gridpoints relative to the test article. This diﬀerence is an artifact of projection
error applied to the normal distance between the physical grid and test article. The grid image was
installed in front of the test section, and the fuel grain sits within the test section, thus, the location

4

of the gridpoints relative to the fuel grain as seen by the OH* camera was diﬀerent to the location
of those same points in the schlieren images. As an example, the point immediately ahead of the
fuel grain in the schlieren image would typically sit within the fuel grain in the OH* image. An
alternative alignment approach was required. Initially, cross correlation of the two images was the
intended alignment method, however, the slight distortion of the fuel grain leading edge proﬁle in
the OH* images resulting from re-projection of the image led to a very low signal to noise ratio in
the phase correlation. Thus, a clear cross correlation peak corresponding to the alignment of the
two images was not always able to be identiﬁed. Instead, simple minimization of squared diﬀerence
per pixel between the images was used in order to align them. The fore end of the fuel grain is the
region around which accuracy is required, and thus only the region around the front of the fuel grain
was used to align the OH* images to the full schlieren images. Care had to be taken to only look at
the overlapping region of the two images. This approach worked successfully for aligning the images
in all 11 tests.

Following alignment, it was desirable to display the aligned schlieren and OH* images using a
custom colormap to false-color the OH* images. Matlab does not allow the use of two distinct
colormaps to be used in a single ﬁgure. Thus, in order to display greyscale schlieren images overlaid
with false-color OH* images, the schlieren images were converted to RGB with equal weights in all
three components, producing the desired greyscale image. The OH* images were overlaid over the
schlieren image with the custom violet colormap and a transparency of 50%. An example of the
ﬁgures produced with these display properties is shown in Figure 6.

Figure 6: Example overlaid schlieren and OH* image. The image shown is for the combustion of
BP and oxygen at elevated pressure.

2.3 OH* Intensity

The mean intensity within the OH* chemiluminescence images was investigated in order to quantify
the burn time, and compare that with the burn time determined from the pressure trace. The
variations in mean intensity with time also give insight into the unstable nature of the ﬂames. The
approach for this work was very straightforward, the mean pixel value for each image was calculated
across the entire re-projected image. The values of mean intensity were then normalized to range
from 0 to 1. Future work for this task will focus on overlaying the results of this analysis with the
combustion chamber pressure versus time trace in order to investigate the correlation between the
number of OH* radicals and the chamber pressure.

2.4 Edge Detection

One of the major contributions from the combustion visualization tests is the quantiﬁcation of the
growth rate of the turbulent boundary layer, and the ﬂame location within that boundary layer, for
typical hybrid motor operating conditions.

2.4.1 Fuel Grain

The fuel grain location was initially estimated from the proﬁle of the fuel grain prior to ignition.
The ﬁrst schlieren image for each test was used for this purpose. The image was gaussian ﬁltered

5

then binarized using Otsu’s method. Following binarization, small dark regions and white holes were
removed. The Canny edge detector was then applied to trace the fuel grain proﬁle. The Canny edge
detector ﬁrst smooths the image with a Gaussian ﬁlter, in this case a standard deviation of σ = 1.1
was used for the ﬁltering operation. The Canny edge detector approximates gradient magnitude
and angle across the image, applies non-maxima suppression to the gradient magnitude, then uses
double thresholding to detect strong and weak edge pixels. All weak edge pixels not connected with
strong edge pixels are rejected. Thresholds of 0.2 and 0.5 were found to be successful threshold
values for the weak and strong edges, respectively. Following the application of the edge detector
the region surrounding the fuel grain was then isolated to remove undesired window edges around
the periphery of the image. This approach with these inputs successfully identiﬁed the fuel grain
edge in the ﬁrst schlieren image for all tests. An example of the resulting fuel grain trace is shown
in Figure 7.

Figure 7: Fuel grain edge detection overlaid on grayscale schlieren image. The image shown is for
the combustion of BP and oxygen at elevated pressure.

2.4.2 Flame Location

The ﬂame location was quantiﬁed by looking at the mean OH* chemiluminescence images. Hybrid
rocket combustion theory assumes an inﬁnitely thin ﬂame sheet. Thus, the ﬁrst step in quantifying
the ﬂame location involved approximating the combustion zone as a region of unit pixel thickness.
The location of the ﬂame was assumed to be the location of peak OH* intensity within each column
in the vicinity of the the fuel grain. In order to avoid the inclusion of noisy points far from the
main ﬂame front, each column was only included if the peak intensity exceeded a threshold of 0.05.
Future work should look at evaluating the thickness of the ﬂame sheet by investigating the vertical
distribution of the ﬂame at various points along the fuel grain.

Figure 8: Flame location identiﬁcation overlaid on OH* image with custom colormap. The image
shown is for the combustion of BP and oxygen at elevated pressure.

2.4.3 Boundary Layer

Detecting the boundary layer in the mean images proved somewhat challenging.
In general the
variations in image intensity within the freestream are less than those within the boundary layer
and the boundary between these two regions can easily be identiﬁed with the naked eye. However,

6

all attempts to use this knowledge to directly diﬀerentiate and/or threshold the image proved un-
successful. The direct application of standard edge detectors and ﬁlters covered in EE368 could not
be applied as these methods always picked up on features and gradients in the freestream and within
the boundary layer. This is an issue that has been encountered by others working with schlieren
images, see references [4, 5, 6]. The approach that proved successful for this work involved the
adoption of the 2D bilateral ﬁlter adopted by Smith [7, 4, 5] as well as the use of the matlab entropy
ﬁlter [8].

The 2D bilaterial ﬁlter is an edge preserving ﬁlter that minimizes the diﬀerence in like regions
whilst preserving strong edges [7]. The bilateral ﬁlter applies a Gaussian kernal on the domain and
range of the image, for this work standard deviations of σd = 4 and σr = 0.1 were used for the
domain and range respectively. The width of the kernal was deﬁned to be w = 3σd + 1. The aﬀect
of the bilateral ﬁlter on the mean schlieren image and the entropy ﬁltered image is shown in Figure
9. The matlab entropy ﬁlter was applied after bilateral ﬁltering using a disk structuring element
with a radius of 3 pixels. The entropy ﬁlter converts each pixel location to a value representing the
statistical measure of randomness in the region around that pixel. The entropy ﬁlter is sensitive to
noise and thus the application of the bilateral ﬁlter prior to applying the entropy ﬁlter was required.
This can be most clearly seen by looking at the result of entropy ﬁltering with and without bilateral
ﬁltering, Figure 9. The output values from the entropy ﬁlter were scaled to the default range for a
greyscale image and the image was binarized using Otsu’s method. Small and medium regions less
than 1000 pixels in size were then removed. The high intensity region of the image, corresponding to
the boundary layer, was eroded using a disk structuring element of radius 10 in order to counter the
dilative eﬀect of the entropy ﬁlter. The Canny edge detector was then applied using σ = 1.1 again
for the Gaussian ﬁlter along with weak and strong edge thresholds of 0.1 and 0.5, respectively. The
region around the fuel grain was isolated and small positive regions less than 500 pixels in size were
again removed. The second application of small region removal was required to remove any edges
that were previously connected to the window frame. This approach isolated edges around the the
boundary layer and the base of the fuel grain. The x,y locations of this edge were found and the
upper region, corresponding to the boundary layer edge, was isolated.

(a) Raw Schlieren Image

(b) Schlieren Image Bilateral Filter

(c) Schlieren Image Entropy Filter

(d) Schlieren Image Bilateral then Entropy Filter

Figure 9: Test 26. Eﬀect of bilateral and entropy ﬁlters on schlieren image. The image shown is for
the combustion of BP and oxygen at elevated pressure.

3 Results

The projection and alignment code was successfully implemented on all images (11 tests with 14,207
schlieren images and 16,386 OH* chemiluminescence images).

The edge detection algorithm described above was applied to numerous test images. The algo-
rithm appeared to perform well on individual images of both atmospheric chamber pressure and

7

Figure 10: Test 26. Boundary layer edge detected overlaid on schlieren image. The image shown is
for the combustion of BP and oxygen at elevated pressure.

Figure 11: Test 26. Boundary layer edge, ﬂame location and original fuel grain shape overlaid on
grayscale schlieren and OH* image with 50% transparency and custom colormap. The image shown
is for the combustion of BP and oxygen at elevated pressure.

elevated chamber pressure tests. In order to reduce computation time, the mean proﬁles of many
consecutive images were analyzed. For atmospheric tests the edge detection analysis was conducted
on mean images of 50 consecutive images. Some example results are shown in Figure 12.

(a) Test 18. Clear HTPB

(b) Test 25. HTPB

(c) Test 19. HDPE

(d) Test 20. ABS

(e) Test 22. BP

Figure 12: Example edge detection results for 50 consecutive mean images during atmospheric
pressure tests.

There is signiﬁcant oscillation in the boundary layer thickness and OH* intensity within the
pressurized test images. The methodology described in this report did not successfully detect the
boundary layer edge for the pressurized test mean images, see Figure 13.

8

Visualization of Combustion

Within a Hybrid Rocket Motor

Elizabeth T. Jens: 05588428

EE 368: Final Project Report

Due Date: 5 June 2015

1

Introduction

A visualization facility has been developed at Stanford University in order to study ﬂow in a tur-
bulent combustion boundary layer. The motivation for the facility arises from recent studies of fast
burning fuels for hybrid rocket propulsion where droplet lift-oﬀ from the melting fuel surface is the
dominant mass transfer mechanism. The facility, shown in Figure 1, has been used to image the
combustion of various fuels with gaseous oxygen. Five classical fuels have been tested, speciﬁcally
Hydroxyl-Terminated PolyButadiene (HTPB) with 0.5% by mass carbon black, HTPB without
carbon black, High Density PolyEtheylene (HDPE), Acrylonitrile Butadiene Styrene (ABS), and
PolyMethyl MethAcrylate (PMMA) as well as a liquefying high regression rate fuel, speciﬁcally neat
paraﬃn with 0.5% by mass of black dye, referred to as Blackened Paraﬃn (BP).

Figure 1: Stanford Combustion Visualization Facility. Oxidizer ﬂow enters from the left and travels
through the ﬂow conditioning system before reaching the combustion chamber.

29 hot ﬁres were successfully conducted in the combustion visualization facility in 2014. High
speed color, schlieren and OH* chemiluminescence videos were recorded. Color videos are recorded
with Casio Exilim EX-F1 cameras at 1200 frames per second with a resolution of 96 x 336 pixels.
The schlieren imaging method adopted in this facility is the classical Z-type two mirror schlieren
system. This conﬁguration utilizes two identical mirrors with a focal length of 1.435 m set up in a
Z-formation, as shown in Figure 2. A MotionPro X3 Plus camera and a 105 mm Nikon lens with an
f -number of f/2.8 capture the schlieren images at 3000 frames per second with a resolution of 1080 ×
236 pixels, 13 µsec exposure time, and a camera gain of 2.0. Images of OH* chemiluminescence are
acquired at 3000 frames per second using a Photron APX i2 intensiﬁed camera, a 105 mm Nikkor
UV lens, and a high-transmission bandpass ﬁlter centered at 313 nm with a full-width half-max of 5
nm. All OH* images are acquired with an f -number of f/8 and a gain of 60% of the maximum gain
of the camera. Gate times were adjusted to maximize signal while minimizing the risk of saturating
the camera. At ambient pressure, the excited OH radical is primarily produced as a byproduct of
reaction rather than thermal excitation [1], and when the excited OH molecules relax back to the
ground state, they emit photons near 313 nm. The band-pass ﬁlter, which has an optical density of

1

4 outside of the pass band, blocks most of the black body emission from soot and chemilumenscence
from other species (e.g. CH*) [2]. Therefore, by collecting the OH* emission, we obtain a global,
path-integrated image of the reaction zone.

Figure 2: Schematic of test set-up with imaging equipment.

An example of each of the raw images is shown in Figure 3. At the outset of this project the
author had access to data from 29 tests, this project focuses on the analysis of images from 11 of
these tests (Test 13 - Test 23), and in particular on the analysis of the 14,207 schlieren images and
16,386 OH* chemiluminescence images collected for each of these tests. Note that the number of
OH* chemiluminescence images exceeds the number of schlieren images due to the greater amount
of on-board storage on the Photron APX i2 camera as compared to the MotionPro X3 Plus. This
work was divided into a number of tasks and subtasks, all aimed towards applying the techniques
covered in EE278 in order to better understand the combustion process with hybrid rocket motors.
The speciﬁc tasks and the approach taken toward achieving them are discussed in the methodology.

2 Methodology

2.1 Correcting OH* Images

The UV sensitive Photron APX i2 camera used to collect the OH* images was slightly damaged,
resulting in bad pixel values in certain columns within each image. An example of the raw images
produced by the camera is show in Figure 4. The damaged pixels occupied speciﬁc columns within
each image but the number and location of the columns that were aﬀected varied from test to
test. The values of the damaged pixels did not remain constant, they could occupy any value from
0 to 1. Extensive analysis of the raw images revealed that although the columns containing the
damaged pixels varied, they were always a subset of the same group of columns. Any columns
that contained any values exactly equal to 0 or 1 typically represented damaged columns, as with
normal operation the camera was not saturating or underexposed. All columns that contained these
values were identiﬁed for each test. These potentially damaged columns were then compared across
all tests, and any columns that appeared to be damaged in multiple tests were ﬂagged. Code was
then developed to step through each of these columns and ﬁnd any pixels greater than 2 standard
deviations from the median of itself and the 2 pixels to either side. These pixels were replaced with
the mean value of the pixel to either side of it. This approach was adopted to minimize the aﬀect
of any standard ﬁltering operation on the undamaged majority of the OH* pixels. An example of
the results of this process is shown in Figure 4.

2.2 Aligning OH* and Schlieren Images

The schlieren and OH* images needed to be aligned in order to gain insight into where combustion
takes place within the turbulent boundary layer above hybrid rocket fuels. The process for doing
this was divided into two steps, ﬁrst projecting the images onto the same plane with the same scale,
then lining the images up by focusing on the alignment of the leading edge of the fuel grain.

2

O2Top viewSchlieren CameraOH* ChemiluminescenceColor Video Camera(a) Raw Color Image

(b) Raw OH* Image

Figure 3: Examples of raw image from each camera. Test shown is the combustion of BP with
gaseous oxygen at elevated pressure.

(c) Raw Schlieren Image

2.2.1 Projecting Images

The schlieren and OH* images were triggered together and recorded at the same frame rate. How-
ever, it was not possible to give both cameras a square view of the test section simultaneously. Some
projection error in the OH* images was inevitable since schlieren optics require a straight uninter-
rupted path through the test section. Figure 2 shows the test set-up and the location of the cameras.
It can be seen that the OH* camera does not sit perpendicular to the test section, but rather sits an
angle of approximately 15 degrees1. Future work could consider the use of a beam-splitter to negate
the need for this correction and to remove any bias in the OH* images resulting from integrating
the signal through an oﬀ-normal path; however, an appropriate beam-splitter was not available at
the time of this work.

A method was developed to remove projection error and to ensure consistent alignment of OH*
and schlieren images regardless of their scale. Grid images were taken prior to each test. The raw
OH* images were aﬀected by some noise, the signal to noise ratio in the OH* grids was improved
by taking the mean of many OH* grid images prior to analyzing them. The separation of the
gridpoints in ”real-space” is known apriori to be dx = 5.08 mm (0.2 in) and dy = 2.54 mm (0.1
in). The gridpoints are detected using a scheme originally developed by Miller [3] that was modiﬁed

1This projection angle is calculated by looking at the mean horizontal distortion of the OH* grid images

3

(a) Raw OH* Image

(b) OH* Image with Damaged Pixel Removal

Figure 4: Test 22. Grid image with and without damaged pixel removal.

for this purpose. The user must ﬁrst manually identify the three gridpoints in the bottom left of
the image. The algorithm then evaluates the pixel intensities around each of these points and ﬁts a
Gaussian to these intensities; the center of the gridpoint is taken as the center of the ﬁtted gaussian.
The extent of the region to be evaluated around the gridpoint is deﬁned to be a window of ±3 pixels.
The code then estimates the expected number of pixels between gridpoints (both in the horizontal
and vertical directions), estimates a new center for the next gridpoint, re-evaluates the Gaussian
in the region around this point and ﬁnds the new center location. This process is repeated across
each row and up all columns to be evaluated. Figure 5 shows an example of detected gridpoints
overlaid over the schlieren grid image.
In this way the code adjusts for any error introduced by
the user in selecting the original gridpoints or any distortion to the grid introduced by the optics.
After identiﬁcation, a 2D cubic polynomial is ﬁt to the location of all of the gridpoints to map the
x,y location in pixel space to the x,y location in real space. The location of the schlieren and OH*
pixels in real space is then known. However, this process has not yet projected the images onto the
same plane, it has simply determined the mapping of the images to their location in real space. The
schlieren and OH* images now need to be projected onto the same uniform grid in order to overlay
them. A uniform grid of x,y locations in real space is generated such that there is no reduction in
resolution for either image. For all images, a uniform grid was generated such that a single pixel
represents 0.1 mm in each direction. This typically scaled the images to a little over 1.5 times their
initial size. With this methodology, the schlieren and OH* images were transformed to have the
same size and scale, but in order to concurrently analyze and display them they needed to be aligned,
the approach for this is described in the following subsection.

Figure 5: Example of detected grid points for schlieren grid image.

2.2.2 Overlaying Images

The images were not able to be aligned directly by overlaying a single grid point due to the diﬀerence
in the location of the gridpoints relative to the test article. This diﬀerence is an artifact of projection
error applied to the normal distance between the physical grid and test article. The grid image was
installed in front of the test section, and the fuel grain sits within the test section, thus, the location

4

of the gridpoints relative to the fuel grain as seen by the OH* camera was diﬀerent to the location
of those same points in the schlieren images. As an example, the point immediately ahead of the
fuel grain in the schlieren image would typically sit within the fuel grain in the OH* image. An
alternative alignment approach was required. Initially, cross correlation of the two images was the
intended alignment method, however, the slight distortion of the fuel grain leading edge proﬁle in
the OH* images resulting from re-projection of the image led to a very low signal to noise ratio in
the phase correlation. Thus, a clear cross correlation peak corresponding to the alignment of the
two images was not always able to be identiﬁed. Instead, simple minimization of squared diﬀerence
per pixel between the images was used in order to align them. The fore end of the fuel grain is the
region around which accuracy is required, and thus only the region around the front of the fuel grain
was used to align the OH* images to the full schlieren images. Care had to be taken to only look at
the overlapping region of the two images. This approach worked successfully for aligning the images
in all 11 tests.

Following alignment, it was desirable to display the aligned schlieren and OH* images using a
custom colormap to false-color the OH* images. Matlab does not allow the use of two distinct
colormaps to be used in a single ﬁgure. Thus, in order to display greyscale schlieren images overlaid
with false-color OH* images, the schlieren images were converted to RGB with equal weights in all
three components, producing the desired greyscale image. The OH* images were overlaid over the
schlieren image with the custom violet colormap and a transparency of 50%. An example of the
ﬁgures produced with these display properties is shown in Figure 6.

Figure 6: Example overlaid schlieren and OH* image. The image shown is for the combustion of
BP and oxygen at elevated pressure.

2.3 OH* Intensity

The mean intensity within the OH* chemiluminescence images was investigated in order to quantify
the burn time, and compare that with the burn time determined from the pressure trace. The
variations in mean intensity with time also give insight into the unstable nature of the ﬂames. The
approach for this work was very straightforward, the mean pixel value for each image was calculated
across the entire re-projected image. The values of mean intensity were then normalized to range
from 0 to 1. Future work for this task will focus on overlaying the results of this analysis with the
combustion chamber pressure versus time trace in order to investigate the correlation between the
number of OH* radicals and the chamber pressure.

2.4 Edge Detection

One of the major contributions from the combustion visualization tests is the quantiﬁcation of the
growth rate of the turbulent boundary layer, and the ﬂame location within that boundary layer, for
typical hybrid motor operating conditions.

2.4.1 Fuel Grain

The fuel grain location was initially estimated from the proﬁle of the fuel grain prior to ignition.
The ﬁrst schlieren image for each test was used for this purpose. The image was gaussian ﬁltered

5

then binarized using Otsu’s method. Following binarization, small dark regions and white holes were
removed. The Canny edge detector was then applied to trace the fuel grain proﬁle. The Canny edge
detector ﬁrst smooths the image with a Gaussian ﬁlter, in this case a standard deviation of σ = 1.1
was used for the ﬁltering operation. The Canny edge detector approximates gradient magnitude
and angle across the image, applies non-maxima suppression to the gradient magnitude, then uses
double thresholding to detect strong and weak edge pixels. All weak edge pixels not connected with
strong edge pixels are rejected. Thresholds of 0.2 and 0.5 were found to be successful threshold
values for the weak and strong edges, respectively. Following the application of the edge detector
the region surrounding the fuel grain was then isolated to remove undesired window edges around
the periphery of the image. This approach with these inputs successfully identiﬁed the fuel grain
edge in the ﬁrst schlieren image for all tests. An example of the resulting fuel grain trace is shown
in Figure 7.

Figure 7: Fuel grain edge detection overlaid on grayscale schlieren image. The image shown is for
the combustion of BP and oxygen at elevated pressure.

2.4.2 Flame Location

The ﬂame location was quantiﬁed by looking at the mean OH* chemiluminescence images. Hybrid
rocket combustion theory assumes an inﬁnitely thin ﬂame sheet. Thus, the ﬁrst step in quantifying
the ﬂame location involved approximating the combustion zone as a region of unit pixel thickness.
The location of the ﬂame was assumed to be the location of peak OH* intensity within each column
in the vicinity of the the fuel grain. In order to avoid the inclusion of noisy points far from the
main ﬂame front, each column was only included if the peak intensity exceeded a threshold of 0.05.
Future work should look at evaluating the thickness of the ﬂame sheet by investigating the vertical
distribution of the ﬂame at various points along the fuel grain.

Figure 8: Flame location identiﬁcation overlaid on OH* image with custom colormap. The image
shown is for the combustion of BP and oxygen at elevated pressure.

2.4.3 Boundary Layer

Detecting the boundary layer in the mean images proved somewhat challenging.
In general the
variations in image intensity within the freestream are less than those within the boundary layer
and the boundary between these two regions can easily be identiﬁed with the naked eye. However,

6

all attempts to use this knowledge to directly diﬀerentiate and/or threshold the image proved un-
successful. The direct application of standard edge detectors and ﬁlters covered in EE368 could not
be applied as these methods always picked up on features and gradients in the freestream and within
the boundary layer. This is an issue that has been encountered by others working with schlieren
images, see references [4, 5, 6]. The approach that proved successful for this work involved the
adoption of the 2D bilateral ﬁlter adopted by Smith [7, 4, 5] as well as the use of the matlab entropy
ﬁlter [8].

The 2D bilaterial ﬁlter is an edge preserving ﬁlter that minimizes the diﬀerence in like regions
whilst preserving strong edges [7]. The bilateral ﬁlter applies a Gaussian kernal on the domain and
range of the image, for this work standard deviations of σd = 4 and σr = 0.1 were used for the
domain and range respectively. The width of the kernal was deﬁned to be w = 3σd + 1. The aﬀect
of the bilateral ﬁlter on the mean schlieren image and the entropy ﬁltered image is shown in Figure
9. The matlab entropy ﬁlter was applied after bilateral ﬁltering using a disk structuring element
with a radius of 3 pixels. The entropy ﬁlter converts each pixel location to a value representing the
statistical measure of randomness in the region around that pixel. The entropy ﬁlter is sensitive to
noise and thus the application of the bilateral ﬁlter prior to applying the entropy ﬁlter was required.
This can be most clearly seen by looking at the result of entropy ﬁltering with and without bilateral
ﬁltering, Figure 9. The output values from the entropy ﬁlter were scaled to the default range for a
greyscale image and the image was binarized using Otsu’s method. Small and medium regions less
than 1000 pixels in size were then removed. The high intensity region of the image, corresponding to
the boundary layer, was eroded using a disk structuring element of radius 10 in order to counter the
dilative eﬀect of the entropy ﬁlter. The Canny edge detector was then applied using σ = 1.1 again
for the Gaussian ﬁlter along with weak and strong edge thresholds of 0.1 and 0.5, respectively. The
region around the fuel grain was isolated and small positive regions less than 500 pixels in size were
again removed. The second application of small region removal was required to remove any edges
that were previously connected to the window frame. This approach isolated edges around the the
boundary layer and the base of the fuel grain. The x,y locations of this edge were found and the
upper region, corresponding to the boundary layer edge, was isolated.

(a) Raw Schlieren Image

(b) Schlieren Image Bilateral Filter

(c) Schlieren Image Entropy Filter

(d) Schlieren Image Bilateral then Entropy Filter

Figure 9: Test 26. Eﬀect of bilateral and entropy ﬁlters on schlieren image. The image shown is for
the combustion of BP and oxygen at elevated pressure.

3 Results

The projection and alignment code was successfully implemented on all images (11 tests with 14,207
schlieren images and 16,386 OH* chemiluminescence images).

The edge detection algorithm described above was applied to numerous test images. The algo-
rithm appeared to perform well on individual images of both atmospheric chamber pressure and

7

Figure 10: Test 26. Boundary layer edge detected overlaid on schlieren image. The image shown is
for the combustion of BP and oxygen at elevated pressure.

Figure 11: Test 26. Boundary layer edge, ﬂame location and original fuel grain shape overlaid on
grayscale schlieren and OH* image with 50% transparency and custom colormap. The image shown
is for the combustion of BP and oxygen at elevated pressure.

elevated chamber pressure tests. In order to reduce computation time, the mean proﬁles of many
consecutive images were analyzed. For atmospheric tests the edge detection analysis was conducted
on mean images of 50 consecutive images. Some example results are shown in Figure 12.

(a) Test 18. Clear HTPB

(b) Test 25. HTPB

(c) Test 19. HDPE

(d) Test 20. ABS

(e) Test 22. BP

Figure 12: Example edge detection results for 50 consecutive mean images during atmospheric
pressure tests.

There is signiﬁcant oscillation in the boundary layer thickness and OH* intensity within the
pressurized test images. The methodology described in this report did not successfully detect the
boundary layer edge for the pressurized test mean images, see Figure 13.

8

Figure 13: Test 26. Example failed attempt at edge detection for 50 consecutive mean images during
elevated pressure test.

4 Future Work

The next major challenge in the work is approximating the instantaneous fuel grain location during
a test. This cannot be directly inferred from the images and so will need to be estimated using
hybrid combustion theory. Once the code for this is in place, the image processing code and the fuel
location calculations will need to be run across thousands of images for each test.

References

[1] Hall, J. M. and Petersen, E. L., “An optimized kinetics model for OH chemiluminescence at high
temperatures and atmospheric pressures,” International Journal of Chemical Kinetics, Vol. 38,
No. 12, 2006, pp. 714–724.

[2] Kojima, J., Ikeda, Y., and Nakajima, T., “Spatially resolved measurement of OH*, CH*, and C2*
chemiluminescence in the reaction zone of laminar methane/air premixed ﬂames,” Symposium
(International) on Combustion, Vol. 28, No. 2, 2000, pp. 1757–1764.

[3] Miller, V. A., High-speed Tracer-based PLIF Imaging for Scramjet Ground Testing, Ph.D. thesis,

Stanford University, 2014.

[4] Smith, N. T., Lewis, M. J., and Chellappa, R., “Extraction of Oblique Structures in Noisy
Schlieren Sequences Using Computer Vision Techniques,” AIAA journal , Vol. 50, No. 5, 2012,
pp. 1145–1155.

[5] Smith, N. T., Schlieren sequence analysis using computer vision, Ph.D. thesis, University of

Maryland, 2013.

[6] Smith, N. T., Lewis, M. J., and Chellappa, R., “Detection, Localization, and Tracking of Shock
Contour Salient Points in Schlieren Sequences,” AIAA journal , Vol. 52, No. 6, 2014, pp. 1249–
1264.

[7] Tomasi, C. and Manduchi, R., “Bilateral ﬁltering for gray and color images,” Computer Vision,

1998. Sixth International Conference on, IEEE, 1998, pp. 839–846.

[8] Gonzalez, R. C., Woods, R. E., and Eddins, S. L., Digital image processing using MATLAB ,

Pearson Education India, 2004.

9


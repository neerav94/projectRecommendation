Compressed Sensing Reconstructions for

Dynamic Contrast Enhanced MRI

1

Kevin T. Looby

klooby@stanford.edu

ABSTRACT

The temporal resolution necessary for dy-
namic contrast enhanced (DCE) magnetic reso-
nance imaging (MRI) requires scan accelerations
of more than 8× a typical scan time [1]. Ag-
gressive undersampling during data acquisition
can facilitate adequate temporal resolution at the
cost of reduced spatial resolution. [1] presents a
method for attaining the MR accelerations nec-
essary while preserving spatial resolution via
compressed sensing methods. This project seeks
to implement this method with an additional
compressed sensing component.

I. BACKGROUND

A. Dynamic Contrast Enhanced MRI

Dynamic contrast enhanced magnetic reso-
nance imaging allows for the characterization of
lesions (e.g., tumors, damaged tissue, etc.) as well
as examination of the performance of the renal
system. Visualization of the ﬂow dynamics of
contrast agents throughout tissues over time can
be used for tissue evaluation and characterization
based on the tissue uptake rates of the contrast
agents.

Contrast agent uptake typically completes
within a few minutes, about an order of magni-
tude faster than the scan rate of a conventional
full-resolution MR acquisition. The problem is
compounded in pediatric DCE MRI, as the ﬂow
dynamics occur over shorter time periods in very
young patients. Parallel imaging acquisitions un-
dersampled at a factor of 18× can achieve a
temporal resolution of roughly 3 seconds, which
is sufﬁcient for pediatric DCE MRI [1].

B. Parallel MRI Reconstructions with SPIRiT

SPIRiT (Iterative Self-consistent Parallel Imag-
ing Reconstruction) is a parallel imaging recon-
struction technique used to reconstruct multi-coil
MR datasets. The algorithm uses a projection onto
convex sets type approach similar to those to be
detailed in sections II.c1 and II.c2 in order to uti-
lize data redundancy from the multiple receiver
channels to form an accurate reconstruction.

The details of this method are not the focus
of this project and will not be discussed further,
but as SPIRiT forms an integral component of
my procedure,
it is important that this basic
explanation be given in advance. A MATLAB
implementation of SPIRiT was provided courtesy
of Michael Lustig and John Pauly.

II. METHODS

Materials

All datasets used in this project were provided
courtesy of Tao Zhang and John Pauly, both of
Stanford’s Magnetic Resonance Systems Research
Lab (MRSRL). Two sets of two-dimensional pe-
diatric abdominal cross-section dynamic contrast
enhanced datasets were provided and a dy-
namic contrast enhanced image phantom were
provided. MATLAB code for performing SPIRiT
[2] reconstructions and wavelet transforms were
made available by Michael Lustig and John Pauly.

Procedure Outline

A brief overview of the proposed data restora-
tion and reconstruction method is provided. The
following sections will elaborate further on each
step.

1) Choose appropriate undersampling pattern
2) Acquire parallel DCE MR data with chosen

3) Compress coils with eigenspace representa-

sampling

tion

4) Perform SPIRiT reconstruction with spatial
and temporal compressed sensing data con-
sistency enforcement+

5) Combine multi-coil data and form ﬁnal re-

construction

Compressed Sensing Reconstructions for

Dynamic Contrast Enhanced MRI

1

Kevin T. Looby

klooby@stanford.edu

ABSTRACT

The temporal resolution necessary for dy-
namic contrast enhanced (DCE) magnetic reso-
nance imaging (MRI) requires scan accelerations
of more than 8× a typical scan time [1]. Ag-
gressive undersampling during data acquisition
can facilitate adequate temporal resolution at the
cost of reduced spatial resolution. [1] presents a
method for attaining the MR accelerations nec-
essary while preserving spatial resolution via
compressed sensing methods. This project seeks
to implement this method with an additional
compressed sensing component.

I. BACKGROUND

A. Dynamic Contrast Enhanced MRI

Dynamic contrast enhanced magnetic reso-
nance imaging allows for the characterization of
lesions (e.g., tumors, damaged tissue, etc.) as well
as examination of the performance of the renal
system. Visualization of the ﬂow dynamics of
contrast agents throughout tissues over time can
be used for tissue evaluation and characterization
based on the tissue uptake rates of the contrast
agents.

Contrast agent uptake typically completes
within a few minutes, about an order of magni-
tude faster than the scan rate of a conventional
full-resolution MR acquisition. The problem is
compounded in pediatric DCE MRI, as the ﬂow
dynamics occur over shorter time periods in very
young patients. Parallel imaging acquisitions un-
dersampled at a factor of 18× can achieve a
temporal resolution of roughly 3 seconds, which
is sufﬁcient for pediatric DCE MRI [1].

B. Parallel MRI Reconstructions with SPIRiT

SPIRiT (Iterative Self-consistent Parallel Imag-
ing Reconstruction) is a parallel imaging recon-
struction technique used to reconstruct multi-coil
MR datasets. The algorithm uses a projection onto
convex sets type approach similar to those to be
detailed in sections II.c1 and II.c2 in order to uti-
lize data redundancy from the multiple receiver
channels to form an accurate reconstruction.

The details of this method are not the focus
of this project and will not be discussed further,
but as SPIRiT forms an integral component of
my procedure,
it is important that this basic
explanation be given in advance. A MATLAB
implementation of SPIRiT was provided courtesy
of Michael Lustig and John Pauly.

II. METHODS

Materials

All datasets used in this project were provided
courtesy of Tao Zhang and John Pauly, both of
Stanford’s Magnetic Resonance Systems Research
Lab (MRSRL). Two sets of two-dimensional pe-
diatric abdominal cross-section dynamic contrast
enhanced datasets were provided and a dy-
namic contrast enhanced image phantom were
provided. MATLAB code for performing SPIRiT
[2] reconstructions and wavelet transforms were
made available by Michael Lustig and John Pauly.

Procedure Outline

A brief overview of the proposed data restora-
tion and reconstruction method is provided. The
following sections will elaborate further on each
step.

1) Choose appropriate undersampling pattern
2) Acquire parallel DCE MR data with chosen

3) Compress coils with eigenspace representa-

sampling

tion

4) Perform SPIRiT reconstruction with spatial
and temporal compressed sensing data con-
sistency enforcement+

5) Combine multi-coil data and form ﬁnal re-

construction

A. Undersampling

The attainable results of the proposed method
depend heavily on the choice of undersampling
pattern. The denoising steps described later are
all of projection on convex sets (POCS) type algo-
rithms. As will be discussed in further detail, the
undersampling pattern should be chosen in order
to produce aliasing artifacts with characteristics
similar to incoherent white noise. The POCS algo-
rithms seek to iteratively reduce the noise levels
while maintaining the power of the true signal.
This is best achieved with low-power incoherent
white noise.

By nature, aliasing artifacts produce image
noise with inherent coherence. In the case of uni-
form undersampling, the aliasing artifacts pro-
duced are exact replicas of the original signal,
and are therefore highly coherent. Because the
aliasing replicas have similar power character-
istics to the true signal, POCS algorithms will
be unable to remove any noise. However, more
strategically-chosen undersampling methods can
produce lower noise ﬂoors. The following charac-
teristics describe a sampling scheme that will pro-
duce aliasing with the desired incoherent white
noise similarity:
• Randomness
• Variable density, particularly higher-density
of samples in lower spatial frequency com-
ponents

• Maximal coverage of k-space
Figure 1 shows a fully sampled DCE MR
phantom reconstruction and its Fourier transform
along with four k-space undersamplings and
their multi-coil inverse Fourier transform recon-
structions. The reconstructions were performed as
the per-pixel square root of the sum of the cross-
coil image intensity values. That is,

(cid:115)(cid:88)

I[x, y] =

|F−1(kc[x, y])|,

(1)

c

where I denotes the reconstructed image, c the
set of coils, kc the k-space data for each coil, and
F−1 the inverse Fourier transform operator. For
each sampling scheme, the phantom dataset has
been undersampled by a factor of 16, meaning
that only one sixteenth of the original data is kept.
A qualitative examination of the reconstruction
from the variable-density Poisson disk undersam-
pling shows that this sampling pattern achieves
the desired characteristics. The variable-density
Poisson disk sampling utilizes random sampling,
with larger sample density at lower spatial fre-
quencies. Additional k-space coverage is obtained
by enforcing the additional constraint that no
sampled point can be within a predeﬁned dis-
tance of any other sampled point. This is the sam-

2

pling method used in [1], and all reconstructions
shown throughout the remainder of this paper
will be performed on Poisson disk undersampled
datasets.

Fig. 1.
k-space sampling schemes (top row, from left-to-
right: fully-sampled, uniform undersampling, spiral under-
sampling, random uniform-density undersampling, variable-
density Poisson disk undersampling) with corresponding
multi-coil inverse Fourier transform reconstructions (bottom
row). Coils were combined as the per-pixel square root of
the sum of the cross-coil intensity values. Note: each k-space
sampling scheme shown additionally includes the 16 × 16
block of lowest spatial frequencies. This block is referred to
as the ”calibration region” and is necessary for self-calibrating
parallel MR reconstructions (e.g., SPIRiT) [2].

B. Parallel Imaging

Parallel

imaging has long been used as a
method for MRI acceleration. In a parallel MR
acquisition, data is acquired on multiple receiver
coils, each of which captures the volume with
varying regional sensitivity. That is, each coil
senses a particular region of the volume with high
sensitivity but that sensitivity decreases with dis-
tance. The data from all of the coils is combined in
order to produce a reconstruction over the entire
volume.

By simultaneously acquiring data on multiple
receiver coils, a division-of-labor is created by let-
ting each receiver sample more sparsely. Utilizing
redundant data samples from across the multiple
coils, it is possible to create nearly perfect re-
constructions with a proper coil data-combining
algorithm. In this project, I make use of SPIRiT
[2], using a MATLAB implementation courtesy of
Michael Lustig (of Berkeley) and John Pauly.

At high acceleration factors, these algorithms
fail, as the k-space data is too sparse. The rest
of this project approaches using parallel imaging
and compressed sensing to estimate and restore
the unsampled spatial frequencies such that a suf-
ﬁciently high resolution reconstruction becomes
possible.

1) Coil Compression: The sparsity of the spatial
frequency information can be dramatically re-
duced by transforming the data to different space.
Because each channel measures the same volume,
the data across the multiple channels is highly
compressible. An eigenspace representation is an
efﬁcient transformation for parallel MR data.

In the dataset shown in ﬁgure 3 (top), the
original dataset contained data from eight sig-
niﬁcant channels. The eigenvalue decomposition

Compressed Sensing Reconstructions for

Dynamic Contrast Enhanced MRI

1

Kevin T. Looby

klooby@stanford.edu

ABSTRACT

The temporal resolution necessary for dy-
namic contrast enhanced (DCE) magnetic reso-
nance imaging (MRI) requires scan accelerations
of more than 8× a typical scan time [1]. Ag-
gressive undersampling during data acquisition
can facilitate adequate temporal resolution at the
cost of reduced spatial resolution. [1] presents a
method for attaining the MR accelerations nec-
essary while preserving spatial resolution via
compressed sensing methods. This project seeks
to implement this method with an additional
compressed sensing component.

I. BACKGROUND

A. Dynamic Contrast Enhanced MRI

Dynamic contrast enhanced magnetic reso-
nance imaging allows for the characterization of
lesions (e.g., tumors, damaged tissue, etc.) as well
as examination of the performance of the renal
system. Visualization of the ﬂow dynamics of
contrast agents throughout tissues over time can
be used for tissue evaluation and characterization
based on the tissue uptake rates of the contrast
agents.

Contrast agent uptake typically completes
within a few minutes, about an order of magni-
tude faster than the scan rate of a conventional
full-resolution MR acquisition. The problem is
compounded in pediatric DCE MRI, as the ﬂow
dynamics occur over shorter time periods in very
young patients. Parallel imaging acquisitions un-
dersampled at a factor of 18× can achieve a
temporal resolution of roughly 3 seconds, which
is sufﬁcient for pediatric DCE MRI [1].

B. Parallel MRI Reconstructions with SPIRiT

SPIRiT (Iterative Self-consistent Parallel Imag-
ing Reconstruction) is a parallel imaging recon-
struction technique used to reconstruct multi-coil
MR datasets. The algorithm uses a projection onto
convex sets type approach similar to those to be
detailed in sections II.c1 and II.c2 in order to uti-
lize data redundancy from the multiple receiver
channels to form an accurate reconstruction.

The details of this method are not the focus
of this project and will not be discussed further,
but as SPIRiT forms an integral component of
my procedure,
it is important that this basic
explanation be given in advance. A MATLAB
implementation of SPIRiT was provided courtesy
of Michael Lustig and John Pauly.

II. METHODS

Materials

All datasets used in this project were provided
courtesy of Tao Zhang and John Pauly, both of
Stanford’s Magnetic Resonance Systems Research
Lab (MRSRL). Two sets of two-dimensional pe-
diatric abdominal cross-section dynamic contrast
enhanced datasets were provided and a dy-
namic contrast enhanced image phantom were
provided. MATLAB code for performing SPIRiT
[2] reconstructions and wavelet transforms were
made available by Michael Lustig and John Pauly.

Procedure Outline

A brief overview of the proposed data restora-
tion and reconstruction method is provided. The
following sections will elaborate further on each
step.

1) Choose appropriate undersampling pattern
2) Acquire parallel DCE MR data with chosen

3) Compress coils with eigenspace representa-

sampling

tion

4) Perform SPIRiT reconstruction with spatial
and temporal compressed sensing data con-
sistency enforcement+

5) Combine multi-coil data and form ﬁnal re-

construction

A. Undersampling

The attainable results of the proposed method
depend heavily on the choice of undersampling
pattern. The denoising steps described later are
all of projection on convex sets (POCS) type algo-
rithms. As will be discussed in further detail, the
undersampling pattern should be chosen in order
to produce aliasing artifacts with characteristics
similar to incoherent white noise. The POCS algo-
rithms seek to iteratively reduce the noise levels
while maintaining the power of the true signal.
This is best achieved with low-power incoherent
white noise.

By nature, aliasing artifacts produce image
noise with inherent coherence. In the case of uni-
form undersampling, the aliasing artifacts pro-
duced are exact replicas of the original signal,
and are therefore highly coherent. Because the
aliasing replicas have similar power character-
istics to the true signal, POCS algorithms will
be unable to remove any noise. However, more
strategically-chosen undersampling methods can
produce lower noise ﬂoors. The following charac-
teristics describe a sampling scheme that will pro-
duce aliasing with the desired incoherent white
noise similarity:
• Randomness
• Variable density, particularly higher-density
of samples in lower spatial frequency com-
ponents

• Maximal coverage of k-space
Figure 1 shows a fully sampled DCE MR
phantom reconstruction and its Fourier transform
along with four k-space undersamplings and
their multi-coil inverse Fourier transform recon-
structions. The reconstructions were performed as
the per-pixel square root of the sum of the cross-
coil image intensity values. That is,

(cid:115)(cid:88)

I[x, y] =

|F−1(kc[x, y])|,

(1)

c

where I denotes the reconstructed image, c the
set of coils, kc the k-space data for each coil, and
F−1 the inverse Fourier transform operator. For
each sampling scheme, the phantom dataset has
been undersampled by a factor of 16, meaning
that only one sixteenth of the original data is kept.
A qualitative examination of the reconstruction
from the variable-density Poisson disk undersam-
pling shows that this sampling pattern achieves
the desired characteristics. The variable-density
Poisson disk sampling utilizes random sampling,
with larger sample density at lower spatial fre-
quencies. Additional k-space coverage is obtained
by enforcing the additional constraint that no
sampled point can be within a predeﬁned dis-
tance of any other sampled point. This is the sam-

2

pling method used in [1], and all reconstructions
shown throughout the remainder of this paper
will be performed on Poisson disk undersampled
datasets.

Fig. 1.
k-space sampling schemes (top row, from left-to-
right: fully-sampled, uniform undersampling, spiral under-
sampling, random uniform-density undersampling, variable-
density Poisson disk undersampling) with corresponding
multi-coil inverse Fourier transform reconstructions (bottom
row). Coils were combined as the per-pixel square root of
the sum of the cross-coil intensity values. Note: each k-space
sampling scheme shown additionally includes the 16 × 16
block of lowest spatial frequencies. This block is referred to
as the ”calibration region” and is necessary for self-calibrating
parallel MR reconstructions (e.g., SPIRiT) [2].

B. Parallel Imaging

Parallel

imaging has long been used as a
method for MRI acceleration. In a parallel MR
acquisition, data is acquired on multiple receiver
coils, each of which captures the volume with
varying regional sensitivity. That is, each coil
senses a particular region of the volume with high
sensitivity but that sensitivity decreases with dis-
tance. The data from all of the coils is combined in
order to produce a reconstruction over the entire
volume.

By simultaneously acquiring data on multiple
receiver coils, a division-of-labor is created by let-
ting each receiver sample more sparsely. Utilizing
redundant data samples from across the multiple
coils, it is possible to create nearly perfect re-
constructions with a proper coil data-combining
algorithm. In this project, I make use of SPIRiT
[2], using a MATLAB implementation courtesy of
Michael Lustig (of Berkeley) and John Pauly.

At high acceleration factors, these algorithms
fail, as the k-space data is too sparse. The rest
of this project approaches using parallel imaging
and compressed sensing to estimate and restore
the unsampled spatial frequencies such that a suf-
ﬁciently high resolution reconstruction becomes
possible.

1) Coil Compression: The sparsity of the spatial
frequency information can be dramatically re-
duced by transforming the data to different space.
Because each channel measures the same volume,
the data across the multiple channels is highly
compressible. An eigenspace representation is an
efﬁcient transformation for parallel MR data.

In the dataset shown in ﬁgure 3 (top), the
original dataset contained data from eight sig-
niﬁcant channels. The eigenvalue decomposition

of this dataset results in only four signiﬁcant
eigenvalues. In this ”eigencoil” representation,
the signiﬁcant data has been compressed into
fewer channels. The lower energy channels can be
removed from the reconstruction in order to both
denoise the data, as these channels contain little
more than noise, and additionally reduce the size
of the data needed for storage and processing.

For the phantom image dataset, my method
retains the data corresponding to the four largest
eigenvalues. Figure 2 shows the multicoil recon-
struction (equation 1) of the data before compres-
sion (left) and the reconstruction using the four
most-signiﬁcant eigencoils. The pediatric DCE
MRI datasets provided by John Pauly and Tao
Zhang had been previously compressed to the
eight highest-energy eigencoils.

Fig. 2. Reconstruction without coil compression (left)
and reconstruction of four highest-energy eigencoils.

Fig. 3. Because the channels of a parallel MR dataset
each sense the full ﬁeld of view of the volume, there
is a large amount of redundancy across the channels.
This feature causes the eigenspace representation to be
a very efﬁcient compression.

C. Compressed Sensing in MRI

In general, compressed sensing refers to the
process of measuring very few random linear
combinations of signal values. The quantity of

3

samples collected is well below the number
needed to uniquely reconstruct the signal from
the samples alone. Nonlinear methods can be
used, however, to perform high-quality recon-
structions.

In MRI, the undersampled k-space samples
comprise the linear signal value combinations.
Compressed sensing theory in this case indicates
that it is possible to form an accurate reconstruc-
tion using a small sampling of k-space, rather
than a full Cartesian grid [3]. As stated in sec-
tion 2.a, it is crucial that the undersampling pat-
tern be random, because random undersampling
produces a viable compressed sensing denoising
problem.

This problem can be posed as an l1-penalized
convex optimization problem. Presented in equa-
tion 2 is a slight modiﬁcation to the problem
posed by [4].

argmin

||S ˆx − y||2

2 + λ|ˆx|1

1
2

(2)

Here, S indicates a sparsifying operator (i.e. a
transform that produces a sparse representation
of a signal), ˆx is the estimated signal, y is the
known signal information, i.e., the acquired sam-
ples, and λ is a scalar value that enforces the l1
norm penalty.

Solving this constrained problem attempts to
denoise the undersampled image by computing
a sparse representation of the image data while
maintaining data consistency with the sampled
spatial frequency information [3][4]. An iterative
projection onto convex sets (POCS) type algo-
rithm can be used to solve this problem for a
given sparsifying transform, S. The following
sections will detail the solution algorithm and
sparsifying transforms chosen.

1) Spatial Compressed Sensing: Magnetic reso-
nance images have an exploitable sparse repre-
sentation in the wavelet domain [3][4][5]. Letting
W represent a wavelet transform operator, equa-
tion 2 can be reformulated as
||W ˆx − y||2

2 + λ|ˆx|1.

argmin

(3)

1
2

A computational solution to this problem can
be achieved through the following iterative POCS
type algorithm [4].

1) Transform k-space data to image space with

the inverse Fourier transform

2) Apply a wavelet transform to the image

space data

3) Threshold low-energy wavelet coefﬁcients
4) Apply the inverse wavelet transform to re-

turn to image space

5) Return to the k-space representation via the

forward Fourier transform

Compressed Sensing Reconstructions for

Dynamic Contrast Enhanced MRI

1

Kevin T. Looby

klooby@stanford.edu

ABSTRACT

The temporal resolution necessary for dy-
namic contrast enhanced (DCE) magnetic reso-
nance imaging (MRI) requires scan accelerations
of more than 8× a typical scan time [1]. Ag-
gressive undersampling during data acquisition
can facilitate adequate temporal resolution at the
cost of reduced spatial resolution. [1] presents a
method for attaining the MR accelerations nec-
essary while preserving spatial resolution via
compressed sensing methods. This project seeks
to implement this method with an additional
compressed sensing component.

I. BACKGROUND

A. Dynamic Contrast Enhanced MRI

Dynamic contrast enhanced magnetic reso-
nance imaging allows for the characterization of
lesions (e.g., tumors, damaged tissue, etc.) as well
as examination of the performance of the renal
system. Visualization of the ﬂow dynamics of
contrast agents throughout tissues over time can
be used for tissue evaluation and characterization
based on the tissue uptake rates of the contrast
agents.

Contrast agent uptake typically completes
within a few minutes, about an order of magni-
tude faster than the scan rate of a conventional
full-resolution MR acquisition. The problem is
compounded in pediatric DCE MRI, as the ﬂow
dynamics occur over shorter time periods in very
young patients. Parallel imaging acquisitions un-
dersampled at a factor of 18× can achieve a
temporal resolution of roughly 3 seconds, which
is sufﬁcient for pediatric DCE MRI [1].

B. Parallel MRI Reconstructions with SPIRiT

SPIRiT (Iterative Self-consistent Parallel Imag-
ing Reconstruction) is a parallel imaging recon-
struction technique used to reconstruct multi-coil
MR datasets. The algorithm uses a projection onto
convex sets type approach similar to those to be
detailed in sections II.c1 and II.c2 in order to uti-
lize data redundancy from the multiple receiver
channels to form an accurate reconstruction.

The details of this method are not the focus
of this project and will not be discussed further,
but as SPIRiT forms an integral component of
my procedure,
it is important that this basic
explanation be given in advance. A MATLAB
implementation of SPIRiT was provided courtesy
of Michael Lustig and John Pauly.

II. METHODS

Materials

All datasets used in this project were provided
courtesy of Tao Zhang and John Pauly, both of
Stanford’s Magnetic Resonance Systems Research
Lab (MRSRL). Two sets of two-dimensional pe-
diatric abdominal cross-section dynamic contrast
enhanced datasets were provided and a dy-
namic contrast enhanced image phantom were
provided. MATLAB code for performing SPIRiT
[2] reconstructions and wavelet transforms were
made available by Michael Lustig and John Pauly.

Procedure Outline

A brief overview of the proposed data restora-
tion and reconstruction method is provided. The
following sections will elaborate further on each
step.

1) Choose appropriate undersampling pattern
2) Acquire parallel DCE MR data with chosen

3) Compress coils with eigenspace representa-

sampling

tion

4) Perform SPIRiT reconstruction with spatial
and temporal compressed sensing data con-
sistency enforcement+

5) Combine multi-coil data and form ﬁnal re-

construction

A. Undersampling

The attainable results of the proposed method
depend heavily on the choice of undersampling
pattern. The denoising steps described later are
all of projection on convex sets (POCS) type algo-
rithms. As will be discussed in further detail, the
undersampling pattern should be chosen in order
to produce aliasing artifacts with characteristics
similar to incoherent white noise. The POCS algo-
rithms seek to iteratively reduce the noise levels
while maintaining the power of the true signal.
This is best achieved with low-power incoherent
white noise.

By nature, aliasing artifacts produce image
noise with inherent coherence. In the case of uni-
form undersampling, the aliasing artifacts pro-
duced are exact replicas of the original signal,
and are therefore highly coherent. Because the
aliasing replicas have similar power character-
istics to the true signal, POCS algorithms will
be unable to remove any noise. However, more
strategically-chosen undersampling methods can
produce lower noise ﬂoors. The following charac-
teristics describe a sampling scheme that will pro-
duce aliasing with the desired incoherent white
noise similarity:
• Randomness
• Variable density, particularly higher-density
of samples in lower spatial frequency com-
ponents

• Maximal coverage of k-space
Figure 1 shows a fully sampled DCE MR
phantom reconstruction and its Fourier transform
along with four k-space undersamplings and
their multi-coil inverse Fourier transform recon-
structions. The reconstructions were performed as
the per-pixel square root of the sum of the cross-
coil image intensity values. That is,

(cid:115)(cid:88)

I[x, y] =

|F−1(kc[x, y])|,

(1)

c

where I denotes the reconstructed image, c the
set of coils, kc the k-space data for each coil, and
F−1 the inverse Fourier transform operator. For
each sampling scheme, the phantom dataset has
been undersampled by a factor of 16, meaning
that only one sixteenth of the original data is kept.
A qualitative examination of the reconstruction
from the variable-density Poisson disk undersam-
pling shows that this sampling pattern achieves
the desired characteristics. The variable-density
Poisson disk sampling utilizes random sampling,
with larger sample density at lower spatial fre-
quencies. Additional k-space coverage is obtained
by enforcing the additional constraint that no
sampled point can be within a predeﬁned dis-
tance of any other sampled point. This is the sam-

2

pling method used in [1], and all reconstructions
shown throughout the remainder of this paper
will be performed on Poisson disk undersampled
datasets.

Fig. 1.
k-space sampling schemes (top row, from left-to-
right: fully-sampled, uniform undersampling, spiral under-
sampling, random uniform-density undersampling, variable-
density Poisson disk undersampling) with corresponding
multi-coil inverse Fourier transform reconstructions (bottom
row). Coils were combined as the per-pixel square root of
the sum of the cross-coil intensity values. Note: each k-space
sampling scheme shown additionally includes the 16 × 16
block of lowest spatial frequencies. This block is referred to
as the ”calibration region” and is necessary for self-calibrating
parallel MR reconstructions (e.g., SPIRiT) [2].

B. Parallel Imaging

Parallel

imaging has long been used as a
method for MRI acceleration. In a parallel MR
acquisition, data is acquired on multiple receiver
coils, each of which captures the volume with
varying regional sensitivity. That is, each coil
senses a particular region of the volume with high
sensitivity but that sensitivity decreases with dis-
tance. The data from all of the coils is combined in
order to produce a reconstruction over the entire
volume.

By simultaneously acquiring data on multiple
receiver coils, a division-of-labor is created by let-
ting each receiver sample more sparsely. Utilizing
redundant data samples from across the multiple
coils, it is possible to create nearly perfect re-
constructions with a proper coil data-combining
algorithm. In this project, I make use of SPIRiT
[2], using a MATLAB implementation courtesy of
Michael Lustig (of Berkeley) and John Pauly.

At high acceleration factors, these algorithms
fail, as the k-space data is too sparse. The rest
of this project approaches using parallel imaging
and compressed sensing to estimate and restore
the unsampled spatial frequencies such that a suf-
ﬁciently high resolution reconstruction becomes
possible.

1) Coil Compression: The sparsity of the spatial
frequency information can be dramatically re-
duced by transforming the data to different space.
Because each channel measures the same volume,
the data across the multiple channels is highly
compressible. An eigenspace representation is an
efﬁcient transformation for parallel MR data.

In the dataset shown in ﬁgure 3 (top), the
original dataset contained data from eight sig-
niﬁcant channels. The eigenvalue decomposition

of this dataset results in only four signiﬁcant
eigenvalues. In this ”eigencoil” representation,
the signiﬁcant data has been compressed into
fewer channels. The lower energy channels can be
removed from the reconstruction in order to both
denoise the data, as these channels contain little
more than noise, and additionally reduce the size
of the data needed for storage and processing.

For the phantom image dataset, my method
retains the data corresponding to the four largest
eigenvalues. Figure 2 shows the multicoil recon-
struction (equation 1) of the data before compres-
sion (left) and the reconstruction using the four
most-signiﬁcant eigencoils. The pediatric DCE
MRI datasets provided by John Pauly and Tao
Zhang had been previously compressed to the
eight highest-energy eigencoils.

Fig. 2. Reconstruction without coil compression (left)
and reconstruction of four highest-energy eigencoils.

Fig. 3. Because the channels of a parallel MR dataset
each sense the full ﬁeld of view of the volume, there
is a large amount of redundancy across the channels.
This feature causes the eigenspace representation to be
a very efﬁcient compression.

C. Compressed Sensing in MRI

In general, compressed sensing refers to the
process of measuring very few random linear
combinations of signal values. The quantity of

3

samples collected is well below the number
needed to uniquely reconstruct the signal from
the samples alone. Nonlinear methods can be
used, however, to perform high-quality recon-
structions.

In MRI, the undersampled k-space samples
comprise the linear signal value combinations.
Compressed sensing theory in this case indicates
that it is possible to form an accurate reconstruc-
tion using a small sampling of k-space, rather
than a full Cartesian grid [3]. As stated in sec-
tion 2.a, it is crucial that the undersampling pat-
tern be random, because random undersampling
produces a viable compressed sensing denoising
problem.

This problem can be posed as an l1-penalized
convex optimization problem. Presented in equa-
tion 2 is a slight modiﬁcation to the problem
posed by [4].

argmin

||S ˆx − y||2

2 + λ|ˆx|1

1
2

(2)

Here, S indicates a sparsifying operator (i.e. a
transform that produces a sparse representation
of a signal), ˆx is the estimated signal, y is the
known signal information, i.e., the acquired sam-
ples, and λ is a scalar value that enforces the l1
norm penalty.

Solving this constrained problem attempts to
denoise the undersampled image by computing
a sparse representation of the image data while
maintaining data consistency with the sampled
spatial frequency information [3][4]. An iterative
projection onto convex sets (POCS) type algo-
rithm can be used to solve this problem for a
given sparsifying transform, S. The following
sections will detail the solution algorithm and
sparsifying transforms chosen.

1) Spatial Compressed Sensing: Magnetic reso-
nance images have an exploitable sparse repre-
sentation in the wavelet domain [3][4][5]. Letting
W represent a wavelet transform operator, equa-
tion 2 can be reformulated as
||W ˆx − y||2

2 + λ|ˆx|1.

argmin

(3)

1
2

A computational solution to this problem can
be achieved through the following iterative POCS
type algorithm [4].

1) Transform k-space data to image space with

the inverse Fourier transform

2) Apply a wavelet transform to the image

space data

3) Threshold low-energy wavelet coefﬁcients
4) Apply the inverse wavelet transform to re-

turn to image space

5) Return to the k-space representation via the

forward Fourier transform

6) Restore the data known to be true (the

sampled k-space data)

7) Repeat 1 through 6 until sufﬁcient conver-

gence is achieved

Steps 1 through 4 are shown visually in ﬁgure
4. In my implementation, the threshold is origi-
nally set at 40% of the largest wavelet coefﬁcient
(only coefﬁcients with energy no less than 40% of
the energy of the largest coefﬁcient are retained).
I deﬁne sufﬁcient convergence to be
× 100.

|ˆxi+1 − ˆxi|

(4)

1.0 >

|ˆxi|

That is, the iterative process is determined to have
sufﬁciently converged once the percent change
between the reconstructions, ˆx, from two subse-
quent iterations is less than 1%. Posing tighter
restrictions than a percent change of less than 1%
on the deﬁnition of convergence did not visually
create a signiﬁcant increase in image quality.

4

Fig. 5. Reconstruction without compressed sensing
(left) and reconstruction after wavelet-based POCS
type algorithm.

(ﬁgure 5 right) shows that the edges of the struc-
tures are much sharper, and the outlines of the
most-heavily noise-masked structures (left and
top of image) can be fully discerned.

2) Temporal Compressed Sensing: While the
previously-described spatial compressed sensing
method can be applied with good results to
nearly any MR dataset, DCE data has an addi-
tional signiﬁcant sparse representation in time.
The only change between a DCE MR image from
one time step and the corresponding cross-section
at the subsequent time step will be a change is
the intensity of some structures as the contrast
agent ﬂows through the body. As the majority
of the image features are static throughout time,
the time series data contains a large amount of
redundant information describing the anatomic
structures.

Fig. 4. Thresholding low energy wavelet coefﬁcients
results in a sparse approximation to the original data.

This iterative process is applied separately to
each individual coil at every time step and re-
peated ten times, using threshold values linearly
decreasing from 40% of the largest wavelet co-
efﬁcient to 25% of the largest wavelet coefﬁcient.
By gradually increasing the amount of coefﬁcients
that are removed from the reconstruction fewer
overall iterations are needed in order to achieve
convergence [4].

Figure 5 shows the qualitative results after per-
forming just this iterative reconstruction on the
full (not eigencoil) parallel DCE phantom data.
Comparison between the reconstruction without
compressed sensing (ﬁgure 5 left) and the recon-
struction after the iterative wavelet thresholding

Fig. 6. Three-dimensional data (above) is compressed to
the two-dimensional Casorati matrix with the original
spatial dimensions x and y merged to one dimension
and with time, t, as the second dimension.

A procedure similar to that described in section
II.c1 is implemented in order to utilize a spar-

Compressed Sensing Reconstructions for

Dynamic Contrast Enhanced MRI

1

Kevin T. Looby

klooby@stanford.edu

ABSTRACT

The temporal resolution necessary for dy-
namic contrast enhanced (DCE) magnetic reso-
nance imaging (MRI) requires scan accelerations
of more than 8× a typical scan time [1]. Ag-
gressive undersampling during data acquisition
can facilitate adequate temporal resolution at the
cost of reduced spatial resolution. [1] presents a
method for attaining the MR accelerations nec-
essary while preserving spatial resolution via
compressed sensing methods. This project seeks
to implement this method with an additional
compressed sensing component.

I. BACKGROUND

A. Dynamic Contrast Enhanced MRI

Dynamic contrast enhanced magnetic reso-
nance imaging allows for the characterization of
lesions (e.g., tumors, damaged tissue, etc.) as well
as examination of the performance of the renal
system. Visualization of the ﬂow dynamics of
contrast agents throughout tissues over time can
be used for tissue evaluation and characterization
based on the tissue uptake rates of the contrast
agents.

Contrast agent uptake typically completes
within a few minutes, about an order of magni-
tude faster than the scan rate of a conventional
full-resolution MR acquisition. The problem is
compounded in pediatric DCE MRI, as the ﬂow
dynamics occur over shorter time periods in very
young patients. Parallel imaging acquisitions un-
dersampled at a factor of 18× can achieve a
temporal resolution of roughly 3 seconds, which
is sufﬁcient for pediatric DCE MRI [1].

B. Parallel MRI Reconstructions with SPIRiT

SPIRiT (Iterative Self-consistent Parallel Imag-
ing Reconstruction) is a parallel imaging recon-
struction technique used to reconstruct multi-coil
MR datasets. The algorithm uses a projection onto
convex sets type approach similar to those to be
detailed in sections II.c1 and II.c2 in order to uti-
lize data redundancy from the multiple receiver
channels to form an accurate reconstruction.

The details of this method are not the focus
of this project and will not be discussed further,
but as SPIRiT forms an integral component of
my procedure,
it is important that this basic
explanation be given in advance. A MATLAB
implementation of SPIRiT was provided courtesy
of Michael Lustig and John Pauly.

II. METHODS

Materials

All datasets used in this project were provided
courtesy of Tao Zhang and John Pauly, both of
Stanford’s Magnetic Resonance Systems Research
Lab (MRSRL). Two sets of two-dimensional pe-
diatric abdominal cross-section dynamic contrast
enhanced datasets were provided and a dy-
namic contrast enhanced image phantom were
provided. MATLAB code for performing SPIRiT
[2] reconstructions and wavelet transforms were
made available by Michael Lustig and John Pauly.

Procedure Outline

A brief overview of the proposed data restora-
tion and reconstruction method is provided. The
following sections will elaborate further on each
step.

1) Choose appropriate undersampling pattern
2) Acquire parallel DCE MR data with chosen

3) Compress coils with eigenspace representa-

sampling

tion

4) Perform SPIRiT reconstruction with spatial
and temporal compressed sensing data con-
sistency enforcement+

5) Combine multi-coil data and form ﬁnal re-

construction

A. Undersampling

The attainable results of the proposed method
depend heavily on the choice of undersampling
pattern. The denoising steps described later are
all of projection on convex sets (POCS) type algo-
rithms. As will be discussed in further detail, the
undersampling pattern should be chosen in order
to produce aliasing artifacts with characteristics
similar to incoherent white noise. The POCS algo-
rithms seek to iteratively reduce the noise levels
while maintaining the power of the true signal.
This is best achieved with low-power incoherent
white noise.

By nature, aliasing artifacts produce image
noise with inherent coherence. In the case of uni-
form undersampling, the aliasing artifacts pro-
duced are exact replicas of the original signal,
and are therefore highly coherent. Because the
aliasing replicas have similar power character-
istics to the true signal, POCS algorithms will
be unable to remove any noise. However, more
strategically-chosen undersampling methods can
produce lower noise ﬂoors. The following charac-
teristics describe a sampling scheme that will pro-
duce aliasing with the desired incoherent white
noise similarity:
• Randomness
• Variable density, particularly higher-density
of samples in lower spatial frequency com-
ponents

• Maximal coverage of k-space
Figure 1 shows a fully sampled DCE MR
phantom reconstruction and its Fourier transform
along with four k-space undersamplings and
their multi-coil inverse Fourier transform recon-
structions. The reconstructions were performed as
the per-pixel square root of the sum of the cross-
coil image intensity values. That is,

(cid:115)(cid:88)

I[x, y] =

|F−1(kc[x, y])|,

(1)

c

where I denotes the reconstructed image, c the
set of coils, kc the k-space data for each coil, and
F−1 the inverse Fourier transform operator. For
each sampling scheme, the phantom dataset has
been undersampled by a factor of 16, meaning
that only one sixteenth of the original data is kept.
A qualitative examination of the reconstruction
from the variable-density Poisson disk undersam-
pling shows that this sampling pattern achieves
the desired characteristics. The variable-density
Poisson disk sampling utilizes random sampling,
with larger sample density at lower spatial fre-
quencies. Additional k-space coverage is obtained
by enforcing the additional constraint that no
sampled point can be within a predeﬁned dis-
tance of any other sampled point. This is the sam-

2

pling method used in [1], and all reconstructions
shown throughout the remainder of this paper
will be performed on Poisson disk undersampled
datasets.

Fig. 1.
k-space sampling schemes (top row, from left-to-
right: fully-sampled, uniform undersampling, spiral under-
sampling, random uniform-density undersampling, variable-
density Poisson disk undersampling) with corresponding
multi-coil inverse Fourier transform reconstructions (bottom
row). Coils were combined as the per-pixel square root of
the sum of the cross-coil intensity values. Note: each k-space
sampling scheme shown additionally includes the 16 × 16
block of lowest spatial frequencies. This block is referred to
as the ”calibration region” and is necessary for self-calibrating
parallel MR reconstructions (e.g., SPIRiT) [2].

B. Parallel Imaging

Parallel

imaging has long been used as a
method for MRI acceleration. In a parallel MR
acquisition, data is acquired on multiple receiver
coils, each of which captures the volume with
varying regional sensitivity. That is, each coil
senses a particular region of the volume with high
sensitivity but that sensitivity decreases with dis-
tance. The data from all of the coils is combined in
order to produce a reconstruction over the entire
volume.

By simultaneously acquiring data on multiple
receiver coils, a division-of-labor is created by let-
ting each receiver sample more sparsely. Utilizing
redundant data samples from across the multiple
coils, it is possible to create nearly perfect re-
constructions with a proper coil data-combining
algorithm. In this project, I make use of SPIRiT
[2], using a MATLAB implementation courtesy of
Michael Lustig (of Berkeley) and John Pauly.

At high acceleration factors, these algorithms
fail, as the k-space data is too sparse. The rest
of this project approaches using parallel imaging
and compressed sensing to estimate and restore
the unsampled spatial frequencies such that a suf-
ﬁciently high resolution reconstruction becomes
possible.

1) Coil Compression: The sparsity of the spatial
frequency information can be dramatically re-
duced by transforming the data to different space.
Because each channel measures the same volume,
the data across the multiple channels is highly
compressible. An eigenspace representation is an
efﬁcient transformation for parallel MR data.

In the dataset shown in ﬁgure 3 (top), the
original dataset contained data from eight sig-
niﬁcant channels. The eigenvalue decomposition

of this dataset results in only four signiﬁcant
eigenvalues. In this ”eigencoil” representation,
the signiﬁcant data has been compressed into
fewer channels. The lower energy channels can be
removed from the reconstruction in order to both
denoise the data, as these channels contain little
more than noise, and additionally reduce the size
of the data needed for storage and processing.

For the phantom image dataset, my method
retains the data corresponding to the four largest
eigenvalues. Figure 2 shows the multicoil recon-
struction (equation 1) of the data before compres-
sion (left) and the reconstruction using the four
most-signiﬁcant eigencoils. The pediatric DCE
MRI datasets provided by John Pauly and Tao
Zhang had been previously compressed to the
eight highest-energy eigencoils.

Fig. 2. Reconstruction without coil compression (left)
and reconstruction of four highest-energy eigencoils.

Fig. 3. Because the channels of a parallel MR dataset
each sense the full ﬁeld of view of the volume, there
is a large amount of redundancy across the channels.
This feature causes the eigenspace representation to be
a very efﬁcient compression.

C. Compressed Sensing in MRI

In general, compressed sensing refers to the
process of measuring very few random linear
combinations of signal values. The quantity of

3

samples collected is well below the number
needed to uniquely reconstruct the signal from
the samples alone. Nonlinear methods can be
used, however, to perform high-quality recon-
structions.

In MRI, the undersampled k-space samples
comprise the linear signal value combinations.
Compressed sensing theory in this case indicates
that it is possible to form an accurate reconstruc-
tion using a small sampling of k-space, rather
than a full Cartesian grid [3]. As stated in sec-
tion 2.a, it is crucial that the undersampling pat-
tern be random, because random undersampling
produces a viable compressed sensing denoising
problem.

This problem can be posed as an l1-penalized
convex optimization problem. Presented in equa-
tion 2 is a slight modiﬁcation to the problem
posed by [4].

argmin

||S ˆx − y||2

2 + λ|ˆx|1

1
2

(2)

Here, S indicates a sparsifying operator (i.e. a
transform that produces a sparse representation
of a signal), ˆx is the estimated signal, y is the
known signal information, i.e., the acquired sam-
ples, and λ is a scalar value that enforces the l1
norm penalty.

Solving this constrained problem attempts to
denoise the undersampled image by computing
a sparse representation of the image data while
maintaining data consistency with the sampled
spatial frequency information [3][4]. An iterative
projection onto convex sets (POCS) type algo-
rithm can be used to solve this problem for a
given sparsifying transform, S. The following
sections will detail the solution algorithm and
sparsifying transforms chosen.

1) Spatial Compressed Sensing: Magnetic reso-
nance images have an exploitable sparse repre-
sentation in the wavelet domain [3][4][5]. Letting
W represent a wavelet transform operator, equa-
tion 2 can be reformulated as
||W ˆx − y||2

2 + λ|ˆx|1.

argmin

(3)

1
2

A computational solution to this problem can
be achieved through the following iterative POCS
type algorithm [4].

1) Transform k-space data to image space with

the inverse Fourier transform

2) Apply a wavelet transform to the image

space data

3) Threshold low-energy wavelet coefﬁcients
4) Apply the inverse wavelet transform to re-

turn to image space

5) Return to the k-space representation via the

forward Fourier transform

6) Restore the data known to be true (the

sampled k-space data)

7) Repeat 1 through 6 until sufﬁcient conver-

gence is achieved

Steps 1 through 4 are shown visually in ﬁgure
4. In my implementation, the threshold is origi-
nally set at 40% of the largest wavelet coefﬁcient
(only coefﬁcients with energy no less than 40% of
the energy of the largest coefﬁcient are retained).
I deﬁne sufﬁcient convergence to be
× 100.

|ˆxi+1 − ˆxi|

(4)

1.0 >

|ˆxi|

That is, the iterative process is determined to have
sufﬁciently converged once the percent change
between the reconstructions, ˆx, from two subse-
quent iterations is less than 1%. Posing tighter
restrictions than a percent change of less than 1%
on the deﬁnition of convergence did not visually
create a signiﬁcant increase in image quality.

4

Fig. 5. Reconstruction without compressed sensing
(left) and reconstruction after wavelet-based POCS
type algorithm.

(ﬁgure 5 right) shows that the edges of the struc-
tures are much sharper, and the outlines of the
most-heavily noise-masked structures (left and
top of image) can be fully discerned.

2) Temporal Compressed Sensing: While the
previously-described spatial compressed sensing
method can be applied with good results to
nearly any MR dataset, DCE data has an addi-
tional signiﬁcant sparse representation in time.
The only change between a DCE MR image from
one time step and the corresponding cross-section
at the subsequent time step will be a change is
the intensity of some structures as the contrast
agent ﬂows through the body. As the majority
of the image features are static throughout time,
the time series data contains a large amount of
redundant information describing the anatomic
structures.

Fig. 4. Thresholding low energy wavelet coefﬁcients
results in a sparse approximation to the original data.

This iterative process is applied separately to
each individual coil at every time step and re-
peated ten times, using threshold values linearly
decreasing from 40% of the largest wavelet co-
efﬁcient to 25% of the largest wavelet coefﬁcient.
By gradually increasing the amount of coefﬁcients
that are removed from the reconstruction fewer
overall iterations are needed in order to achieve
convergence [4].

Figure 5 shows the qualitative results after per-
forming just this iterative reconstruction on the
full (not eigencoil) parallel DCE phantom data.
Comparison between the reconstruction without
compressed sensing (ﬁgure 5 left) and the recon-
struction after the iterative wavelet thresholding

Fig. 6. Three-dimensional data (above) is compressed to
the two-dimensional Casorati matrix with the original
spatial dimensions x and y merged to one dimension
and with time, t, as the second dimension.

A procedure similar to that described in section
II.c1 is implemented in order to utilize a spar-

5

III. RESULTS

The method presented here is capable of re-
constructing original DCE MRI data from aggres-
sively undersampled data with good accuracy.
Below, I give the results of my implementation
on three DCE datasets, with side-by-side compar-
isons to the result obtained from a basic inverse
Fourier transform reconstruction. As stated previ-
ously, all multi-coil reconstructions presented in
this report were formed using equation 1.

In each test, signiﬁcant denoising has been
achieved, and the resolution of the reconstruction
is high enough that all major and most minor
anatomic structures can be discerned. Figures 8, 9,
and 10 show the reconstructions only at the ﬁnal
time point in the time series. Figure 11 gives the
full twenty reconstructed time-series images for
the dataset shown in ﬁgure 9.

Fig. 8. 16× variable-density Poisson disk undersam-
pled DCE phantom reconstruction. All six primary
structures can be made out with strong edges, and
signiﬁcant denoising has been achieved.

sifying transform to exploit this temporal data
redundancy while simultaneously using SPIRiT
to perform additional spatial compressed sensing.
Before applying the sparsifying transform, the
data from each coil is ﬁrst arranged into a two-
dimensional Casorati matrix, as shown in ﬁgure
6. The original three-dimensional coil data (two
spatial dimensions and one temporal dimension)
is arranged such that resulting matrix has a col-
umn for every spatial coordinate with the tempo-
ral data for each spatial coordinate contained in
the column.

Multiple sparsifying transformations were ap-
plied to the Casorati representation,
including
the wavelet transform used in II.c1 as well as
a thresholding of Fourier transform coefﬁcients
and a low-rank approximation, as suggested in
[1]. The low-rank approximation was found to
be signiﬁcantly more effective than the either
evaluated methods. The Casorati matrix has very
low effective rank, and an accurate sparse recon-
struction can be performed using a small number
of signiﬁcant singular values [1]. The algorithm
for doing so is provided here.

1) Apply SPIRiT
2) In image space, reshape data into Casorati

3) Calculate the singular value decomposition

matrix representation

of the Casorati matrix

4) Threshold out non-signiﬁcant singular val-

ues

5) Construct a low-rank approximation to the
original data using the signiﬁcant singular
values

6) Repeat 1 through 5 until sufﬁcient conver-

gence is achieved

My implementation of

this algorithm de-
ﬁnes sufﬁcient convergence as either the per-
cent change between two subsequent iterations
effectively reaching zero (< 10−9) or the percent
change ﬂuctuating between increasing and de-
creasing, as this indicates that the procedure may
not be able to ﬁnd a more satisfactory conver-
gence. The results of applying SPIRiT with the
low-rank constraint to the phantom DCE data is
shown in ﬁgure 7 (right).

Fig. 7. Reconstruction without compressed sensing
(left) and reconstruction after low-rank-approximation-
based POCS type algorithm.

Fig. 9. 18× variable-density Poisson disk undersampled
pediatric abdominal cross-section DCE MRI. Note the
deﬁnition of smaller features and the sharpness of
feature edges.

IV. RELATED WORK

This project combines the algorithms for spatio-
temporal compressed sensing laid out by Michael
Lustig [3] [4] [5] [6] with the procedure for DCE
MRI applications outlined by Tao Zhang [1]. My
proposed method implements the algorithm de-
scribed in [1] with the addition of the wavelet
thresholding step detailed in section II.c1.

Compressed Sensing Reconstructions for

Dynamic Contrast Enhanced MRI

1

Kevin T. Looby

klooby@stanford.edu

ABSTRACT

The temporal resolution necessary for dy-
namic contrast enhanced (DCE) magnetic reso-
nance imaging (MRI) requires scan accelerations
of more than 8× a typical scan time [1]. Ag-
gressive undersampling during data acquisition
can facilitate adequate temporal resolution at the
cost of reduced spatial resolution. [1] presents a
method for attaining the MR accelerations nec-
essary while preserving spatial resolution via
compressed sensing methods. This project seeks
to implement this method with an additional
compressed sensing component.

I. BACKGROUND

A. Dynamic Contrast Enhanced MRI

Dynamic contrast enhanced magnetic reso-
nance imaging allows for the characterization of
lesions (e.g., tumors, damaged tissue, etc.) as well
as examination of the performance of the renal
system. Visualization of the ﬂow dynamics of
contrast agents throughout tissues over time can
be used for tissue evaluation and characterization
based on the tissue uptake rates of the contrast
agents.

Contrast agent uptake typically completes
within a few minutes, about an order of magni-
tude faster than the scan rate of a conventional
full-resolution MR acquisition. The problem is
compounded in pediatric DCE MRI, as the ﬂow
dynamics occur over shorter time periods in very
young patients. Parallel imaging acquisitions un-
dersampled at a factor of 18× can achieve a
temporal resolution of roughly 3 seconds, which
is sufﬁcient for pediatric DCE MRI [1].

B. Parallel MRI Reconstructions with SPIRiT

SPIRiT (Iterative Self-consistent Parallel Imag-
ing Reconstruction) is a parallel imaging recon-
struction technique used to reconstruct multi-coil
MR datasets. The algorithm uses a projection onto
convex sets type approach similar to those to be
detailed in sections II.c1 and II.c2 in order to uti-
lize data redundancy from the multiple receiver
channels to form an accurate reconstruction.

The details of this method are not the focus
of this project and will not be discussed further,
but as SPIRiT forms an integral component of
my procedure,
it is important that this basic
explanation be given in advance. A MATLAB
implementation of SPIRiT was provided courtesy
of Michael Lustig and John Pauly.

II. METHODS

Materials

All datasets used in this project were provided
courtesy of Tao Zhang and John Pauly, both of
Stanford’s Magnetic Resonance Systems Research
Lab (MRSRL). Two sets of two-dimensional pe-
diatric abdominal cross-section dynamic contrast
enhanced datasets were provided and a dy-
namic contrast enhanced image phantom were
provided. MATLAB code for performing SPIRiT
[2] reconstructions and wavelet transforms were
made available by Michael Lustig and John Pauly.

Procedure Outline

A brief overview of the proposed data restora-
tion and reconstruction method is provided. The
following sections will elaborate further on each
step.

1) Choose appropriate undersampling pattern
2) Acquire parallel DCE MR data with chosen

3) Compress coils with eigenspace representa-

sampling

tion

4) Perform SPIRiT reconstruction with spatial
and temporal compressed sensing data con-
sistency enforcement+

5) Combine multi-coil data and form ﬁnal re-

construction

A. Undersampling

The attainable results of the proposed method
depend heavily on the choice of undersampling
pattern. The denoising steps described later are
all of projection on convex sets (POCS) type algo-
rithms. As will be discussed in further detail, the
undersampling pattern should be chosen in order
to produce aliasing artifacts with characteristics
similar to incoherent white noise. The POCS algo-
rithms seek to iteratively reduce the noise levels
while maintaining the power of the true signal.
This is best achieved with low-power incoherent
white noise.

By nature, aliasing artifacts produce image
noise with inherent coherence. In the case of uni-
form undersampling, the aliasing artifacts pro-
duced are exact replicas of the original signal,
and are therefore highly coherent. Because the
aliasing replicas have similar power character-
istics to the true signal, POCS algorithms will
be unable to remove any noise. However, more
strategically-chosen undersampling methods can
produce lower noise ﬂoors. The following charac-
teristics describe a sampling scheme that will pro-
duce aliasing with the desired incoherent white
noise similarity:
• Randomness
• Variable density, particularly higher-density
of samples in lower spatial frequency com-
ponents

• Maximal coverage of k-space
Figure 1 shows a fully sampled DCE MR
phantom reconstruction and its Fourier transform
along with four k-space undersamplings and
their multi-coil inverse Fourier transform recon-
structions. The reconstructions were performed as
the per-pixel square root of the sum of the cross-
coil image intensity values. That is,

(cid:115)(cid:88)

I[x, y] =

|F−1(kc[x, y])|,

(1)

c

where I denotes the reconstructed image, c the
set of coils, kc the k-space data for each coil, and
F−1 the inverse Fourier transform operator. For
each sampling scheme, the phantom dataset has
been undersampled by a factor of 16, meaning
that only one sixteenth of the original data is kept.
A qualitative examination of the reconstruction
from the variable-density Poisson disk undersam-
pling shows that this sampling pattern achieves
the desired characteristics. The variable-density
Poisson disk sampling utilizes random sampling,
with larger sample density at lower spatial fre-
quencies. Additional k-space coverage is obtained
by enforcing the additional constraint that no
sampled point can be within a predeﬁned dis-
tance of any other sampled point. This is the sam-

2

pling method used in [1], and all reconstructions
shown throughout the remainder of this paper
will be performed on Poisson disk undersampled
datasets.

Fig. 1.
k-space sampling schemes (top row, from left-to-
right: fully-sampled, uniform undersampling, spiral under-
sampling, random uniform-density undersampling, variable-
density Poisson disk undersampling) with corresponding
multi-coil inverse Fourier transform reconstructions (bottom
row). Coils were combined as the per-pixel square root of
the sum of the cross-coil intensity values. Note: each k-space
sampling scheme shown additionally includes the 16 × 16
block of lowest spatial frequencies. This block is referred to
as the ”calibration region” and is necessary for self-calibrating
parallel MR reconstructions (e.g., SPIRiT) [2].

B. Parallel Imaging

Parallel

imaging has long been used as a
method for MRI acceleration. In a parallel MR
acquisition, data is acquired on multiple receiver
coils, each of which captures the volume with
varying regional sensitivity. That is, each coil
senses a particular region of the volume with high
sensitivity but that sensitivity decreases with dis-
tance. The data from all of the coils is combined in
order to produce a reconstruction over the entire
volume.

By simultaneously acquiring data on multiple
receiver coils, a division-of-labor is created by let-
ting each receiver sample more sparsely. Utilizing
redundant data samples from across the multiple
coils, it is possible to create nearly perfect re-
constructions with a proper coil data-combining
algorithm. In this project, I make use of SPIRiT
[2], using a MATLAB implementation courtesy of
Michael Lustig (of Berkeley) and John Pauly.

At high acceleration factors, these algorithms
fail, as the k-space data is too sparse. The rest
of this project approaches using parallel imaging
and compressed sensing to estimate and restore
the unsampled spatial frequencies such that a suf-
ﬁciently high resolution reconstruction becomes
possible.

1) Coil Compression: The sparsity of the spatial
frequency information can be dramatically re-
duced by transforming the data to different space.
Because each channel measures the same volume,
the data across the multiple channels is highly
compressible. An eigenspace representation is an
efﬁcient transformation for parallel MR data.

In the dataset shown in ﬁgure 3 (top), the
original dataset contained data from eight sig-
niﬁcant channels. The eigenvalue decomposition

of this dataset results in only four signiﬁcant
eigenvalues. In this ”eigencoil” representation,
the signiﬁcant data has been compressed into
fewer channels. The lower energy channels can be
removed from the reconstruction in order to both
denoise the data, as these channels contain little
more than noise, and additionally reduce the size
of the data needed for storage and processing.

For the phantom image dataset, my method
retains the data corresponding to the four largest
eigenvalues. Figure 2 shows the multicoil recon-
struction (equation 1) of the data before compres-
sion (left) and the reconstruction using the four
most-signiﬁcant eigencoils. The pediatric DCE
MRI datasets provided by John Pauly and Tao
Zhang had been previously compressed to the
eight highest-energy eigencoils.

Fig. 2. Reconstruction without coil compression (left)
and reconstruction of four highest-energy eigencoils.

Fig. 3. Because the channels of a parallel MR dataset
each sense the full ﬁeld of view of the volume, there
is a large amount of redundancy across the channels.
This feature causes the eigenspace representation to be
a very efﬁcient compression.

C. Compressed Sensing in MRI

In general, compressed sensing refers to the
process of measuring very few random linear
combinations of signal values. The quantity of

3

samples collected is well below the number
needed to uniquely reconstruct the signal from
the samples alone. Nonlinear methods can be
used, however, to perform high-quality recon-
structions.

In MRI, the undersampled k-space samples
comprise the linear signal value combinations.
Compressed sensing theory in this case indicates
that it is possible to form an accurate reconstruc-
tion using a small sampling of k-space, rather
than a full Cartesian grid [3]. As stated in sec-
tion 2.a, it is crucial that the undersampling pat-
tern be random, because random undersampling
produces a viable compressed sensing denoising
problem.

This problem can be posed as an l1-penalized
convex optimization problem. Presented in equa-
tion 2 is a slight modiﬁcation to the problem
posed by [4].

argmin

||S ˆx − y||2

2 + λ|ˆx|1

1
2

(2)

Here, S indicates a sparsifying operator (i.e. a
transform that produces a sparse representation
of a signal), ˆx is the estimated signal, y is the
known signal information, i.e., the acquired sam-
ples, and λ is a scalar value that enforces the l1
norm penalty.

Solving this constrained problem attempts to
denoise the undersampled image by computing
a sparse representation of the image data while
maintaining data consistency with the sampled
spatial frequency information [3][4]. An iterative
projection onto convex sets (POCS) type algo-
rithm can be used to solve this problem for a
given sparsifying transform, S. The following
sections will detail the solution algorithm and
sparsifying transforms chosen.

1) Spatial Compressed Sensing: Magnetic reso-
nance images have an exploitable sparse repre-
sentation in the wavelet domain [3][4][5]. Letting
W represent a wavelet transform operator, equa-
tion 2 can be reformulated as
||W ˆx − y||2

2 + λ|ˆx|1.

argmin

(3)

1
2

A computational solution to this problem can
be achieved through the following iterative POCS
type algorithm [4].

1) Transform k-space data to image space with

the inverse Fourier transform

2) Apply a wavelet transform to the image

space data

3) Threshold low-energy wavelet coefﬁcients
4) Apply the inverse wavelet transform to re-

turn to image space

5) Return to the k-space representation via the

forward Fourier transform

6) Restore the data known to be true (the

sampled k-space data)

7) Repeat 1 through 6 until sufﬁcient conver-

gence is achieved

Steps 1 through 4 are shown visually in ﬁgure
4. In my implementation, the threshold is origi-
nally set at 40% of the largest wavelet coefﬁcient
(only coefﬁcients with energy no less than 40% of
the energy of the largest coefﬁcient are retained).
I deﬁne sufﬁcient convergence to be
× 100.

|ˆxi+1 − ˆxi|

(4)

1.0 >

|ˆxi|

That is, the iterative process is determined to have
sufﬁciently converged once the percent change
between the reconstructions, ˆx, from two subse-
quent iterations is less than 1%. Posing tighter
restrictions than a percent change of less than 1%
on the deﬁnition of convergence did not visually
create a signiﬁcant increase in image quality.

4

Fig. 5. Reconstruction without compressed sensing
(left) and reconstruction after wavelet-based POCS
type algorithm.

(ﬁgure 5 right) shows that the edges of the struc-
tures are much sharper, and the outlines of the
most-heavily noise-masked structures (left and
top of image) can be fully discerned.

2) Temporal Compressed Sensing: While the
previously-described spatial compressed sensing
method can be applied with good results to
nearly any MR dataset, DCE data has an addi-
tional signiﬁcant sparse representation in time.
The only change between a DCE MR image from
one time step and the corresponding cross-section
at the subsequent time step will be a change is
the intensity of some structures as the contrast
agent ﬂows through the body. As the majority
of the image features are static throughout time,
the time series data contains a large amount of
redundant information describing the anatomic
structures.

Fig. 4. Thresholding low energy wavelet coefﬁcients
results in a sparse approximation to the original data.

This iterative process is applied separately to
each individual coil at every time step and re-
peated ten times, using threshold values linearly
decreasing from 40% of the largest wavelet co-
efﬁcient to 25% of the largest wavelet coefﬁcient.
By gradually increasing the amount of coefﬁcients
that are removed from the reconstruction fewer
overall iterations are needed in order to achieve
convergence [4].

Figure 5 shows the qualitative results after per-
forming just this iterative reconstruction on the
full (not eigencoil) parallel DCE phantom data.
Comparison between the reconstruction without
compressed sensing (ﬁgure 5 left) and the recon-
struction after the iterative wavelet thresholding

Fig. 6. Three-dimensional data (above) is compressed to
the two-dimensional Casorati matrix with the original
spatial dimensions x and y merged to one dimension
and with time, t, as the second dimension.

A procedure similar to that described in section
II.c1 is implemented in order to utilize a spar-

5

III. RESULTS

The method presented here is capable of re-
constructing original DCE MRI data from aggres-
sively undersampled data with good accuracy.
Below, I give the results of my implementation
on three DCE datasets, with side-by-side compar-
isons to the result obtained from a basic inverse
Fourier transform reconstruction. As stated previ-
ously, all multi-coil reconstructions presented in
this report were formed using equation 1.

In each test, signiﬁcant denoising has been
achieved, and the resolution of the reconstruction
is high enough that all major and most minor
anatomic structures can be discerned. Figures 8, 9,
and 10 show the reconstructions only at the ﬁnal
time point in the time series. Figure 11 gives the
full twenty reconstructed time-series images for
the dataset shown in ﬁgure 9.

Fig. 8. 16× variable-density Poisson disk undersam-
pled DCE phantom reconstruction. All six primary
structures can be made out with strong edges, and
signiﬁcant denoising has been achieved.

sifying transform to exploit this temporal data
redundancy while simultaneously using SPIRiT
to perform additional spatial compressed sensing.
Before applying the sparsifying transform, the
data from each coil is ﬁrst arranged into a two-
dimensional Casorati matrix, as shown in ﬁgure
6. The original three-dimensional coil data (two
spatial dimensions and one temporal dimension)
is arranged such that resulting matrix has a col-
umn for every spatial coordinate with the tempo-
ral data for each spatial coordinate contained in
the column.

Multiple sparsifying transformations were ap-
plied to the Casorati representation,
including
the wavelet transform used in II.c1 as well as
a thresholding of Fourier transform coefﬁcients
and a low-rank approximation, as suggested in
[1]. The low-rank approximation was found to
be signiﬁcantly more effective than the either
evaluated methods. The Casorati matrix has very
low effective rank, and an accurate sparse recon-
struction can be performed using a small number
of signiﬁcant singular values [1]. The algorithm
for doing so is provided here.

1) Apply SPIRiT
2) In image space, reshape data into Casorati

3) Calculate the singular value decomposition

matrix representation

of the Casorati matrix

4) Threshold out non-signiﬁcant singular val-

ues

5) Construct a low-rank approximation to the
original data using the signiﬁcant singular
values

6) Repeat 1 through 5 until sufﬁcient conver-

gence is achieved

My implementation of

this algorithm de-
ﬁnes sufﬁcient convergence as either the per-
cent change between two subsequent iterations
effectively reaching zero (< 10−9) or the percent
change ﬂuctuating between increasing and de-
creasing, as this indicates that the procedure may
not be able to ﬁnd a more satisfactory conver-
gence. The results of applying SPIRiT with the
low-rank constraint to the phantom DCE data is
shown in ﬁgure 7 (right).

Fig. 7. Reconstruction without compressed sensing
(left) and reconstruction after low-rank-approximation-
based POCS type algorithm.

Fig. 9. 18× variable-density Poisson disk undersampled
pediatric abdominal cross-section DCE MRI. Note the
deﬁnition of smaller features and the sharpness of
feature edges.

IV. RELATED WORK

This project combines the algorithms for spatio-
temporal compressed sensing laid out by Michael
Lustig [3] [4] [5] [6] with the procedure for DCE
MRI applications outlined by Tao Zhang [1]. My
proposed method implements the algorithm de-
scribed in [1] with the addition of the wavelet
thresholding step detailed in section II.c1.

6

B. Parameter Choice

A more rigorous evaluation of the Poisson disk
undersampling scheme implemented should be
performed. A more carefully selected selection of
k-space points with a precisely controlled varia-
tion over time, as implemented in [1] should be
performed with an evaluation of the performance
of varying the distance between points and the
overall density variation of sample points as a
function of spatial frequency.

Fig. 10. 18× variable-density Poisson disk undersam-
pled pediatric abdominal cross-section DCE MRI. Note
the deﬁnition of the vasculature in the liver (largest
structure, upper-right).

Fig. 11. Full twenty-frame reconstruction of the 18×
variable-density Poisson disk undersampled pediatric
abdominal cross-section shown in ﬁgure 9. Time in-
creases from left-to-right and top-to-bottom. Note the
intensity changes of the anatomic structures, which
show the tissue uptake of the contrast agent.

V. FUTURE WORK

A. Compressed Sensing: Wavelets

Computing numerous forward and inverse
wavelet transforms is computationally expensive.
As such, only a relatively small number of iter-
ations of the POCS type wavelet solution were
run in my implementation. With more extensive
computation power, it should be possible to con-
verge to a more accurate iterative solution by
iterating the procedure many more times over a
ﬁner variation of coefﬁcient thresholds.

Compressed Sensing Reconstructions for

Dynamic Contrast Enhanced MRI

1

Kevin T. Looby

klooby@stanford.edu

ABSTRACT

The temporal resolution necessary for dy-
namic contrast enhanced (DCE) magnetic reso-
nance imaging (MRI) requires scan accelerations
of more than 8× a typical scan time [1]. Ag-
gressive undersampling during data acquisition
can facilitate adequate temporal resolution at the
cost of reduced spatial resolution. [1] presents a
method for attaining the MR accelerations nec-
essary while preserving spatial resolution via
compressed sensing methods. This project seeks
to implement this method with an additional
compressed sensing component.

I. BACKGROUND

A. Dynamic Contrast Enhanced MRI

Dynamic contrast enhanced magnetic reso-
nance imaging allows for the characterization of
lesions (e.g., tumors, damaged tissue, etc.) as well
as examination of the performance of the renal
system. Visualization of the ﬂow dynamics of
contrast agents throughout tissues over time can
be used for tissue evaluation and characterization
based on the tissue uptake rates of the contrast
agents.

Contrast agent uptake typically completes
within a few minutes, about an order of magni-
tude faster than the scan rate of a conventional
full-resolution MR acquisition. The problem is
compounded in pediatric DCE MRI, as the ﬂow
dynamics occur over shorter time periods in very
young patients. Parallel imaging acquisitions un-
dersampled at a factor of 18× can achieve a
temporal resolution of roughly 3 seconds, which
is sufﬁcient for pediatric DCE MRI [1].

B. Parallel MRI Reconstructions with SPIRiT

SPIRiT (Iterative Self-consistent Parallel Imag-
ing Reconstruction) is a parallel imaging recon-
struction technique used to reconstruct multi-coil
MR datasets. The algorithm uses a projection onto
convex sets type approach similar to those to be
detailed in sections II.c1 and II.c2 in order to uti-
lize data redundancy from the multiple receiver
channels to form an accurate reconstruction.

The details of this method are not the focus
of this project and will not be discussed further,
but as SPIRiT forms an integral component of
my procedure,
it is important that this basic
explanation be given in advance. A MATLAB
implementation of SPIRiT was provided courtesy
of Michael Lustig and John Pauly.

II. METHODS

Materials

All datasets used in this project were provided
courtesy of Tao Zhang and John Pauly, both of
Stanford’s Magnetic Resonance Systems Research
Lab (MRSRL). Two sets of two-dimensional pe-
diatric abdominal cross-section dynamic contrast
enhanced datasets were provided and a dy-
namic contrast enhanced image phantom were
provided. MATLAB code for performing SPIRiT
[2] reconstructions and wavelet transforms were
made available by Michael Lustig and John Pauly.

Procedure Outline

A brief overview of the proposed data restora-
tion and reconstruction method is provided. The
following sections will elaborate further on each
step.

1) Choose appropriate undersampling pattern
2) Acquire parallel DCE MR data with chosen

3) Compress coils with eigenspace representa-

sampling

tion

4) Perform SPIRiT reconstruction with spatial
and temporal compressed sensing data con-
sistency enforcement+

5) Combine multi-coil data and form ﬁnal re-

construction

A. Undersampling

The attainable results of the proposed method
depend heavily on the choice of undersampling
pattern. The denoising steps described later are
all of projection on convex sets (POCS) type algo-
rithms. As will be discussed in further detail, the
undersampling pattern should be chosen in order
to produce aliasing artifacts with characteristics
similar to incoherent white noise. The POCS algo-
rithms seek to iteratively reduce the noise levels
while maintaining the power of the true signal.
This is best achieved with low-power incoherent
white noise.

By nature, aliasing artifacts produce image
noise with inherent coherence. In the case of uni-
form undersampling, the aliasing artifacts pro-
duced are exact replicas of the original signal,
and are therefore highly coherent. Because the
aliasing replicas have similar power character-
istics to the true signal, POCS algorithms will
be unable to remove any noise. However, more
strategically-chosen undersampling methods can
produce lower noise ﬂoors. The following charac-
teristics describe a sampling scheme that will pro-
duce aliasing with the desired incoherent white
noise similarity:
• Randomness
• Variable density, particularly higher-density
of samples in lower spatial frequency com-
ponents

• Maximal coverage of k-space
Figure 1 shows a fully sampled DCE MR
phantom reconstruction and its Fourier transform
along with four k-space undersamplings and
their multi-coil inverse Fourier transform recon-
structions. The reconstructions were performed as
the per-pixel square root of the sum of the cross-
coil image intensity values. That is,

(cid:115)(cid:88)

I[x, y] =

|F−1(kc[x, y])|,

(1)

c

where I denotes the reconstructed image, c the
set of coils, kc the k-space data for each coil, and
F−1 the inverse Fourier transform operator. For
each sampling scheme, the phantom dataset has
been undersampled by a factor of 16, meaning
that only one sixteenth of the original data is kept.
A qualitative examination of the reconstruction
from the variable-density Poisson disk undersam-
pling shows that this sampling pattern achieves
the desired characteristics. The variable-density
Poisson disk sampling utilizes random sampling,
with larger sample density at lower spatial fre-
quencies. Additional k-space coverage is obtained
by enforcing the additional constraint that no
sampled point can be within a predeﬁned dis-
tance of any other sampled point. This is the sam-

2

pling method used in [1], and all reconstructions
shown throughout the remainder of this paper
will be performed on Poisson disk undersampled
datasets.

Fig. 1.
k-space sampling schemes (top row, from left-to-
right: fully-sampled, uniform undersampling, spiral under-
sampling, random uniform-density undersampling, variable-
density Poisson disk undersampling) with corresponding
multi-coil inverse Fourier transform reconstructions (bottom
row). Coils were combined as the per-pixel square root of
the sum of the cross-coil intensity values. Note: each k-space
sampling scheme shown additionally includes the 16 × 16
block of lowest spatial frequencies. This block is referred to
as the ”calibration region” and is necessary for self-calibrating
parallel MR reconstructions (e.g., SPIRiT) [2].

B. Parallel Imaging

Parallel

imaging has long been used as a
method for MRI acceleration. In a parallel MR
acquisition, data is acquired on multiple receiver
coils, each of which captures the volume with
varying regional sensitivity. That is, each coil
senses a particular region of the volume with high
sensitivity but that sensitivity decreases with dis-
tance. The data from all of the coils is combined in
order to produce a reconstruction over the entire
volume.

By simultaneously acquiring data on multiple
receiver coils, a division-of-labor is created by let-
ting each receiver sample more sparsely. Utilizing
redundant data samples from across the multiple
coils, it is possible to create nearly perfect re-
constructions with a proper coil data-combining
algorithm. In this project, I make use of SPIRiT
[2], using a MATLAB implementation courtesy of
Michael Lustig (of Berkeley) and John Pauly.

At high acceleration factors, these algorithms
fail, as the k-space data is too sparse. The rest
of this project approaches using parallel imaging
and compressed sensing to estimate and restore
the unsampled spatial frequencies such that a suf-
ﬁciently high resolution reconstruction becomes
possible.

1) Coil Compression: The sparsity of the spatial
frequency information can be dramatically re-
duced by transforming the data to different space.
Because each channel measures the same volume,
the data across the multiple channels is highly
compressible. An eigenspace representation is an
efﬁcient transformation for parallel MR data.

In the dataset shown in ﬁgure 3 (top), the
original dataset contained data from eight sig-
niﬁcant channels. The eigenvalue decomposition

of this dataset results in only four signiﬁcant
eigenvalues. In this ”eigencoil” representation,
the signiﬁcant data has been compressed into
fewer channels. The lower energy channels can be
removed from the reconstruction in order to both
denoise the data, as these channels contain little
more than noise, and additionally reduce the size
of the data needed for storage and processing.

For the phantom image dataset, my method
retains the data corresponding to the four largest
eigenvalues. Figure 2 shows the multicoil recon-
struction (equation 1) of the data before compres-
sion (left) and the reconstruction using the four
most-signiﬁcant eigencoils. The pediatric DCE
MRI datasets provided by John Pauly and Tao
Zhang had been previously compressed to the
eight highest-energy eigencoils.

Fig. 2. Reconstruction without coil compression (left)
and reconstruction of four highest-energy eigencoils.

Fig. 3. Because the channels of a parallel MR dataset
each sense the full ﬁeld of view of the volume, there
is a large amount of redundancy across the channels.
This feature causes the eigenspace representation to be
a very efﬁcient compression.

C. Compressed Sensing in MRI

In general, compressed sensing refers to the
process of measuring very few random linear
combinations of signal values. The quantity of

3

samples collected is well below the number
needed to uniquely reconstruct the signal from
the samples alone. Nonlinear methods can be
used, however, to perform high-quality recon-
structions.

In MRI, the undersampled k-space samples
comprise the linear signal value combinations.
Compressed sensing theory in this case indicates
that it is possible to form an accurate reconstruc-
tion using a small sampling of k-space, rather
than a full Cartesian grid [3]. As stated in sec-
tion 2.a, it is crucial that the undersampling pat-
tern be random, because random undersampling
produces a viable compressed sensing denoising
problem.

This problem can be posed as an l1-penalized
convex optimization problem. Presented in equa-
tion 2 is a slight modiﬁcation to the problem
posed by [4].

argmin

||S ˆx − y||2

2 + λ|ˆx|1

1
2

(2)

Here, S indicates a sparsifying operator (i.e. a
transform that produces a sparse representation
of a signal), ˆx is the estimated signal, y is the
known signal information, i.e., the acquired sam-
ples, and λ is a scalar value that enforces the l1
norm penalty.

Solving this constrained problem attempts to
denoise the undersampled image by computing
a sparse representation of the image data while
maintaining data consistency with the sampled
spatial frequency information [3][4]. An iterative
projection onto convex sets (POCS) type algo-
rithm can be used to solve this problem for a
given sparsifying transform, S. The following
sections will detail the solution algorithm and
sparsifying transforms chosen.

1) Spatial Compressed Sensing: Magnetic reso-
nance images have an exploitable sparse repre-
sentation in the wavelet domain [3][4][5]. Letting
W represent a wavelet transform operator, equa-
tion 2 can be reformulated as
||W ˆx − y||2

2 + λ|ˆx|1.

argmin

(3)

1
2

A computational solution to this problem can
be achieved through the following iterative POCS
type algorithm [4].

1) Transform k-space data to image space with

the inverse Fourier transform

2) Apply a wavelet transform to the image

space data

3) Threshold low-energy wavelet coefﬁcients
4) Apply the inverse wavelet transform to re-

turn to image space

5) Return to the k-space representation via the

forward Fourier transform

6) Restore the data known to be true (the

sampled k-space data)

7) Repeat 1 through 6 until sufﬁcient conver-

gence is achieved

Steps 1 through 4 are shown visually in ﬁgure
4. In my implementation, the threshold is origi-
nally set at 40% of the largest wavelet coefﬁcient
(only coefﬁcients with energy no less than 40% of
the energy of the largest coefﬁcient are retained).
I deﬁne sufﬁcient convergence to be
× 100.

|ˆxi+1 − ˆxi|

(4)

1.0 >

|ˆxi|

That is, the iterative process is determined to have
sufﬁciently converged once the percent change
between the reconstructions, ˆx, from two subse-
quent iterations is less than 1%. Posing tighter
restrictions than a percent change of less than 1%
on the deﬁnition of convergence did not visually
create a signiﬁcant increase in image quality.

4

Fig. 5. Reconstruction without compressed sensing
(left) and reconstruction after wavelet-based POCS
type algorithm.

(ﬁgure 5 right) shows that the edges of the struc-
tures are much sharper, and the outlines of the
most-heavily noise-masked structures (left and
top of image) can be fully discerned.

2) Temporal Compressed Sensing: While the
previously-described spatial compressed sensing
method can be applied with good results to
nearly any MR dataset, DCE data has an addi-
tional signiﬁcant sparse representation in time.
The only change between a DCE MR image from
one time step and the corresponding cross-section
at the subsequent time step will be a change is
the intensity of some structures as the contrast
agent ﬂows through the body. As the majority
of the image features are static throughout time,
the time series data contains a large amount of
redundant information describing the anatomic
structures.

Fig. 4. Thresholding low energy wavelet coefﬁcients
results in a sparse approximation to the original data.

This iterative process is applied separately to
each individual coil at every time step and re-
peated ten times, using threshold values linearly
decreasing from 40% of the largest wavelet co-
efﬁcient to 25% of the largest wavelet coefﬁcient.
By gradually increasing the amount of coefﬁcients
that are removed from the reconstruction fewer
overall iterations are needed in order to achieve
convergence [4].

Figure 5 shows the qualitative results after per-
forming just this iterative reconstruction on the
full (not eigencoil) parallel DCE phantom data.
Comparison between the reconstruction without
compressed sensing (ﬁgure 5 left) and the recon-
struction after the iterative wavelet thresholding

Fig. 6. Three-dimensional data (above) is compressed to
the two-dimensional Casorati matrix with the original
spatial dimensions x and y merged to one dimension
and with time, t, as the second dimension.

A procedure similar to that described in section
II.c1 is implemented in order to utilize a spar-

5

III. RESULTS

The method presented here is capable of re-
constructing original DCE MRI data from aggres-
sively undersampled data with good accuracy.
Below, I give the results of my implementation
on three DCE datasets, with side-by-side compar-
isons to the result obtained from a basic inverse
Fourier transform reconstruction. As stated previ-
ously, all multi-coil reconstructions presented in
this report were formed using equation 1.

In each test, signiﬁcant denoising has been
achieved, and the resolution of the reconstruction
is high enough that all major and most minor
anatomic structures can be discerned. Figures 8, 9,
and 10 show the reconstructions only at the ﬁnal
time point in the time series. Figure 11 gives the
full twenty reconstructed time-series images for
the dataset shown in ﬁgure 9.

Fig. 8. 16× variable-density Poisson disk undersam-
pled DCE phantom reconstruction. All six primary
structures can be made out with strong edges, and
signiﬁcant denoising has been achieved.

sifying transform to exploit this temporal data
redundancy while simultaneously using SPIRiT
to perform additional spatial compressed sensing.
Before applying the sparsifying transform, the
data from each coil is ﬁrst arranged into a two-
dimensional Casorati matrix, as shown in ﬁgure
6. The original three-dimensional coil data (two
spatial dimensions and one temporal dimension)
is arranged such that resulting matrix has a col-
umn for every spatial coordinate with the tempo-
ral data for each spatial coordinate contained in
the column.

Multiple sparsifying transformations were ap-
plied to the Casorati representation,
including
the wavelet transform used in II.c1 as well as
a thresholding of Fourier transform coefﬁcients
and a low-rank approximation, as suggested in
[1]. The low-rank approximation was found to
be signiﬁcantly more effective than the either
evaluated methods. The Casorati matrix has very
low effective rank, and an accurate sparse recon-
struction can be performed using a small number
of signiﬁcant singular values [1]. The algorithm
for doing so is provided here.

1) Apply SPIRiT
2) In image space, reshape data into Casorati

3) Calculate the singular value decomposition

matrix representation

of the Casorati matrix

4) Threshold out non-signiﬁcant singular val-

ues

5) Construct a low-rank approximation to the
original data using the signiﬁcant singular
values

6) Repeat 1 through 5 until sufﬁcient conver-

gence is achieved

My implementation of

this algorithm de-
ﬁnes sufﬁcient convergence as either the per-
cent change between two subsequent iterations
effectively reaching zero (< 10−9) or the percent
change ﬂuctuating between increasing and de-
creasing, as this indicates that the procedure may
not be able to ﬁnd a more satisfactory conver-
gence. The results of applying SPIRiT with the
low-rank constraint to the phantom DCE data is
shown in ﬁgure 7 (right).

Fig. 7. Reconstruction without compressed sensing
(left) and reconstruction after low-rank-approximation-
based POCS type algorithm.

Fig. 9. 18× variable-density Poisson disk undersampled
pediatric abdominal cross-section DCE MRI. Note the
deﬁnition of smaller features and the sharpness of
feature edges.

IV. RELATED WORK

This project combines the algorithms for spatio-
temporal compressed sensing laid out by Michael
Lustig [3] [4] [5] [6] with the procedure for DCE
MRI applications outlined by Tao Zhang [1]. My
proposed method implements the algorithm de-
scribed in [1] with the addition of the wavelet
thresholding step detailed in section II.c1.

6

B. Parameter Choice

A more rigorous evaluation of the Poisson disk
undersampling scheme implemented should be
performed. A more carefully selected selection of
k-space points with a precisely controlled varia-
tion over time, as implemented in [1] should be
performed with an evaluation of the performance
of varying the distance between points and the
overall density variation of sample points as a
function of spatial frequency.

Fig. 10. 18× variable-density Poisson disk undersam-
pled pediatric abdominal cross-section DCE MRI. Note
the deﬁnition of the vasculature in the liver (largest
structure, upper-right).

Fig. 11. Full twenty-frame reconstruction of the 18×
variable-density Poisson disk undersampled pediatric
abdominal cross-section shown in ﬁgure 9. Time in-
creases from left-to-right and top-to-bottom. Note the
intensity changes of the anatomic structures, which
show the tissue uptake of the contrast agent.

V. FUTURE WORK

A. Compressed Sensing: Wavelets

Computing numerous forward and inverse
wavelet transforms is computationally expensive.
As such, only a relatively small number of iter-
ations of the POCS type wavelet solution were
run in my implementation. With more extensive
computation power, it should be possible to con-
verge to a more accurate iterative solution by
iterating the procedure many more times over a
ﬁner variation of coefﬁcient thresholds.

REFERENCES

7

[1] T. Zhang, J. Y. Cheng, A. G. Potnick, R. A. Barth, M. T.
Alley, M. Uecker, M. Lustig,
J. M. Pauly, and S. S.
Vasanawala, “Fast pediatric 3d free-breathing abdominal
dynamic contrast enhanced mri with high spatiotemporal
resolution,” Journal of Magnetic Resonance Imaging, 2015.

[2] M. Lustig and J. M. Pauly, “SPIRiT, iterative self-consistent
parallel imaging reconstruction from arbitrary k-space,”
Magnetic Resonance in Medicine, vol. 64, pp. 457–471, 2010.
[3] M. Lustig, J. M. Santos, D. Donoho, and J. M. Pauly,
“k-t SPARSE: High frame rate dynamic MRI exploiting
spatio-temporal sparsity,” in Proceedings of the 14th Annual
Meeting of ISMRM, Seattle, p. 2420, 2006.

[4] M. Lustig, “EE369C: Assignment 6,” Accessed: December

1, 2015.
http://web.stanford.edu/class/ee369c/Assignments/
assignment 6.pdf.

[5] M. Lustig, D. Donoho, and J. M. Pauly, “Sparse MRI: The
application of compressed sensing for rapid MR imaging,”
Magnetic Resonance in Medicine, vol. 58, pp. 1182–1195,
2007.

[6] M. Lustig, J. H. Lee, D. L. Donoho, and J. M. Pauly, “Faster
imaging with randomly perturbed, undersampled spirals
and l1 reconstructions,” in Proceedings of the 12th Annual
Meeting of ISMRM, Miami Beach, p. 685, 2005.

[7] J. Pauly, “EE369C: Medical Image Reconstruction Lecture

Notes,” Accessed: December 1, 2015.
http://web.stanford.edu/class/ee369c/Notes.html.

